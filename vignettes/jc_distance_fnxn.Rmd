---
title: "Jukes-Cantor Distance Function"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Jukes-Cantor Distance Function}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, eval = T}
library(compbio4all)
```


## The Jukes-Cantor Distance


### Function
```{r}
jc <- function(p){
  K <- -3/4 * log(1 - 4/3*p)
  return(K)
}

```


### Test

```{r}
jc(0)
jc(0.5)
jc(0.55)
jc(0.55245)
```


### Error:
```{r}
jc(0.74) 
jc(0.749)
jc(0.7499)
jc(0.7499)
# Note: 
jc(0.75) 


## because
log(1 - 4/3*0.75)
```


### Visualize

```{r}
par(mfrow = c(1,1))
p <- seq(from = 0,to = .75,by = 0.001)
plot(jc(p) ~ p, xlab = c("Proportion of sites difference"), ylab = "JC distance")
points(0.75,jc(0.749), pch = 16, cex = 2)
abline(v = 0.75)
abline(a = 0, b = 1, lty = 2, col = 3)
abline(h = 1)
abline(v = 0.55245)

```


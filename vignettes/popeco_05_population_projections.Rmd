---
title: "A primer of population ecology: Part 5 - Projecting Population Growth"
author: "Nathan Brouwer"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{A primer of population ecology: Part 5 - Projecting Population Growth}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

N <- c(432,502,201,200,216,167,179,200,219,200,211,243,232,207,215,215,216,210,167,207,212,265,347, 397,485,633,765,692,728,804,904,891,1085,1050,1202,1341,1420,1485,1707,1803,1826,1773,1828,2090,2020, NA,2365,
       1023/0.40)

year <- c(1951,1961,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,
          1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,
          2001,2002,2003,2004,2005,2006, 2007,2008,2009,2010,2011,2012,2013,2014,2015,
          2019)

#(cbind(year,N))

```

## Predicting changes in population size using lambda

If we have a value for $\lambda$  and the current size of the population from an intensive field survey, we can calculate the future size of the population by doing a little algebra.

Recall that we arrived at lambda previously by setting up this equation 

$N_{t+1}/N_t = \lambda= \phi + b$ 

That is, our concept of lambda is the ratio of two population sizes.  Let's start with this 

$N_{t+1}/N_t = \lambda $ 

Now multiple both sizes by N_t

$N_{t+1}/N_t*N_t = \lambda*N_t$ 

$N_t$ cancels out from the left size and we get

$N_{t+1}=\lambda*N_t$

This tells us that the population size next year (N.t+1) be calculated as lambda*(current population size).

In 1990 it was estimated that there were 265 KIWA males with territories.  If lambda = 1.3 as we calculated earlier, we'd predict that in 1991 the population size would be 

$N_{1991}=\lambda*N_{1990}$
$N_{1991}= 1.3*265 = 344.5$

So we'd predict there to be 344 or 345 birds in 1991.  Indeed, researchers observed 347 birds.

When you plug the output of an equation (eg $N_{1991}=344$) back into itself repeatedly this is called **recursion.** 

The equation 

$N_{t+1}=\lambda*N_t$

is therefore sometimes referred to as a **recursion equation**.  (Similar terms are **iterate** and **iteratively**.) 

## Exponential population growth

If you take the population size of 344 orioles from our last calculation and plug it back into the population growth equation like this to estimate the number of orioles in the next year, 1992:

$N_{1992}=1.3*344 = 447.2$

The estimated population the following year will be about 447 KIWA males.  In reality, thee were 497 males counted, so our projection is a bit high.

If you repeat this 8 more times (for 10 total years of population change) we can project the population size for a decade.  Note the curvature to the line.  This upward, accelerating curve is an **exponential growth curve**.

```{r, echo = F}
yr <- seq(1990,2000)
N <- 265
lambda <- 1.3
N.t <- c(N, rep(NA,10))
for(i in 2:length(N.t)){
  N.t[i] <- N.t[i-1]*lambda
}
length(N.t)
length(yr)
plot(N.t ~ yr, type = "b", xlab = "Year", ylab = "Population size (N)")
```






---
title: "paried t tests"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{paried t tests}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, eval = T}
library(compbio4all)
```




# Two equivalent ways to set up a paired t-test in R

First, I'll set up some random data.  Let's say this is the heart of 5 students before they take my test and after the test.  This first chunk of R code just makes the data and can be ignored

```{r}
#Make some fake data
students <- c("Zetta","Jude","April","Hendrick","Cindy", "Modou","Percy")

n <- length(students)
before.test <- round(runif(n, 45,65),1)

after.test <- round(before.test + 10 + 
                      rnorm(n, 0,3),1)

data.2.num.columns <- data.frame(students, before.test,after.test)


data.1.num.column <- data.frame(students = rep(students,2),
heart.rate = c(before.test, after.test),
when = c(rep("before",n), rep("after",n)))
```


Data for a paired t-test can be made two different ways.  First, it can be in a format where each of the two measurements on a subject/object/etc is in a sperate column.  There are therefore two columns of numeric data. One column is for the 1st time point (before), the other column is for the 2nd time point (after)

```{r}
data.2.num.columns
```

Alternative, the data can be set up with all of the numeric data in a single column.  That is, the "before" data are stacked in a single column on top of the "After" data.  Then, which time an observation corresponds to is indicated in another column.  Here, the 1st 7 rows are from the "before" time period and the 2nd 7 rows are from the "after" time period. 
```{r}
data.1.num.column
```
Note that the names of the subjects occur in the **exact same order** within both groups.  The first person listed is Zetta in row 1, which is a "before" " measurement.  The first "after" measurement  (row 8) must therefore also be Zetta.  The 2nd "before" row is for Jude, and therefore the 2nd "After" measurement must be for Jude (row 9).  If the order is perfect and you do a paired t-test on the data, the answer will be wrong.


# Paired T-test on 2 column data

For the first data set, we can calculate the difference betweeen the measurements and then do a one-sample t-test on the differences between the before and aftter

First, do the math
```{r}
data.2.num.columns$before.minus.after <- data.2.num.columns$before.test - data.2.num.columns$after.test

```

Then do the one-sample t-test
```{r}
t.test(data.2.num.columns$before.minus.after,
        mu = 0)
```

Note that you get the exact same answer if you do after minus before, just the t-value is the opposite sign.
```{r}
data.2.num.columns$after.minus.before <-data.2.num.columns$after.test - data.2.num.columns$before.test

t.test(data.2.num.columns$after.minus.before,
        mu = 0)
```


# Paired t-test on one column of data

We can have R do the math for us if the data is organized with all the numeric data in a single column.  However, the data MUST be oragnized properly.

```{r}
t.test(heart.rate ~ when, 
       data = data.1.num.column,
       paired = TRUE)
```


Note that I MUST include ** paired = TRUE **.  If we foret this we will run a standard two-sample test and get the wrong answer.  Try it to see what happens.  The t value will be wrong as well as the degrees of freedom.

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UPGMA in R - the hard way - deprecated? • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="UPGMA in R - the hard way - deprecated?">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lll-UPGMA_wikipedia_homework_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>UPGMA in R - the hard way - deprecated?</h1>
            
      
      
      <div class="hidden name"><code>lll-UPGMA_wikipedia_homework.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<div id="libraries" class="section level2">
<h2 class="hasAnchor">
<a href="#libraries" class="anchor"></a>Libraries</h2>
<p>We’ll need the ape package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("ape")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="function-well-use" class="section level2">
<h2 class="hasAnchor">
<a href="#function-well-use" class="anchor"></a>Function we’ll use</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">plot_dist_as_nmds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">{</span>
  <span class="va">matno0</span> <span class="op">&lt;-</span> <span class="va">mat</span>
  
<span class="va">matno0</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">matno0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>


<span class="va">d2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">matno0</span>, add <span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, main <span class="op">=</span> <span class="st">"APPROXIMATE 2D distances"</span>,
     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>, 
     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span>

<span class="op">}</span></code></pre></div>
</div>
<div id="data-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#data-matrix" class="anchor"></a>Data matrix</h2>
<p>Data matrix from <a href="https://en.wikipedia.org/wiki/UPGMA#First_step" class="uri">https://en.wikipedia.org/wiki/UPGMA#First_step</a></p>
<p>One way to make the data is to rbind() individual vectors as rows</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#      a   b   c   d   e</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">17</span>, <span class="fl">21</span>, <span class="fl">31</span>, <span class="fl">23</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">0</span>,    <span class="fl">30</span>, <span class="fl">34</span>, <span class="fl">21</span><span class="op">)</span>
<span class="va">c</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">30</span>, <span class="fl">0</span>,  <span class="fl">28</span>, <span class="fl">39</span><span class="op">)</span>
<span class="va">d</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">31</span>, <span class="fl">34</span>, <span class="fl">28</span>,    <span class="fl">0</span>, <span class="fl">43</span><span class="op">)</span>
<span class="va">e</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">21</span>, <span class="fl">39</span>, <span class="fl">43</span>,    <span class="fl">0</span><span class="op">)</span>
<span class="va">dmat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span>,<span class="va">d</span>,<span class="va">e</span><span class="op">)</span></code></pre></div>
<p>Looks like this</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dmat1</span>
<span class="co">#&gt;   [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; a    0   17   21   31   23</span>
<span class="co">#&gt; b   17    0   30   34   21</span>
<span class="co">#&gt; c   21   30    0   28   39</span>
<span class="co">#&gt; d   31   34   28    0   43</span>
<span class="co">#&gt; e   23   21   39   43    0</span></code></pre></div>
<p>Add names</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"e"</span><span class="op">)</span></code></pre></div>
<p>The matrix is symmetrical. Its easier if you make redundant elements NA because we don’t need them.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">dmat1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></code></pre></div>
<p>Matrix now looks like this</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dmat1</span>
<span class="co">#&gt;    a  b  c  d  e</span>
<span class="co">#&gt; a NA NA NA NA NA</span>
<span class="co">#&gt; b 17 NA NA NA NA</span>
<span class="co">#&gt; c 21 30 NA NA NA</span>
<span class="co">#&gt; d 31 34 28 NA NA</span>
<span class="co">#&gt; e 23 21 39 43 NA</span></code></pre></div>
</div>
<div id="what-does-this-matrix-represent" class="section level2">
<h2 class="hasAnchor">
<a href="#what-does-this-matrix-represent" class="anchor"></a>What does this matrix represent?</h2>
<div id="genetic-distances-conceptualized-as-pairwise-linear-distances" class="section level3">
<h3 class="hasAnchor">
<a href="#genetic-distances-conceptualized-as-pairwise-linear-distances" class="anchor"></a>Genetic distances conceptualized as pairwise linear distances</h3>
<p>Each element of the matrix is a <strong>distance.</strong> In this case, it is the number of nucleotides that are different between two sequences. There are 5 sequences, and if each is compared against the other then there are 10 <strong>distances.</strong></p>
<p>(Mathematically these are called <strong>Hamming distances</strong>. You don’t need to memorize that).</p>
<p>Each distance is the distance between two species, and it can be conceptualized as a linear distance.</p>
<p>You could visualize each pairwise distance like this</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dmat1</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, 
     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span><span class="op">)</span>, 
     type <span class="op">=</span> <span class="st">"l"</span>,
     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Distance (number of mutations)"</span><span class="op">)</span>,
     ylab <span class="op">=</span> <span class="st">"Pairwise comparison"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, pch <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, pch <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">1</span>, 
         x1 <span class="op">=</span> <span class="va">dmat1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1.5</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We can look at all of them. Note that each line is independent and cannot be compared (the y axis has no meaning). This is NOT a 2D map!</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dmat1</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, 
     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span><span class="op">)</span>, 
     type <span class="op">=</span> <span class="st">"l"</span>,
     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Distance (number of mutations)"</span><span class="op">)</span>,
     ylab <span class="op">=</span> <span class="st">"Pairwise comparison"</span><span class="op">)</span>
<span class="va">pair.k</span> <span class="op">&lt;-</span><span class="fl">0</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>

<span class="va">dist.ij</span> <span class="op">&lt;-</span> <span class="va">dmat1</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> 
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dist.ij</span><span class="op">)</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span>
  <span class="va">pair.k</span> <span class="op">&lt;-</span> <span class="va">pair.k</span><span class="op">+</span><span class="fl">1</span>    

       
<span class="va">spp.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
<span class="va">spp.j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,               <span class="va">pair.k</span>, pch <span class="op">=</span> <span class="va">spp.j</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">LETTERS</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">spp.j</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.75</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">dist.ij</span><span class="op">+</span><span class="fl">0.75</span>,       <span class="va">pair.k</span>, pch <span class="op">=</span><span class="va">spp.i</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">LETTERS</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">spp.i</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.75</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="va">pair.k</span>, 
         x1 <span class="op">=</span> <span class="va">dist.ij</span>, y1 <span class="op">=</span> <span class="va">pair.k</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">pair.k</span><span class="op">+</span><span class="fl">0.5</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>

  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can see that the distance between a and b is the smallest, at 17 amino acid changes.</p>
</div>
<div id="genetic-distances-conceptualized-as-2d-linear-distances" class="section level3">
<h3 class="hasAnchor">
<a href="#genetic-distances-conceptualized-as-2d-linear-distances" class="anchor"></a>Genetic distances conceptualized as 2D linear distances</h3>
<p>We can extend the analogy of linear distance to two dimensions. With some fancy math we can make a 2D plot where the distances in 2D space are similar to the distances in the matrix.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">dmat1no0</span> <span class="op">&lt;-</span> <span class="va">dmat1</span>
  
<span class="va">dmat1no0</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dmat1no0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="va">d2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">dmat1no0</span>, add <span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, main <span class="op">=</span> <span class="st">"APPROXIMATE 2D distances"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>In this plot, things appear to have been distorted a bit, and b looks closer than e (to me).</p>
</div>
</div>
<div id="from-linear-distances-to-tree-distances" class="section level2">
<h2 class="hasAnchor">
<a href="#from-linear-distances-to-tree-distances" class="anchor"></a>From linear distances to “tree distances”</h2>
<p>Distances aren’t actually linear - we are assuming a “tree shape” to represent the divergence of two species genetically (and possibly geographically.)</p>
<p>The simplest methods of building trees assume that all branch lengths terminate at the same spot, and the total mutational distance traversed by each species is the same. (This is the assumption or constraint related to <strong>ultrametricity</strong>).</p>
<p>The distance between a and b is 17. We assume that both species a and species b have undergone the same number of mutations since they split, so the branch lengths for each are 17/2 = 8.5. (You obviously can’t have 8.5 mutations, but this is how the math works).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dmat1</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, 
     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span><span class="op">)</span>, 
     type <span class="op">=</span> <span class="st">"l"</span>,
     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Distance (number of mutations)"</span><span class="op">)</span>,
     ylab <span class="op">=</span> <span class="st">"Pairwise comparison"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, pch <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">dmat1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, pch <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">1</span>, 
         x1 <span class="op">=</span> <span class="va">dmat1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1.5</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>


<span class="va">branch.length</span> <span class="op">&lt;-</span> <span class="va">dmat1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">branch.length</span><span class="op">+</span><span class="fl">0.75</span>, <span class="fl">4</span>, pch <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">branch.length</span><span class="op">+</span><span class="fl">0.75</span>, <span class="fl">6</span>, pch <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">4</span>, 
         x1 <span class="op">=</span> <span class="va">branch.length</span>,y1 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">6</span>, 
         x1 <span class="op">=</span> <span class="va">branch.length</span>,y1 <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">4</span>, 
         x1 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">8</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="the-upgma-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#the-upgma-algorithm" class="anchor"></a>The UPGMA algorithm</h2>
<p>The UPGMA algorithm is described by Swofford et al (1996?, page 486) as below. The word “cluster” means “taxa” in some cases and “clade” in others. This is a bit tricky at first but once you get a sense for the whole algorithm it will make more sense.</p>
<ol style="list-style-type: decimal">
<li><p>“Given matrix of pairwise distances, find the clusters (taxa) i and j such the d.ij is the minmum value in the table.” (d.ij is the distane between taxa i and taxa j)</p></li>
<li><p>“Define the depth of the branching between i and j (l.ij) to be d.ij/2” (“depth of branching” = branch length; so i is attached to a branch of d.ij/2 and j is attached to a separate branch of d.ij/2)</p></li>
<li><p>“If i and j were the last two clusters, the tree is complete. Otherwise, create a new cluster called u”. This new cluster is a clade of i and j will represent the combined features of i and j.</p></li>
<li><p>“Define the distance from [the new cluster] u to each other [remaining] cluster (k, with k==i or j) [here cluster = clade] to be an average of the distnace d.ki and d.jk”. That is, calculate the distance from the clade u to all the remaining taxa, which we’ll generically call k. The new distnace will be called d.ku, for “distance from taxa k to clade u.” The exact calculation of the average can take different forms.</p></li>
<li><p>“Go back to step 1 with one less cluster; cluster i and j have been elimated, and cluster u has been added.” The distance matrix is now shrunk with all distance related to i and j removed and replaced by information about u.</p></li>
</ol>
<p>For step 4, UPGMA uses the following equation to calculate distances:</p>
<p>Ti = the number of taxa in cluster i. This is 1 if the “cluster” is a single species, or it can be &gt;1 if a previous iteration has created a clade.</p>
<p>Tj = the number of taxa in cluster j.</p>
<p>d.ku = the distance from k to u. k and u can be individual taxa or clades created by the algorithm.</p>
<p>d.ku = (Ti x d.ki + Tj x d.kj)/(Ti + Tj)</p>
<p>(You should lknow this equation, should be able to write R code to calcualte it, etc )</p>
<p>You can think of this as a <strong>weighted mean</strong> where the <strong>weights</strong> are the number of taxa in each clade. Its a bit annoying that the “U” in UPGMA means “un-weighted” even though there is weighting, but this is how the math people say we should think about it (the un-weighted part has to do with some other aspect of the math).</p>
<p>In the above outline of the algorithm, if i and j are the first two taxa grouped then the equation would be</p>
<p>d.ku = (Ti x d.ki + Tj x d.kj)/(Ti + Tj) d.ku = (1 x d.ki + 1 x d.kj)/(1 + 1) d.ku = (d.ki + d.kj)/2</p>
</div>
<div id="calculate-2d-representation" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-2d-representation" class="anchor"></a>Calculate 2D representation</h2>
<p>We can think about this using a 2D representation</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dmat1.out</span><span class="op">&lt;-</span> <span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>a and b are closest together, so we group them</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#install.packages(plotrix)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plotrix</span><span class="op">)</span>
<span class="va">dmat1.out</span><span class="op">&lt;-</span> <span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span>

<span class="co">#get x y coord of a and b</span>

<span class="va">a.</span><span class="op">&lt;-</span><span class="va">dmat1.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"a"</span>,<span class="op">]</span>
<span class="va">b.</span><span class="op">&lt;-</span><span class="va">dmat1.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"b"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/draw.ellipse.html">draw.ellipse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
             a <span class="op">=</span><span class="fl">3</span>, 
             b <span class="op">=</span> <span class="fl">10</span>, 
             angle <span class="op">=</span> <span class="fl">30</span>
             <span class="op">)</span>

     

<span class="co">#We then examine in turn the distance from a and b to each other point</span>


<span class="va">c.</span><span class="op">&lt;-</span><span class="va">dmat1.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"c"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>                                    </code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="co"># ab to c</span>
<span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span>
<span class="co">#&gt; $points</span>
<span class="co">#&gt;         [,1]       [,2]</span>
<span class="co">#&gt; a   6.606653  4.9400937</span>
<span class="co">#&gt; b  12.421702 -6.5267890</span>
<span class="co">#&gt; c  -9.532025 12.9665271</span>
<span class="co">#&gt; d -17.839642 -9.0739515</span>
<span class="co">#&gt; e  20.738283  0.4897976</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $eig</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ac</span>
<span class="co">#&gt; [1] -7.934712e-15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $GOF</span>
<span class="co">#&gt; [1] 0.6755273 0.9367305</span>

<span class="co">#get x y coord of a and b</span>
<span class="va">a.</span><span class="op">&lt;-</span><span class="va">dmat1.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"a"</span>,<span class="op">]</span>
<span class="va">b.</span><span class="op">&lt;-</span><span class="va">dmat1.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"b"</span>,<span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/draw.ellipse.html">draw.ellipse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
             a <span class="op">=</span><span class="fl">3</span>, 
             b <span class="op">=</span> <span class="fl">10</span>, 
             angle <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">c.</span><span class="op">&lt;-</span><span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"c"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>  

<span class="co"># ab to d</span>
<span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span>
<span class="co">#&gt; $points</span>
<span class="co">#&gt;         [,1]       [,2]</span>
<span class="co">#&gt; a   6.606653  4.9400937</span>
<span class="co">#&gt; b  12.421702 -6.5267890</span>
<span class="co">#&gt; c  -9.532025 12.9665271</span>
<span class="co">#&gt; d -17.839642 -9.0739515</span>
<span class="co">#&gt; e  20.738283  0.4897976</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $eig</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ac</span>
<span class="co">#&gt; [1] -7.934712e-15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $GOF</span>
<span class="co">#&gt; [1] 0.6755273 0.9367305</span>
<span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/draw.ellipse.html">draw.ellipse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
             a <span class="op">=</span><span class="fl">3</span>, 
             b <span class="op">=</span> <span class="fl">10</span>, 
             angle <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">d.</span><span class="op">&lt;-</span><span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"d"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>  

<span class="co"># ab to e</span>
<span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat1</span><span class="op">)</span>
<span class="co">#&gt; $points</span>
<span class="co">#&gt;         [,1]       [,2]</span>
<span class="co">#&gt; a   6.606653  4.9400937</span>
<span class="co">#&gt; b  12.421702 -6.5267890</span>
<span class="co">#&gt; c  -9.532025 12.9665271</span>
<span class="co">#&gt; d -17.839642 -9.0739515</span>
<span class="co">#&gt; e  20.738283  0.4897976</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $eig</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ac</span>
<span class="co">#&gt; [1] -7.934712e-15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $GOF</span>
<span class="co">#&gt; [1] 0.6755273 0.9367305</span>
<span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/draw.ellipse.html">draw.ellipse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
             a <span class="op">=</span><span class="fl">3</span>, 
             b <span class="op">=</span> <span class="fl">10</span>, 
             angle <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">e.</span><span class="op">&lt;-</span><span class="va">d2</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"e"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">e.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">a.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">e.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">e.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">b.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">e.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> </code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div id="algorithm---round-1" class="section level2">
<h2 class="hasAnchor">
<a href="#algorithm---round-1" class="anchor"></a>Algorithm - round 1</h2>
<div id="determine-minimum-value-in-current-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#determine-minimum-value-in-current-matrix" class="anchor"></a>Determine minimum value in current matrix</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist.min.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dmat1</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div id="combine-species-into-clade" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-species-into-clade" class="anchor"></a>Combine species into clade</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clade.i</span> <span class="op">&lt;-</span> <span class="st">"ab"</span>
<span class="va">clade.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
</div>
<div id="calcualte-distance-from-clade-to-all-other-points" class="section level3">
<h3 class="hasAnchor">
<a href="#calcualte-distance-from-clade-to-all-other-points" class="anchor"></a>Calcualte distance from clade to all other points</h3>
<p>Distance (ab) to all other points ab to c ab to d ab to e</p>
<div id="ab-to-c" class="section level4">
<h4 class="hasAnchor">
<a href="#ab-to-c" class="anchor"></a>ab to c</h4>
<p>This is calculated at the average of the distance from a to c and b to c</p>
<p>D(ab to c) = [D(a to c) + D(b to c)] / 2 D(ab to c) = [ 21 + 30 ] / 2 D(ab to c) = [ 21 + 30 ] / 2 D(ab to c) = 25.5</p>
<p>Dab_c = [Da_c + Db_c] / 2 Dab_c = 25.5</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Da_c</span> <span class="op">&lt;-</span> <span class="fl">21</span>
<span class="va">Db_c</span> <span class="op">&lt;-</span> <span class="fl">30</span>
<span class="va">Dab_c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Da_c</span><span class="op">+</span><span class="va">Db_c</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></code></pre></div>
<p>For reasons that will become clear below, the math is most accurately written out as</p>
<p>D(ab to c) = [D(a to c)<em>1 + D(b to c)</em>1] / (1+1) D(ab to c) = [ 21<em>1 + 30</em>1 ] / (1+1) D(ab to c) = [ 21<em>1 + 30</em>1 ] / (1+1) D(ab to c) = 25.5</p>
<p>Dab_c = [Da_c<em>1 + Db_c</em>1] / (1+1) Dab_c = 25.5</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Da_c</span> <span class="op">&lt;-</span> <span class="fl">21</span>
<span class="va">Db_c</span> <span class="op">&lt;-</span> <span class="fl">30</span>
<span class="va">Dab_c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Da_c</span><span class="op">*</span><span class="fl">1</span><span class="op">+</span><span class="va">Db_c</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="ab-to-d" class="section level4">
<h4 class="hasAnchor">
<a href="#ab-to-d" class="anchor"></a>ab to d</h4>
<p>D(ab to d) = [D(a to d) + D(b to d)] / 2 D(ab to d) = [ 31 + 34 ] / 2 D(ab to d) = [ 31 + 34 ] / 2 D(ab to d) = 32.5</p>
<p>Dab_d = [Da_d + Db_d] / 2 Dab_d = 32.5</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Da_d</span> <span class="op">&lt;-</span> <span class="fl">31</span>
<span class="va">Db_d</span> <span class="op">&lt;-</span> <span class="fl">34</span>
<span class="va">Dab_d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Da_d</span><span class="op">+</span><span class="va">Db_d</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></code></pre></div>
</div>
<div id="ab-to-e" class="section level4">
<h4 class="hasAnchor">
<a href="#ab-to-e" class="anchor"></a>ab to e</h4>
<p>D(ab to d) = [D(a to d) + D(b to d)] / 2 D(ab to d) = [ 23 + 21 ] / 2 D(ab to d) = [ 23 + 21 ] / 2 D(ab to d) = Dab_e</p>
<p>Dab_d = [Da_d + Db_d] / 2 Dab_d = Dab_e</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">Da_e</span> <span class="op">&lt;-</span> <span class="fl">23</span>
<span class="va">Db_e</span> <span class="op">&lt;-</span> <span class="fl">21</span>
<span class="va">Dab_e</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Da_e</span><span class="op">+</span><span class="va">Db_e</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></code></pre></div>
</div>
</div>
<div id="update-matrix-with-new-distance" class="section level3">
<h3 class="hasAnchor">
<a href="#update-matrix-with-new-distance" class="anchor"></a>Update matrix with new distance</h3>
<p>Old matrix has distnaces from a and b to all other points: we want to replace these. distances among c, d, and e are still the same values.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dmat1</span>
<span class="co">#&gt;    a  b  c  d  e</span>
<span class="co">#&gt; a NA NA NA NA NA</span>
<span class="co">#&gt; b 17 NA NA NA NA</span>
<span class="co">#&gt; c 21 30 NA NA NA</span>
<span class="co">#&gt; d 31 34 28 NA NA</span>
<span class="co">#&gt; e 23 21 39 43 NA</span></code></pre></div>
<div id="illustration" class="section level4">
<h4 class="hasAnchor">
<a href="#illustration" class="anchor"></a>Illustration</h4>
<p>Values in parenthesese will be REPLACED</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(17)"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">c</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(21)"</span>, <span class="st">"(30)"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">d</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(31)"</span>, <span class="st">"(34)"</span>, <span class="st">"28"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">e</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(23)"</span>, <span class="st">"(21)"</span>, <span class="st">"39"</span>, <span class="st">"43"</span>,    <span class="cn">NA</span><span class="op">)</span>
<span class="va">dmat1.alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span>,<span class="va">d</span>,<span class="va">e</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dmat1.alt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"e"</span><span class="op">)</span>
<span class="va">dmat1.alt</span>
<span class="co">#&gt;   a      b      c    d    e </span>
<span class="co">#&gt; a NA     NA     NA   NA   NA</span>
<span class="co">#&gt; b "(17)" NA     NA   NA   NA</span>
<span class="co">#&gt; c "(21)" "(30)" NA   NA   NA</span>
<span class="co">#&gt; d "(31)" "(34)" "28" NA   NA</span>
<span class="co">#&gt; e "(23)" "(21)" "39" "43" NA</span></code></pre></div>
<p>Create smaller matrix with clade ab</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#       ab      c   d   e</span>
<span class="va">ab</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,    <span class="cn">NA</span>,  <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">c</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Dab_c</span>, <span class="cn">NA</span>,  <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">d</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Dab_d</span>, <span class="fl">28</span>,    <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">e</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Dab_e</span>, <span class="fl">39</span>,  <span class="fl">43</span>, <span class="cn">NA</span><span class="op">)</span>

<span class="va">dmat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ab</span>,<span class="va">c</span>,<span class="va">d</span>,<span class="va">e</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dmat2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ab"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"e"</span><span class="op">)</span></code></pre></div>
</div>
<div id="estimate-2-d" class="section level4">
<h4 class="hasAnchor">
<a href="#estimate-2-d" class="anchor"></a>Estimate 2 D</h4>
<p>Estimate of 2D representation.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat2</span><span class="op">)</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<pre><code>#&gt; $points
#&gt;          [,1]       [,2]
#&gt; ab  13.453890 -3.0373250
#&gt; c   -6.600828 13.4680501
#&gt; d  -16.726270 -8.5744114
#&gt; e   19.948871 -0.6844397
#&gt; 
#&gt; $eig
#&gt; NULL
#&gt; 
#&gt; $x
#&gt; NULL
#&gt; 
#&gt; $ac
#&gt; [1] -4.570935e-15
#&gt; 
#&gt; $GOF
#&gt; [1] 0.7573625 1.0000000</code></pre>
</div>
</div>
</div>
<div id="algorithm---round-2" class="section level2">
<h2 class="hasAnchor">
<a href="#algorithm---round-2" class="anchor"></a>Algorithm - round 2</h2>
<p>We’ve combined a and b and calcualted the disnace of this clade (a,b) to the remaining taxa. What is now the minimum distance?</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist.min.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dmat2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>In the current matrix, the smallest distance is between ab and e</p>
<p>We therefore want to form a clade between ab and e (abe) all the other remaining species.</p>
<p>Visualize this as an approximate 2D situation</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">dmat2.out</span> <span class="op">&lt;-</span> <span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat2</span><span class="op">)</span>

<span class="co">#get x y coord of ab and e</span>
<span class="va">ab.</span><span class="op">&lt;-</span><span class="va">dmat2.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"ab"</span>,<span class="op">]</span>
<span class="va">e.</span><span class="op">&lt;-</span><span class="va">dmat2.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"e"</span>,<span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/draw.ellipse.html">draw.ellipse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ab.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">e.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ab.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">e.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
             a <span class="op">=</span><span class="fl">7</span>, 
             b <span class="op">=</span> <span class="fl">7</span>, 
             angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">c.</span><span class="op">&lt;-</span><span class="va">dmat2.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"c"</span>,<span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">ab.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">ab.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">e.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">e.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> </code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div id="abe-to-c" class="section level4">
<h4 class="hasAnchor">
<a href="#abe-to-c" class="anchor"></a>abe to c</h4>
<p>NOTE: calculations are “weighted” in proportion number of species in clade.</p>
<p>So D(ab to c) is multiplied by two because ab is 2 species</p>
<p>The denominators is 3 because of the weights used in the numerator.</p>
<p>D(abe to c) = [D(ab to c)<em>2 + D(e to c)</em>1] / (2+1) D(abe to c) = [ 25.5<em>2 + 39</em>1 ] / (2+1) D(abe to c) = [ 25.5<em>2 + 39</em>1 ] / (2+1) D(abe to c) = 32.5</p>
<p>Dabe_c = [Dab_c<em>2 + De_c</em>1] / (2+1) Dabe_c = 32.5</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Dab_c</span> <span class="op">&lt;-</span> <span class="fl">25.5</span>
<span class="va">De_c</span>  <span class="op">&lt;-</span> <span class="fl">39</span>
<span class="va">Dabe_c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Dab_c</span><span class="op">*</span><span class="fl">2</span> <span class="op">+</span> <span class="va">De_c</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="abe-to-c-1" class="section level4">
<h4 class="hasAnchor">
<a href="#abe-to-c-1" class="anchor"></a>abe to c</h4>
<p>For abe to d</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Dab_d</span> <span class="op">&lt;-</span> <span class="fl">32.5</span>
<span class="va">De_d</span>  <span class="op">&lt;-</span> <span class="fl">43</span>
<span class="va">Dabe_d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Dab_d</span><span class="op">*</span><span class="fl">2</span> <span class="op">+</span> <span class="va">De_d</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="update-the-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#update-the-matrix" class="anchor"></a>Update the matrix</h3>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">abe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,     <span class="cn">NA</span>,  <span class="cn">NA</span><span class="op">)</span>
<span class="va">c</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Dabe_c</span>, <span class="cn">NA</span>,  <span class="cn">NA</span><span class="op">)</span>
<span class="va">d</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Dabe_d</span>, <span class="fl">28</span>,  <span class="cn">NA</span><span class="op">)</span>


<span class="va">dmat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">abe</span>,<span class="va">c</span>,<span class="va">d</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dmat3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"abe"</span>,<span class="st">"c"</span>,<span class="st">"d"</span><span class="op">)</span></code></pre></div>
<div id="estimate-2-d-1" class="section level4">
<h4 class="hasAnchor">
<a href="#estimate-2-d-1" class="anchor"></a>Estimate 2 D</h4>
<p>a, b, e are now combined into a clade</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat3</span><span class="op">)</span></code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<pre><code>#&gt; $points
#&gt;          [,1]       [,2]
#&gt; abe 13.740369   4.324243
#&gt; c   -3.199711 -10.782653
#&gt; d   -9.841358   9.543201
#&gt; 
#&gt; $eig
#&gt; NULL
#&gt; 
#&gt; $x
#&gt; NULL
#&gt; 
#&gt; $ac
#&gt; [1] -3.743798e-15
#&gt; 
#&gt; $GOF
#&gt; [1] 0.9538384 1.0000000</code></pre>
</div>
</div>
</div>
<div id="iteration-3" class="section level2">
<h2 class="hasAnchor">
<a href="#iteration-3" class="anchor"></a>Iteration 3</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dist.min.i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dmat3</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">dmat3.out</span> <span class="op">&lt;-</span> <span class="fu">plot_dist_as_nmds</span><span class="op">(</span><span class="va">dmat3</span><span class="op">)</span>

<span class="co">#get x y coord of ab and e</span>
<span class="va">c.</span> <span class="op">&lt;-</span><span class="va">dmat3.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"c"</span>,<span class="op">]</span>
<span class="va">d.</span><span class="op">&lt;-</span><span class="va">dmat3.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"d"</span>,<span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/draw.ellipse.html">draw.ellipse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">d.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
             a <span class="op">=</span><span class="fl">14</span>, 
             b <span class="op">=</span> <span class="fl">4</span>, 
             angle <span class="op">=</span> <span class="fl">105</span><span class="op">)</span>
<span class="va">abe.</span><span class="op">&lt;-</span><span class="va">dmat3.out</span><span class="op">$</span><span class="va">points</span><span class="op">[</span><span class="st">"abe"</span>,<span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">abe.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">c.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">abe.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="va">abe.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
         y0 <span class="op">=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,y1 <span class="op">=</span> <span class="va">abe.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> </code></pre></div>
<p><img src="lll-UPGMA_wikipedia_homework_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div id="distance-of-c-to-abe-and-d-to-abe" class="section level3">
<h3 class="hasAnchor">
<a href="#distance-of-c-to-abe-and-d-to-abe" class="anchor"></a>Distance of c to abe and d to abe</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Dc_abe</span> <span class="op">&lt;-</span> <span class="fl">30</span>
<span class="va">Dd_abe</span> <span class="op">&lt;-</span> <span class="fl">36</span>

<span class="co"># abe is composted of 3 </span>
<span class="va">Ddc_abe</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Dc_abe</span><span class="op">*</span><span class="fl">3</span> <span class="op">+</span> <span class="va">Dd_abe</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">3</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span>

<span class="co"># factor out 3</span>
<span class="va">Ddc_abe</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="va">Dc_abe</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Dd_abe</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">6</span>

<span class="co"># simplify</span>
<span class="va">Ddc_abe</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">Dc_abe</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Dd_abe</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
<span class="va">Ddc_abe</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Dc_abe</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Dd_abe</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></code></pre></div>
<p>Create matrix</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">abe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,     <span class="cn">NA</span><span class="op">)</span>
<span class="va">cd</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Ddc_abe</span>, <span class="cn">NA</span><span class="op">)</span>



<span class="va">dmat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">abe</span>,<span class="va">cd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dmat4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"abe"</span>,<span class="st">"cd"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pevsner Chapter 3: BLAST Algorithm in R (kinda) • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pevsner Chapter 3: BLAST Algorithm in R (kinda)">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fff-blast-Pevsner_Ch4_figure4_12_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pevsner Chapter 3: BLAST Algorithm in R (kinda)</h1>
            
      
      
      <div class="hidden name"><code>fff-blast-Pevsner_Ch4_figure4_12.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This tutorial shows how to reproduce key initial steps in the BLAST algorithm that are represented in “Phase 1” of Figure 4.12 of Pevsner (page 139). Refer to Pevsner 138-141 for full details. This corresponds with the first two bullet points on page 138, (often called 1 = “Setup”, 2 = “Scanning”).</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<p>We need the Biostrings package and the <strong>BLOSUM62 matrix</strong>. BLOSUM is an alignment scoring systems that was created using a different approach but has the same goal as PAM matrices. BLOSUM62 is the <strong>default matrix</strong> for BLAST calcualtions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What is Biostrings?</span>
<span class="co"># Where is it located prior to running library()?</span>
<span class="co"># What changes when I run library()?</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Biostrings</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: BiocGenerics</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'BiocGenerics'</span>
<span class="co">#&gt; The following objects are masked from 'package:parallel':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
<span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
<span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     IQR, mad, sd, var, xtabs</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
<span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
<span class="co">#&gt;     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
<span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
<span class="co">#&gt;     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
<span class="co">#&gt;     union, unique, unsplit, which, which.max, which.min</span>
<span class="co">#&gt; Loading required package: S4Vectors</span>
<span class="co">#&gt; Loading required package: stats4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'S4Vectors'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand.grid</span>
<span class="co">#&gt; Loading required package: IRanges</span>
<span class="co">#&gt; Loading required package: XVector</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'Biostrings'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     strsplit</span>

<span class="co"># The BLOSUM62 matrix is stored as an R object within Biostrings</span>
<span class="co">## The data() function loads it into memory so it can be accessed.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"BLOSUM62"</span><span class="op">)</span>

<span class="va">BLOSUM62</span>
<span class="co">#&gt;    A  R  N  D  C  Q  E  G  H  I  L  K  M  F  P  S  T  W  Y  V  B  J  Z  X  *</span>
<span class="co">#&gt; A  4 -1 -2 -2  0 -1 -1  0 -2 -1 -1 -1 -1 -2 -1  1  0 -3 -2  0 -2 -1 -1 -1 -4</span>
<span class="co">#&gt; R -1  5  0 -2 -3  1  0 -2  0 -3 -2  2 -1 -3 -2 -1 -1 -3 -2 -3 -1 -2  0 -1 -4</span>
<span class="co">#&gt; N -2  0  6  1 -3  0  0  0  1 -3 -3  0 -2 -3 -2  1  0 -4 -2 -3  4 -3  0 -1 -4</span>
<span class="co">#&gt; D -2 -2  1  6 -3  0  2 -1 -1 -3 -4 -1 -3 -3 -1  0 -1 -4 -3 -3  4 -3  1 -1 -4</span>
<span class="co">#&gt; C  0 -3 -3 -3  9 -3 -4 -3 -3 -1 -1 -3 -1 -2 -3 -1 -1 -2 -2 -1 -3 -1 -3 -1 -4</span>
<span class="co">#&gt; Q -1  1  0  0 -3  5  2 -2  0 -3 -2  1  0 -3 -1  0 -1 -2 -1 -2  0 -2  4 -1 -4</span>
<span class="co">#&gt; E -1  0  0  2 -4  2  5 -2  0 -3 -3  1 -2 -3 -1  0 -1 -3 -2 -2  1 -3  4 -1 -4</span>
<span class="co">#&gt; G  0 -2  0 -1 -3 -2 -2  6 -2 -4 -4 -2 -3 -3 -2  0 -2 -2 -3 -3 -1 -4 -2 -1 -4</span>
<span class="co">#&gt; H -2  0  1 -1 -3  0  0 -2  8 -3 -3 -1 -2 -1 -2 -1 -2 -2  2 -3  0 -3  0 -1 -4</span>
<span class="co">#&gt; I -1 -3 -3 -3 -1 -3 -3 -4 -3  4  2 -3  1  0 -3 -2 -1 -3 -1  3 -3  3 -3 -1 -4</span>
<span class="co">#&gt; L -1 -2 -3 -4 -1 -2 -3 -4 -3  2  4 -2  2  0 -3 -2 -1 -2 -1  1 -4  3 -3 -1 -4</span>
<span class="co">#&gt; K -1  2  0 -1 -3  1  1 -2 -1 -3 -2  5 -1 -3 -1  0 -1 -3 -2 -2  0 -3  1 -1 -4</span>
<span class="co">#&gt; M -1 -1 -2 -3 -1  0 -2 -3 -2  1  2 -1  5  0 -2 -1 -1 -1 -1  1 -3  2 -1 -1 -4</span>
<span class="co">#&gt; F -2 -3 -3 -3 -2 -3 -3 -3 -1  0  0 -3  0  6 -4 -2 -2  1  3 -1 -3  0 -3 -1 -4</span>
<span class="co">#&gt; P -1 -2 -2 -1 -3 -1 -1 -2 -2 -3 -3 -1 -2 -4  7 -1 -1 -4 -3 -2 -2 -3 -1 -1 -4</span>
<span class="co">#&gt; S  1 -1  1  0 -1  0  0  0 -1 -2 -2  0 -1 -2 -1  4  1 -3 -2 -2  0 -2  0 -1 -4</span>
<span class="co">#&gt; T  0 -1  0 -1 -1 -1 -1 -2 -2 -1 -1 -1 -1 -2 -1  1  5 -2 -2  0 -1 -1 -1 -1 -4</span>
<span class="co">#&gt; W -3 -3 -4 -4 -2 -2 -3 -2 -2 -3 -2 -3 -1  1 -4 -3 -2 11  2 -3 -4 -2 -2 -1 -4</span>
<span class="co">#&gt; Y -2 -2 -2 -3 -2 -1 -2 -3  2 -1 -1 -2 -1  3 -3 -2 -2  2  7 -1 -3 -1 -2 -1 -4</span>
<span class="co">#&gt; V  0 -3 -3 -3 -1 -2 -2 -3 -3  3  1 -2  1 -1 -2 -2  0 -3 -1  4 -3  2 -2 -1 -4</span>
<span class="co">#&gt; B -2 -1  4  4 -3  0  1 -1  0 -3 -4  0 -3 -3 -2  0 -1 -4 -3 -3  4 -3  0 -1 -4</span>
<span class="co">#&gt; J -1 -2 -3 -3 -1 -2 -3 -4 -3  3  3 -3  2  0 -3 -2 -1 -2 -1  2 -3  3 -3 -1 -4</span>
<span class="co">#&gt; Z -1  0  0  1 -3  4  4 -2  0 -3 -3  1 -1 -3 -1  0 -1 -2 -2 -2  0 -3  4 -1 -4</span>
<span class="co">#&gt; X -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -4</span>
<span class="co">#&gt; * -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4  1</span></code></pre></div>
</div>
<div id="creating-a-vector-of-amino-acids" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-vector-of-amino-acids" class="anchor"></a>Creating a vector of amino acids</h2>
<p>R has a built-in list of all letters in the alphabet</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LETTERS</span>
<span class="co">#&gt;  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R" "S"</span>
<span class="co">#&gt; [20] "T" "U" "V" "W" "X" "Y" "Z"</span></code></pre></div>
<p>Not all letters have amino acids:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">26</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1] "B" "J" "O" "U" "X" "Z"</span></code></pre></div>
<p>I can make a vector of the indices of these letters which are amino acids.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">not.an.aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">21</span>,<span class="fl">24</span>,<span class="fl">26</span><span class="op">)</span></code></pre></div>
<p>I can then use <strong>“negative indexing”</strong> to remove letters that don’t correspond to an amino acid. Using negative indexing here is easier than the alternative.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What would the alternative to negative indexing be?</span>
<span class="va">aas</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="op">-</span><span class="va">not.an.aa</span><span class="op">]</span></code></pre></div>
</div>
<div id="creating-the-master-blast-word-list" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-the-master-blast-word-list" class="anchor"></a>Creating the master BLAST Word list</h2>
<p>I want to make a list of ALL possible BLAST words. I call this the <strong>BLAST master word list</strong>, though I made this term up. How many BLAST words are possible?</p>
<p>I can use a fancy R function expand.grid() to make this word list. I don’t expect you to know how to use this function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">words.list.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>let1 <span class="op">=</span> <span class="va">aas</span>,
                              let2 <span class="op">=</span> <span class="va">aas</span>,
                              let3 <span class="op">=</span> <span class="va">aas</span>,
                       stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<p>What have I done here?</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">words.list.all</span><span class="op">)</span>
<span class="co">#&gt;   let1 let2 let3</span>
<span class="co">#&gt; 1    A    A    A</span>
<span class="co">#&gt; 2    C    A    A</span>
<span class="co">#&gt; 3    D    A    A</span>
<span class="co">#&gt; 4    E    A    A</span>
<span class="co">#&gt; 5    F    A    A</span>
<span class="co">#&gt; 6    G    A    A</span></code></pre></div>
<p>How many unique words are there?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">n.words</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">words.list.all</span><span class="op">)</span></code></pre></div>
</div>
<div id="accessing-query-sequence" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-query-sequence" class="anchor"></a>Accessing query sequence</h2>
<p>Pevsner uses the sequence of human beta globin subunit B as his <strong>query sequence</strong>. The <strong>accession number</strong> is NP_000509.1 and its located at <a href="https://www.ncbi.nlm.nih.gov/protein/4504349" class="uri">https://www.ncbi.nlm.nih.gov/protein/4504349</a></p>
<p>I can download this directly from NCBI using entrez_fetch()</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#you may have to install the rentrez package</span>
<span class="co">## install.packates("rentrez")</span>
<span class="co"># load library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rentrez/">rentrez</a></span><span class="op">)</span>

<span class="co">#download sequence( this is also pasted below)</span>
<span class="va">fasta.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rentrez/reference/entrez_fetch.html">entrez_fetch</a></span><span class="op">(</span>db <span class="op">=</span> <span class="st">"protein"</span>,    <span class="co"># ?</span>
                        id <span class="op">=</span> <span class="st">"NP_000509.1"</span>,  <span class="co"># ?</span>
                        rettype <span class="op">=</span> <span class="st">"fasta"</span><span class="op">)</span>   <span class="co"># ?</span></code></pre></div>
<p>A <strong>FASTA file</strong> provides this sequence, which I’m putting into a vector. If entrez_fetch() doesn’t work for some reason I can copy and paste the fasta file from the web.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">hbb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MVHLTPEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTQRFFESFGDLSTPDAVMGNPKVKAHGKKVLG
AFSDGLAHLDNLKGTFATLSELHCDKLHVDPENFRLLGNVLVCVLAHHFGKEFTPPVQAAYQKVVAGVAN
ALAHKYH"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">hbb</span><span class="op">)</span>
<span class="co">#&gt; [1] 149</span></code></pre></div>
<p>Remove the slash n with the <strong>regular expression</strong> gsub().</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">hbb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\n"</span>, <span class="st">""</span>,  <span class="va">hbb</span><span class="op">)</span></code></pre></div>
<p>I will split raw <strong>character string</strong> into a vector of characters with strsplit(), with each character occuping one slot in the vector. (strsplit outputs a list for some reason, so I use unlist to make it into a vector)</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hbb.split.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">hbb</span>,<span class="st">""</span><span class="op">)</span>
<span class="fu">is</span><span class="op">(</span><span class="va">hbb.split.list</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"             "vector"           "list_OR_List"     "vector_OR_Vector"</span>
<span class="co">#&gt; [5] "vector_OR_factor"</span>

<span class="co">#raw output is list; convert to vector</span>
<span class="va">hbb.split.vect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">hbb.split.list</span><span class="op">)</span>

<span class="fu">is</span><span class="op">(</span><span class="va">hbb.split.vect</span><span class="op">)</span>
<span class="co">#&gt; [1] "character"             "vector"                "data.frameRowLabels"  </span>
<span class="co">#&gt; [4] "SuperClassMethod"      "characterORconnection" "character_OR_NULL"    </span>
<span class="co">#&gt; [7] "atomic"                "vector_OR_Vector"      "vector_OR_factor"</span></code></pre></div>
</div>
<div id="creating-working-word-list-from-query-sequence" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-working-word-list-from-query-sequence" class="anchor"></a>Creating working word list from query sequence</h2>
<p>Create the list of words in the gene. The default for protein BLAST (blastp) is to use words with 3 letters. I therefore want to build up my working database of words from the first three amino acids (MVH) to the last 3 amnio acids (KYH). Its easy for me to get the total number of amino acids with length(), but I need to do a little math (length(x)-2) to make my code stop at the last full word.</p>
<p>First some prep; I’ll make a vector called length.working which tells me how many words I need to make. This will be used within a for() loop to tell R how many iterations to do.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First, the Total length of hbb polypeptide</span>
<span class="va">length.total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">hbb.split.vect</span><span class="op">)</span>

<span class="co"># Second, the number of full 3-letter words</span>
<span class="co">#to make the loop work I need to not go all the way to end</span>
<span class="co">## this will make sense in a second</span>
<span class="va">length.working</span> <span class="op">&lt;-</span> <span class="va">length.total</span><span class="op">-</span><span class="fl">2</span></code></pre></div>
<p>I’ll need a matrix to store my words extracted from the query sequence.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">word.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, 
                      nrow <span class="op">=</span> <span class="va">length.working</span>, 
                      ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>Now I’ll looping over the query sequence vector and grab 3 letters at a time and put them into a matrix. Each word will take up one row in the matrix.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">length.working</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co">#get the letters</span>
  <span class="co">## get the first leter, which = i</span>
  <span class="va">letter1</span> <span class="op">&lt;-</span> <span class="va">hbb.split.vect</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  
  <span class="co">## get the 2nd letter, which = i+1</span>
  <span class="co">### this get the letter just down sequence from </span>
  <span class="co">### the first letter</span>
  <span class="va">letter2</span> <span class="op">&lt;-</span> <span class="va">hbb.split.vect</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>
  
  <span class="co">## get the 3rd letter</span>
  <span class="va">letter3</span> <span class="op">&lt;-</span> <span class="va">hbb.split.vect</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span>
  
  <span class="co"># Put the 3 letters in a vector</span>
  <span class="va">word.i.vect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">letter1</span>,<span class="va">letter2</span>,<span class="va">letter3</span><span class="op">)</span>
  
    <span class="co"># Shortcut: this is cleaner</span>
    <span class="co">#    word.i.vect &lt;- hbb.split.vect[c(i, i+1, i+2)]</span>
    
  <span class="co"># put the current word into a row of the storage matrix</span>
  <span class="va">word.matrix</span><span class="op">[</span><span class="va">i</span> ,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">word.i.vect</span>
  
<span class="op">}</span></code></pre></div>
<p>Currently, each word extracted from the query occupies a row of the matrix. The</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word.matrix</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,] "M"  "V"  "H" </span>
<span class="co">#&gt; [2,] "V"  "H"  "L" </span>
<span class="co">#&gt; [3,] "H"  "L"  "T" </span>
<span class="co">#&gt; [4,] "L"  "T"  "P" </span>
<span class="co">#&gt; [5,] "T"  "P"  "E" </span>
<span class="co">#&gt; [6,] "P"  "E"  "E"</span></code></pre></div>
<p>The first row is “M” “V” “H”, so the first words is “MVH”</p>
<p>I can check this again the original sequence; 1:3 extacts the first 3 elemtns of the matrix holding the hbb sequence</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hbb.split.vect</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="co">#&gt; [1] "M" "V" "H"</span></code></pre></div>
<p>I can compile these letters from the columns their in into the actual words, eg, go from “M” “V” “H” accross 3 columns to “MVH”</p>
<p>First, a place to store things</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">word.matrix</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now I’ll loop over each row of word.matrix and use the paste() command to take the letters from each column and put them together like a regular word.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">word.matrix</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">word.vector</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">word.matrix</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Aside: this isn’t a very R way to do this. An R pro would use the apply() function to avoid writing a loop explicitly.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.vector</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">word.matrix</span>,<span class="fl">1</span>,<span class="va">paste</span>,sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p>Regardless, the result looks like this (just showing the first 10 words)</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.vector</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] "MVH" "VHL" "HLT" "LTP" "TPE" "PEE" "EEK" "EKS" "KSA" "SAV"</span></code></pre></div>
<p>Pevsner uses words 12 through in his example in figure 4.12 page 139, starting wtih “VTA”</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pevs.words</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>
<span class="va">word.vector</span><span class="op">[</span><span class="va">pevs.words</span><span class="op">]</span>
<span class="co">#&gt; [1] "VTA" "TAL" "ALW" "LWG" "WGK" "GKV" "KVN" "VNV" "NVD"</span></code></pre></div>
</div>
<div id="words-overlap" class="section level2">
<h2 class="hasAnchor">
<a href="#words-overlap" class="anchor"></a>Words overlap</h2>
<p>BLAST words from a query sequence overlap. The “A” in the first word “VTA” therefore shows up in VTA TAL ALW</p>
<p>The following code just creates a matrix to illusate this this</p>
<p>First, a storage matrix</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">overlap.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="st">""</span>, nrow <span class="op">=</span> <span class="fl">20</span>, ncol <span class="op">=</span> <span class="fl">22</span><span class="op">)</span></code></pre></div>
<p>A loop to set things up</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span>
  <span class="va">overlap.matrix</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span>,<span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">word.matrix</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>
<span class="op">}</span>

<span class="co">#give it some names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">overlap.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hbb.split.vect</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span></code></pre></div>
<p>The code below shows the words that are shown in Pevsner Figure 4.12, page 139.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">overlap.matrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;       V   T   A   L   W   G   K   V   N   V   D  </span>
<span class="co">#&gt;  [1,] "V" "T" "A" ""  ""  ""  ""  ""  ""  ""  "" </span>
<span class="co">#&gt;  [2,] ""  "T" "A" "L" ""  ""  ""  ""  ""  ""  "" </span>
<span class="co">#&gt;  [3,] ""  ""  "A" "L" "W" ""  ""  ""  ""  ""  "" </span>
<span class="co">#&gt;  [4,] ""  ""  ""  "L" "W" "G" ""  ""  ""  ""  "" </span>
<span class="co">#&gt;  [5,] ""  ""  ""  ""  "W" "G" "K" ""  ""  ""  "" </span>
<span class="co">#&gt;  [6,] ""  ""  ""  ""  ""  "G" "K" "V" ""  ""  "" </span>
<span class="co">#&gt;  [7,] ""  ""  ""  ""  ""  ""  "K" "V" "N" ""  "" </span>
<span class="co">#&gt;  [8,] ""  ""  ""  ""  ""  ""  ""  "V" "N" "V" "" </span>
<span class="co">#&gt;  [9,] ""  ""  ""  ""  ""  ""  ""  ""  "N" "V" "D"</span></code></pre></div>
</div>
<div id="aside-word-frequencies" class="section level2">
<h2 class="hasAnchor">
<a href="#aside-word-frequencies" class="anchor"></a>Aside: word frequencies</h2>
<p>Note that is it possible for the same BLAST word to appear in more than one place within a query sequence. We can see if this occurs in our HBB gene. The table() function allows us to count up the number of occurrences of each word.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">word.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">word.vector</span><span class="op">)</span></code></pre></div>
<p>The order() function lets us create an index based on the number of times each word occures</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">i.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">word.table</span>,decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p>We can then display the words from most frequent to least frequent</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">word.table</span><span class="op">[</span><span class="va">i.order</span><span class="op">]</span></code></pre></div>
<p>How many words occur more than once?</p>
<p>We can also get a quick sense of things with the hist() command</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">word.table</span><span class="op">)</span></code></pre></div>
<p>The plot command tries to make sense of things but it kind of goes crazy</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">word.table</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p>This works a bit better</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">word.table</span><span class="op">[</span><span class="va">i.order</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p>Challenge: what is this code doing:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">word.table</span><span class="op">[</span><span class="va">i.order</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
</div>
<div id="determing-neighboring-words" class="section level2">
<h2 class="hasAnchor">
<a href="#determing-neighboring-words" class="anchor"></a>Determing neighboring words</h2>
<p>So far we’ve made</p>
<ol style="list-style-type: decimal">
<li>A list of ALL 8000 BLAST words</li>
<li>A list of all the words that occur in the HBB gene.</li>
</ol>
<p>Now we want to score all of the words in the HBB gene versus all of the words in the master word list. We’ll then take the highest scoring words and create smaller working list of words that are biochemically similar. Scoring is done using a matrix such as BLOSUM62.</p>
<p>Following Pevsner, we will use the 15th word LWG as an example and scores its alignment with each of the 8000 words in the word list.</p>
<p>First, a vector holding out focal word.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Focal BLAST "word" from Figure 4.12, "Phase 1", Pevsner pg 139.</span>
<span class="va">word.focal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L"</span>,<span class="st">"W"</span>,<span class="st">"G"</span><span class="op">)</span></code></pre></div>
<p>Make a place to store the scores when we compare LWG to the entire master word list. I"ll make the matrix, convert it to a dataframe and name the columns.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, 
                      nrow <span class="op">=</span> <span class="va">n.words</span>, 
                      ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="co"># convert to dataframe to make it easier to work with</span>
<span class="va">word.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span>

<span class="co">#assign column names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scrL1"</span>,<span class="st">"scrL2"</span>,<span class="st">"scrL3"</span><span class="op">)</span></code></pre></div>
<p>We’ll now loop through each word in the master word list (words.all) and score it with the BLOSUM62 matrix.</p>
<p>(To explore this loop line by line, you can set i to 1 and run the code below line by line)</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span></code></pre></div>
<p>The loop is presented below. Its not a clean as it could be, but this is partially so I can set it up for future, more general use. As a challenge, can you spot lines of the code that could be taken out of the loop and run on their own?</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># For loop</span>
<span class="co"># This loop goes through each row of the master word matrix words.all</span>
<span class="co"># and does what with it?</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># word.focal has our focal word</span>
  <span class="co"># I want to get each letter from the focal word so</span>
  <span class="co"># I can compar it 1:1 with the letters</span>
  <span class="co"># in the word list</span>
  <span class="va">word.focal.letter1</span> <span class="op">&lt;-</span> <span class="va">word.focal</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">word.focal.letter2</span> <span class="op">&lt;-</span> <span class="va">word.focal</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">word.focal.letter3</span> <span class="op">&lt;-</span> <span class="va">word.focal</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  
  <span class="co">#getting something from words.list.all here...</span>
  <span class="co">## note that I'm just indexing by [i, 1], [i, 2], [i, 3]</span>
  <span class="co">## "i" is what is changing with each iteratio of the loop</span>
  <span class="co">## (so i starts as 1, does everything in the loop, then</span>
  <span class="co">##     i becomes 2, does everything in loop, then</span>
  <span class="co">##     i becomes 3, ... and so on up to ...)</span>
  <span class="co">## What is stored in words.list.all.letter1, words.list.all.letter2, words.list.all.letter3?</span>
  <span class="va">words.list.all.letter1</span> <span class="op">&lt;-</span> <span class="va">words.list.all</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>
  <span class="va">words.list.all.letter2</span> <span class="op">&lt;-</span> <span class="va">words.list.all</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>
  <span class="va">words.list.all.letter3</span> <span class="op">&lt;-</span> <span class="va">words.list.all</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span>
  
  <span class="co"># Again, word scores is a matrix to store data </span>
  <span class="co"># before I stated the loop</span>
  <span class="co"># i takes on a different value with each iteration of the loop</span>
  <span class="co"># what am I doing here?</span>
  <span class="va">word.scores</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">BLOSUM62</span><span class="op">[</span><span class="va">word.focal.letter1</span>, <span class="va">words.list.all.letter1</span><span class="op">]</span>
  <span class="va">word.scores</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">BLOSUM62</span><span class="op">[</span><span class="va">word.focal.letter2</span>, <span class="va">words.list.all.letter2</span><span class="op">]</span>
  <span class="va">word.scores</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">BLOSUM62</span><span class="op">[</span><span class="va">word.focal.letter3</span>, <span class="va">words.list.all.letter3</span><span class="op">]</span>
<span class="op">}</span></code></pre></div>
<p>The output looks like this. Each row corresponds to an alignment between my one focal word from the query sequence (“L” “W” “G”) and eac of the 8000 words in the master word list.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span>
<span class="co">#&gt;   scrL1 scrL2 scrL3</span>
<span class="co">#&gt; 1    -1    -3     0</span>
<span class="co">#&gt; 2    -1    -3     0</span>
<span class="co">#&gt; 3    -4    -3     0</span>
<span class="co">#&gt; 4    -3    -3     0</span>
<span class="co">#&gt; 5     0    -3     0</span>
<span class="co">#&gt; 6    -4    -3     0</span></code></pre></div>
<p>Next, I loop over each row of scores and add them up and put them in a column for the total scores</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a column to store the scores</span>
<span class="va">word.scores</span><span class="op">$</span><span class="va">word.score</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="co"># the loop</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">word.scores</span><span class="op">$</span><span class="va">word.score</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Aside: what I just did is the opposite of how most R programmers would do it This is the R way of doing the above loop with sum() in is</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.scores</span><span class="op">$</span><span class="va">word.score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span></code></pre></div>
<p>What is the max score? How does this compare to Pevsner Figure 4.12</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">$</span><span class="va">word.score</span><span class="op">)</span>
<span class="co">#&gt; [1] 21</span></code></pre></div>
<p>To make things easier to look at, I’ll compress the columns holding all the words of the master word list into a single character vector. This is just to help me make a table that is easy to read.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># an empty vector made with the rep() function</span>
<span class="va">words.as.string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n.words</span><span class="op">)</span>

<span class="co"># loop over each word in the master word list</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">words.as.string</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">words.list.all</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Aside: what I just did is the opposite of how most R programmers would do it This is the R way of doing the above</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">words.as.string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">words.list.all</span>, <span class="fl">1</span>, <span class="va">paste0</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p>Now I’ll use cbind() to put the vector of words I just made (words.as.string) togther with my matrix of scores. This is just to make a handy table to see the output</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">words.as.string</span>,
                <span class="va">word.scores</span><span class="op">)</span></code></pre></div>
<p>The result looks like this</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">)</span>
<span class="co">#&gt;   words.as.string scrL1 scrL2 scrL3 word.score</span>
<span class="co">#&gt; 1             AAA    -1    -3     0         -4</span>
<span class="co">#&gt; 2             CAA    -1    -3     0         -4</span>
<span class="co">#&gt; 3             DAA    -4    -3     0         -7</span>
<span class="co">#&gt; 4             EAA    -3    -3     0         -6</span>
<span class="co">#&gt; 5             FAA     0    -3     0         -3</span>
<span class="co">#&gt; 6             GAA    -4    -3     0         -7</span></code></pre></div>
</div>
<div id="compare-scores-to-cutoff-t" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-scores-to-cutoff-t" class="anchor"></a>Compare scores to cutoff “T”</h2>
<p>What is the distribution of scores? BLAST uses a cuttoff “T”, which defaults to 11.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/gghistogram.html">gghistogram</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">word.scores</span>,
            x <span class="op">=</span> <span class="st">"word.score"</span>,
            xlab <span class="op">=</span> <span class="st">"Word score"</span>,
            ylab <span class="op">=</span> <span class="st">"Number of words"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">11</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p>I want just those above T. To demonstate this I’m going to remake more of Figure 4.12</p>
<p>First, some housekeeping. This code asures that the contents of “words.as.string” are in the format that I want</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.scores</span><span class="op">$</span><span class="va">words.as.string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">$</span><span class="va">words.as.string</span><span class="op">)</span></code></pre></div>
<p>Next, I’ll put things in order from highest to lowest score using order()</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">word.scores</span><span class="op">$</span><span class="va">word.score</span>,decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">word.scores.sorted</span> <span class="op">&lt;-</span> <span class="va">word.scores</span><span class="op">[</span><span class="va">i.order</span>, <span class="op">]</span></code></pre></div>
<p>I’ll check using head()</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word.scores.sorted</span><span class="op">)</span>
<span class="co">#&gt;      words.as.string scrL1 scrL2 scrL3 word.score</span>
<span class="co">#&gt; 2370             LWG     4    11     6         21</span>
<span class="co">#&gt; 2368             IWG     2    11     6         19</span>
<span class="co">#&gt; 2371             MWG     2    11     6         19</span>
<span class="co">#&gt; 2378             VWG     1    11     6         18</span>
<span class="co">#&gt; 2365             FWG     0    11     6         17</span>
<span class="co">#&gt; 2361             AWG    -1    11     6         16</span></code></pre></div>
<p>I want just those 11 or greater. I’ll use which() to locate them and then subset the matrix.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i.11.or.more</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">word.scores.sorted</span><span class="op">$</span><span class="va">word.score</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span>

<span class="va">word.scores.above.t</span> <span class="op">&lt;-</span> <span class="va">word.scores.sorted</span><span class="op">[</span><span class="va">i.11.or.more</span>, <span class="op">]</span></code></pre></div>
<p>Pevsner uses T = 11, and further subsets based on representive words.</p>
<p>The words he uses are these 15</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig.4.12.aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LWG"</span>,<span class="st">"IWG"</span>,<span class="st">"MWG"</span>,<span class="st">"VWG"</span>,<span class="st">"FWG"</span>,
                 <span class="st">"AWG"</span>,<span class="st">"LWS"</span>,<span class="st">"LWN"</span>,<span class="st">"LWA"</span>,<span class="st">"LYG"</span>,
                 <span class="st">"LFG"</span>,<span class="st">"FWS"</span>,<span class="st">"AWS"</span>,<span class="st">"CWS"</span>,<span class="st">"IWC"</span><span class="op">)</span></code></pre></div>
<p>I can use the which() and %in% commands to locate those words that occur in the vector fig.4.12.aa. The %in% command is not a conventional R command and I do not expect you do know it. (I’m doin this simply to replicate what Pevsner has, not because its part of the algorithm)</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i.fig.4.12.aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">word.scores.sorted</span><span class="op">$</span><span class="va">words.as.string</span> <span class="op">%in%</span> <span class="va">fig.4.12.aa</span><span class="op">)</span></code></pre></div>
<p>This should reproduce the gist of the scores in the top part of Figure 4.12:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.scores.sorted</span><span class="op">[</span><span class="va">i.fig.4.12.aa</span>, <span class="op">]</span>
<span class="co">#&gt;      words.as.string scrL1 scrL2 scrL3 word.score</span>
<span class="co">#&gt; 2370             LWG     4    11     6         21</span>
<span class="co">#&gt; 2368             IWG     2    11     6         19</span>
<span class="co">#&gt; 2371             MWG     2    11     6         19</span>
<span class="co">#&gt; 2378             VWG     1    11     6         18</span>
<span class="co">#&gt; 2365             FWG     0    11     6         17</span>
<span class="co">#&gt; 2361             AWG    -1    11     6         16</span>
<span class="co">#&gt; 370              LWA     4    11     0         15</span>
<span class="co">#&gt; 4770             LWN     4    11     0         15</span>
<span class="co">#&gt; 6370             LWS     4    11     0         15</span>
<span class="co">#&gt; 2390             LYG     4     2     6         12</span>
<span class="co">#&gt; 2090             LFG     4     1     6         11</span>
<span class="co">#&gt; 6365             FWS     0    11     0         11</span>
<span class="co">#&gt; 768              IWC     2    11    -3         10</span>
<span class="co">#&gt; 6361             AWS    -1    11     0         10</span>
<span class="co">#&gt; 6362             CWS    -1    11     0         10</span></code></pre></div>
<p>Note that Pevsner only shows 15 words. There’s actually 72 with a score of 11 or more. For the typical BLAST search we’d expect about 50 high-scoring matches per word in the query.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">word.scores.above.t</span><span class="op">)</span>
<span class="co">#&gt; [1] 72  5</span></code></pre></div>
<p>Recall that this table represents just some high scoring words matched with just the 15th word of the sequence LWG. These words consitutte a <strong>neighborhood</strong> of closely related words. This process would have to be repeated for each word in the sequence!</p>
<p>If I wanted to, I could write set of <strong>nested for loops</strong> to loop over each word from the query and compare each word with a loop as above to the master word list. As for our focal word LWG, each iteration of this process would produce a matrix of high-scoring words. Since there are 147 amino acides in our HBB query sequence, there will be 145 words, and therefore 145 matrices containing each query words neighborhood of high-scoring words! I’d probably store this output in a <strong>list</strong>.</p>
</div>
<div id="comparing-the-query-sequence-of-hbb-to-the-database" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-the-query-sequence-of-hbb-to-the-database" class="anchor"></a>Comparing the query sequence of HBB to the database</h2>
<p>BLAST takes a query sequence and compares it against databases of sequences. You can select the database you want, or even particualr genomes. Regardless, BLAST takes words from the query sequence and compares them against many proteins and amino acids. Essentially, BLAST takes each word of interest from the query sequencs, gets a sequence from a database (eg, a single protein) and checks that sequene for the presence of the word. Then it repeats this for each word and each sequence.</p>
<p>I’ll simulate BLAST searching a single protein for a single word. In the code below Below is the sequence of protin, anillin, from Drosophila which were are intereted in for the neural defects lab. I am going to see if any of the “neighboring” words above the threshold T from one word from my query sequence HBB occurs in this gene which I know is unrelated to HBB.</p>
<p>The meta data for Anillin is: sp|Q9V4P1|ANLN_DROME Anillin OS=Drosophila melanogaster OX=7227 GN=scra PE=1 SV=3</p>
<p>The sequence is:</p>
<p>The most direct way to search this sequence from the NCBI database for the presence of words is to use a regular expression grepl(), which tells me if a search string occurs in the sequence or not. I can then cycle through each of the scores above t from HBB and check if they occur in anillin. This is not what BLAST does, though there are some underlying similarities between regular expressions and the computations BLAST actually does.</p>
<p>What I’m going to do is work through my list of word scores above t, in the object word.scores.above.t. (Recall that this matrix is for just a single original word from the query sequence; this whole process will need to be repeated about 150 times!) If a word from the matrix occuring in anillin, I record “hit” in a new column of the amtrix.</p>
<p>First, I need a place to but the “hit” where a word in HBB occurr in anillin. I’ll make a new column in my vector of top-scoring words:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word.scores.above.t</span><span class="op">$</span><span class="va">hit</span> <span class="op">&lt;-</span> <span class="cn">NA</span></code></pre></div>
<p>Now I am going to loop over each word in word.scores.above.t. I will have grepl() scan the full sequence of anillin for the presence of the word. If grepl90 finds a match it will store the value of TRUE. Otherwise if will return FALSE. If TRUE is returned, then I’ll store the word “TRUE” in my date matrix. If not, I’ll skip to the next word.</p>
<p>(As always, I don’t expect you to learn regular expressions in this class. If ever needed, I will write the code; I might ask you in general what is going on though or what I might use a regular expression for).</p>
<p>Again, this will loop over each word in word.scores.above.t and search for it in anillin using grepl. After I do the search with grepl(), I use an if() statement to screen if a hit occurred.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">word.scores.above.t</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># Run the regular express</span>
  <span class="va">word.i</span> <span class="op">&lt;-</span> <span class="va">word.scores.above.t</span><span class="op">$</span><span class="va">words.as.string</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  
  <span class="va">hit.output.TF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="va">word.i</span>, <span class="va">anillin</span><span class="op">)</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="va">hit.output.TF</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">word.scores.above.t</span><span class="op">$</span><span class="va">hit</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">hit.output.TF</span>
    
  <span class="op">}</span>

<span class="op">}</span></code></pre></div>
<p>The only “hit” I get is for “AWG”.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">word.scores.above.t</span><span class="op">)</span>
<span class="co">#&gt;      words.as.string scrL1 scrL2 scrL3 word.score  hit</span>
<span class="co">#&gt; 2370             LWG     4    11     6         21   NA</span>
<span class="co">#&gt; 2368             IWG     2    11     6         19   NA</span>
<span class="co">#&gt; 2371             MWG     2    11     6         19   NA</span>
<span class="co">#&gt; 2378             VWG     1    11     6         18   NA</span>
<span class="co">#&gt; 2365             FWG     0    11     6         17   NA</span>
<span class="co">#&gt; 2361             AWG    -1    11     6         16 TRUE</span></code></pre></div>
<p>What does this mean? This means that for the word “LWG” in the gene HBB, the similar word “AWG” occurs in anillin just one time. Moreover, no other words in the “neighborhood” of LWG occurs in Anillin.</p>
<p>Again, it should be noted, of course, that “LWG” is just one of dozens of words in HBB, so this process needs to be repeated many more times to see which other words in HBB - and their high scoring relatives - occur in anillin. Then this needs to be repated for other genes in the database.</p>
</div>
<div id="what-happens-with-a-hit" class="section level2">
<h2 class="hasAnchor">
<a href="#what-happens-with-a-hit" class="anchor"></a>What happens with a hit?</h2>
<p>BLAST firs search a database sequence for all hits to a query sequence. It then checks the distance between the hits. If two hits occur within 40 amino acids of each other BLAST then buils a un-gapped pairwise alignment between the query sequence and the database sequence in question. So, for our example above, we found one hit for AWG. If BLAST found another hit within 40 BP of AWG, it would then build a local alignment from that second hit.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="another-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#another-approach" class="anchor"></a>Another approach</h2>
<p>What I’ve just done requires actively scanning a sequence every time a BLAST search is done. Though I wasn’t sure at first, I believe this is what BLAST does.</p>
<p>The code below presents another way this problem could be approached by first creating a database of all the words in anillin.</p>
<p>The code below is un-annotated code. As an assignment, annotate by hand each line of the code with some note about what the code is doing. I will collect these at the beginning of class and then we will discuss the code, so you may want to photocopy your assignment or take a picture. I will likely call on people randomly to ask if they know what the code does. If a line of code spans more than 1 line, make a note on each and every line (see below for example). You will probably need to run all of the preceding code and investigate the inputs and output to figure out what it does</p>
<p>Ideally you’ll be able to figure out what the big picture of the R code is and how it does what was previously done with the regular expression grepl(), but its perfectly acceptable to make notes on basic things. I’ll discuss a few of the initial lines here.</p>
<p>For example, the first line of code is</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anillin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\n"</span>,<span class="st">""</span>, <span class="va">anillin</span><span class="op">)</span></code></pre></div>
<p>You could annotate this by writing “anillin is a character string with the anillin sequence” or “gsub is a regular expression” or “/n is the newline character”. This would all be full credit. Ideally - or at least eventually - you’ll be able to read this line of code and write something like “replace newline characters using regular expression”</p>
<p>The second line of code is</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anillin.split.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">anillin</span>,<span class="st">""</span><span class="op">)</span></code></pre></div>
<p>To figure this out you’ll probably have to run the code and compare the anillin object to the anillin.split.list object. look at it visually or using is(), then put a note in about what the change is, what strsplit() does, etc</p>
<p>The third line of code is</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anillin.split.vect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">anillin.split.list</span><span class="op">)</span></code></pre></div>
<p>TODO: this added while exploring code; remove?</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anillin.length.total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">anillin.split.vect</span><span class="op">)</span></code></pre></div>
<p>This is trickier. There are lists in R, and unlist() turns a list into a vector(). For a line like this</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anillin.length.total</span> <span class="op">&lt;-</span> <span class="va">anillin.length.total</span><span class="op">-</span><span class="fl">2</span></code></pre></div>
<p>Ideally you’ll know <em>why</em> I’m doing it (hint: word lengths = 3). However, if you don’t know biologically or computationally why a step is occurring, you can just write basically what’s happening (this is just a mathematical operation). For a line of code that spans multiple lines, annotate each line. For example:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anillin.word.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>,
                              nrow <span class="op">=</span> <span class="va">anillin.length.total</span>,
                              ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>make a note about “anillin.word.matrix &lt;- matrix(data = NA,” and another note about “nrow = anillin.length.total,” and a third note about “ncol = 3)”</p>
</div>
<div id="the-code" class="section level2">
<h2 class="hasAnchor">
<a href="#the-code" class="anchor"></a>The code</h2>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># remove \n from anillin</span>
<span class="va">anillin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\n"</span>,<span class="st">""</span>, <span class="va">anillin</span><span class="op">)</span> 

<span class="co"># split anillin character string up</span>
<span class="va">anillin.split.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">anillin</span>,<span class="st">""</span><span class="op">)</span>

<span class="co"># convert from list to vector</span>
<span class="co">## each amino acid is not in a separate slot of </span>
<span class="co">## the vector</span>
<span class="va">anillin.split.vect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">anillin.split.list</span><span class="op">)</span>

<span class="co"># total length of vector; number of amino acids</span>
<span class="va">anillin.length.total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">anillin.split.vect</span><span class="op">)</span>

<span class="co"># total number of words in sequence</span>
<span class="co">## which is 2 less than number of amino acids</span>
<span class="va">anillin.length.total</span> <span class="op">&lt;-</span> <span class="va">anillin.length.total</span><span class="op">-</span><span class="fl">2</span>


<span class="co"># matrix store the data</span>
<span class="co">## fill with NAs</span>
<span class="co">## make the number of rows = the lenghth of anillin seq</span>
<span class="co">## make number of columns = 3</span>
<span class="va">anillin.word.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>,  
                      nrow <span class="op">=</span> <span class="va">anillin.length.total</span>, 
                      ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>


<span class="co"># loop over each aa in anillin seq</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">anillin.length.total</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># grab letters from anillin is sets of 3s</span>
  <span class="va">word.i.vect</span> <span class="op">&lt;-</span> <span class="va">anillin.split.vect</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span>, <span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="co"># what does c(i, i+1, i+2) do?</span>
  
  <span class="co">#store each word in a row of the matrix</span>
  <span class="va">anillin.word.matrix</span><span class="op">[</span><span class="va">i</span> ,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">word.i.vect</span>
  
<span class="op">}</span>


<span class="co"># make a vector to store the words of anillin</span>
<span class="co">## (instead of being in columns they'll be in</span>
<span class="co">## actual 3-latter words, eg AAA)</span>
<span class="va">anillin.word.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">anillin.word.matrix</span><span class="op">)</span><span class="op">)</span>


<span class="co"># Loop over each possible word</span>
<span class="co">## paste into a single word</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">anillin.word.vector</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">anillin.word.vector</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">anillin.word.matrix</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="op">}</span>


<span class="co"># make a table of all the words to see</span>
<span class="co"># which ones are most common</span>
<span class="va">anillin.word.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">anillin.word.vector</span><span class="op">)</span>
 

<span class="co"># put words in order; most common word will be first</span>
<span class="va">i.anillin.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">anillin.word.table</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Look at the output of the tabulation</span>
<span class="va">anillin.word.table</span><span class="op">[</span><span class="va">i.anillin.order</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hisogram of talbe</span>
<span class="co">## one word occurs six times!</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">anillin.word.table</span><span class="op">)</span>

<span class="co"># similar output: a plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anillin.word.table</span><span class="op">[</span><span class="va">i.anillin.order</span><span class="op">]</span>,ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span>


<span class="co"># jus tlook at the first 175 amino acids</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anillin.word.table</span><span class="op">[</span><span class="va">i.anillin.order</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">175</span><span class="op">]</span><span class="op">]</span>,ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
</div>
<div id="compare-hbb-words-t-with-anillin-word-database" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-hbb-words-t-with-anillin-word-database" class="anchor"></a>Compare HBB words &gt; T with anillin word database</h2>
<p>Once I’ve worked up a set of words for anillin, I can use which() and %in% to see where the matches are.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use which() to compare the high-scoring words in </span>
<span class="co"># from the query sequence</span>
<span class="co"># against all the words that occur in anillin</span>
<span class="co"># store that in i.match</span>
<span class="va">i.match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">word.scores.above.t</span><span class="op">$</span><span class="va">words.as.string</span> <span class="op">%in%</span> <span class="va">anillin.word.vector</span><span class="op">)</span>

<span class="co"># look at the match</span>
<span class="va">word.scores.above.t</span><span class="op">[</span><span class="va">i.match</span>, <span class="op">]</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BLAST Summary • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BLAST Summary">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fff-nlb-BLAST_summary_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BLAST Summary</h1>
            
      
      
      <div class="hidden name"><code>fff-nlb-BLAST_summary.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<p>I have discovered that there are many minor but annoying inconsistencies in how the BLAST algorithm is described in text books. Additionally, most gloss over key computational steps, such as how BLAST actually searches through sequences. While this doesn’t have many - if any - consequences for a user of BLAST, it makes it very difficult to determine the computational steps involved and to appreciate exactly what is going on. The following notes are my attempt to summarize all the key features and computational steps of BLAST.</p>
<p>In a few cases I not provided every detail, which I usually note. I also occasionally use my own analogy or terminology which I think provides a useful description.</p>
<p>In the <em>dayoff</em> package I have written code that simulates some steps of the BLAST algorithm. This code is meant to emulate or evoke the process of BLAST and is NOT written as the actual program is. For example, as discussed below, BLAST’s actual searching of databases involves computational tool called a <strong>deterministic finite-state automata (DFSA)</strong> (Zvelebil &amp; Baum 2008). This is a rather complicated sub-program, buts it general behavior can be evoked using a simple regular expression or for() loop. (I’d like to write code for a DFSA but have yet to find R or Python examples).</p>
<div id="blast-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#blast-overview" class="anchor"></a>BLAST Overview</h2>
<div id="why-do-a-blast-search" class="section level3">
<h3 class="hasAnchor">
<a href="#why-do-a-blast-search" class="anchor"></a>Why do a BLAST search?</h3>
<p>BLASTing is a common activity by molecular biologists, bioinformaticians, computational biologists, and phylogenists. Some general reasons to do a BLAST</p>
<ul>
<li>Find conserved sequences (homologs)</li>
<li>Find conserved regions within a gene which may be important to protein function</li>
<li>Determine how similar a gene in a model species (mice, Drosophila) is to humans</li>
<li>Scan a new genome sequence for conserved genes</li>
<li>Ex: BLASTing sequence of newly discovered mouse gene (shroom) showed Hildebrand &amp; Soriano (1999) that this gene wasn’t just a mouse gene - it occurred in Humans AND mice</li>
<li>Subsequent BLASTing of shroom indicates that shroom occurs in almost all multicellular organisms!</li>
</ul>
</div>
<div id="what-does-blast-let-you-do" class="section level3">
<h3 class="hasAnchor">
<a href="#what-does-blast-let-you-do" class="anchor"></a>What does BLAST let you do?</h3>
<ul>
<li>find homologous genes</li>
<li>search DNA, protein, mRNA, whole genomes, etc</li>
<li>search specific curated databases with high-quality data (eg <strong>RefSeq</strong>, <strong>UniProt</strong>)</li>
<li>determine specific regions of homology via <strong>local alignment</strong>
</li>
<li>Search many many many sequences using efficient <strong>heuristic</strong> search technique</li>
<li>determine how likely your results are to have occurred by chance (E-value)</li>
</ul>
</div>
</div>
<div id="blast-recipe" class="section level2">
<h2 class="hasAnchor">
<a href="#blast-recipe" class="anchor"></a>BLAST recipe</h2>
<ul>
<li>Input 1: The query: a sequence of interest (eg mouse shroom)</li>
<li>Input 2: a database (eg, all known and predicted protein sequences, all reference protein sequences)</li>
<li>Input 3: a scoring matrix (BLOSUM62, PAM250)</li>
<li>Output 1: high-scoring local alignments between query and entries in the database</li>
<li>Output 2: quality scores for each alignment</li>
</ul>
<p>The BLAST results interface can also run other programs which can build <strong>multiple sequence alignments</strong>, <strong>create simple phylogenetic trees</strong>, link to relevant literature, etc.</p>
</div>
<div id="modules-in-the-blast-workflow-and-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#modules-in-the-blast-workflow-and-algorithm" class="anchor"></a>Modules in the BLAST Workflow and Algorithm</h2>
<p>The writers of BLAST divide it up into 3 modules (Camacho et al 2009). This is also how Pevsner frames it (page 138). The first two steps are by far the most important. The third appears to be mostly about doing book keeping and minor revisions, in part to clean up things that were done in step 1 to maximize speed and reduce memory usage.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Setup</strong>: Converting query sequence to <strong>words</strong>, scoring the words, determining words above neighbor hood threshold</li>
<li>
<strong>Scanning</strong>: Comparing query word list against database, create initial <strong>ungapped alignment</strong> and subsequent <strong>gapped alignment</strong> for <strong>high-scoring sequence pairs</strong>.</li>
<li>
<strong>Traceback</strong>: Produce, revise and report full <strong>gapped alignment</strong>
</li>
</ol>
<div id="module-1-setup-query-sequence-protein-blast-oriented" class="section level3">
<h3 class="hasAnchor">
<a href="#module-1-setup-query-sequence-protein-blast-oriented" class="anchor"></a>Module 1: Setup query sequence (Protein BLAST oriented)</h3>
<ul>
<li>Read <strong>query sequence</strong>
</li>
<li>Filter <strong>low complexity regions</strong> with little information (eg, AAAAAAAAAAA, ATATATATAT, etc)</li>
<li>Determine all overlapping <strong>words</strong> occurring in the query.</li>
<li>The default is for 3-letter amino acid words; users can modify this.</li>
<li>A word may occur more than once; each instance gets processed</li>
<li>Score query words against <strong>master word list</strong> with <strong>scoring matrix</strong> (<strong>PAM</strong> or <strong>BLOSUM</strong>)</li>
<li>The master word list for 3-letter words contains 20 x 20 x 20 = 8000 possible words!</li>
<li>Use a cutoff <strong>T</strong> (default = 11) to determine which words in master words list are in an desirable evolutionary <strong>neighborhood</strong> of the words in the query sequence.</li>
<li>
<strong>T</strong> is sometimes called the <strong>Neighborhood word score threshold</strong> (Mount 2007)</li>
<li>Typically for each word in a query sequence there are ~50 words with a score &gt;11</li>
<li>A 100 protein with amino acid will have 98 overlapping words. 98*50 = 4900. These the sequence database will then be scanned for each of the 4900 words!</li>
</ul>
<p>NOTE 1: <em>BLAST also does some special data organization and data structures to make this and downstream processing more efficient (for those with a CS background: this involves a look-up table/HASH table). The code I’ve used to demonstrate parts of the BLAST process are evocative of what goes on, but are not accurate in the data structures and workflow.</em></p>
<p>NOTE 2: <em>The term “master word list” isn’t used by anyone, but I think describes what this element is</em>.</p>
</div>
<div id="module-2-scanning-database-for-high-scoring-words" class="section level3">
<h3 class="hasAnchor">
<a href="#module-2-scanning-database-for-high-scoring-words" class="anchor"></a>Module 2: Scanning database for high-scoring words</h3>
<p>The scanning process in BLAST involves two important steps: find the 1st “hit” between a word from the query (or a neighboring word), then find a 2nd hit. The Baxevanis and Ouellette (2005) description does not indicate this.</p>
<p>The scanning process is done with a <strong>deterministic finite-state automata (DFSA)</strong> (aka a <strong>finite state machine (FSM)</strong>). The only textbook I’ve found which mentions this and discusses it is Zvelebil; and Baum (2008). A DFSA produces a similar result as a regular expression, though its probably much faster! Most peer review papers except the original BLAST paper (Alschul et al 1990) also don’t mention this.</p>
<p>Note: you don’t need to know what a DFSA or FSM are. You do need to know that BLST searches sequences for matching words.</p>
<div id="scanning-for-the-1st-hit" class="section level4">
<h4 class="hasAnchor">
<a href="#scanning-for-the-1st-hit" class="anchor"></a>Scanning for the 1st hit</h4>
<ul>
<li>Scan sequences in database for each word in the <strong>neighborhood</strong> of a word from the query</li>
<li>Scanning is done using a special computational tool called a <strong>deterministic finite-state automata</strong> (aka a <strong>finite state machine</strong>).</li>
<li>(<strong>Regular expressions</strong> can be converted to this format; BLAST does not, however, use regular expressions or simple loops to do this search!).</li>
<li>Each time a word from the neighborhood matches with a sequence in the database BLAST records its position as a <strong>hit</strong>.</li>
<li>Through the late 1990s, once scanning was done matched words served as the starting point for an ungapped alignment extending in both directions from the match (Some sources such as Baxevanis and Ouellette 2005 still describe BLAST this way);</li>
</ul>
</div>
<div id="scanning-for-the-2nd-hit" class="section level4">
<h4 class="hasAnchor">
<a href="#scanning-for-the-2nd-hit" class="anchor"></a>Scanning for the 2nd hit</h4>
<ul>
<li>Since the late 1990s, BLAST has used the <strong>two hit method</strong>
</li>
<li>Once scanning is done, BLAST locates pairs of hits that are within 40 amino acids of each other</li>
<li>If a hit is isolated with no other hits within 40 amino acids upstream or downstream, its is ignored</li>
<li>If 2 hits occur within 40 amino acids, BLAST builds and scores an un-gapped alignment starting at the second word; overlapping words aren’t considered)</li>
<li>(Some Sources imply that BLAST builds an alignment that runs between these two hits, eg Mount 2007. Pevsner phrasing is also not accurate: “BLAST extends hits to find alignments called …Hasps” (pg 140, 2nd paragraph). These are either misstatements or errors).</li>
</ul>
<p>Note: You don’t need to memorize this value of 40; you should be able to reason through what might happen if it is increased or decreased.</p>
</div>
<div id="scoring-initial-ungapped-alignment" class="section level4">
<h4 class="hasAnchor">
<a href="#scoring-initial-ungapped-alignment" class="anchor"></a>Scoring initial ungapped alignment</h4>
<p>Once BLAST finds a second hit, it starts building an <strong>ungapped alignment</strong>. If this alignment exceeds a certain threshold, a gapped alignment (see below). Baxevanis and Ouellette (2005) gloss over this two-step process.</p>
<ul>
<li>Starting from the 2nd hit of two adjacent hits, BLAST extends an un-gapped alignment in both directions.</li>
<li>BLAST monitors the score of this un-gapped alignment as it grows.</li>
<li>Scoring is done with a BLOSUM, PAM or other matrix</li>
<li>If this ungapped alignment exceeds a certain threshold (<strong>S</strong>), a <strong>gapped alignment</strong> is initiated.</li>
<li>The value of S is (was?) determined by subjecting <strong>random sequences</strong> to the word matching, scanning, and ungapped alignment procedures just described. S is set so that short alignments occurring due to chance are unlikely to be proceed in the algorithm. (Mount 2007)</li>
<li>If S is exceeded and a gapped alignment built, the resulting <strong>gapped alignment</strong> is called a <strong>High scoring sequence pair (HSP)</strong>
</li>
</ul>
</div>
<div id="scoring-gapped-alignment" class="section level4">
<h4 class="hasAnchor">
<a href="#scoring-gapped-alignment" class="anchor"></a>Scoring gapped alignment</h4>
<ul>
<li>As the alignment of a HSP extends, its score is monitored.<br>
</li>
<li>When an alignment has mostly identical or chemically similar matches, its score increases with its length.</li>
<li>Gaps and matches between dissimilar amino acids cause the alignment score to begin to drop</li>
<li>Small gaps and mis-matches might result in temporary declines in the alignment score, but the score may increase again after the gap or an area where sequences have diverged.</li>
<li>If the score drops more than a specified threshold (X.u; usually ~20) then the alignment is stopped</li>
<li>Once the threshold is exceed BLAST essentially backtracks to where the highest score occurred; this alignment is then stored as a preliminary HSP</li>
<li>(To save time and memory BLAST uses some shortcuts during the creation and reporting</li>
</ul>
<p>Note: You don’t need to memorize this value of 20; you should be able to reason through what might happen if it is increased or decreased.</p>
</div>
</div>
<div id="module-3-traceback" class="section level3">
<h3 class="hasAnchor">
<a href="#module-3-traceback" class="anchor"></a>Module 3: Traceback</h3>
<ul>
<li>During the traceback phase the alignment is finalized, minor improvements made, and reported</li>
<li>The traceback procedures appears to be required mostly to deal with simplifications the algorithm used to save time and memory. (For example, only the location and length of preliminary HSPs are stored during the scanning part of the alignment. The full alignment is then built and reported during traceback. I assume this means the full alignment is rebuilt, but I am not yet sure of all the steps)</li>
</ul>
</div>
</div>
<div id="blast-alignment-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#blast-alignment-statistics" class="anchor"></a>BLAST alignment statistics</h2>
<p>BLAST reports the following things</p>
<ul>
<li>The <strong>raw score</strong> from <strong>gapped alignment</strong> between the query and matching sequence</li>
<li>The proportion of the query sequence which was aligned</li>
<li>The <strong>percent identity</strong> of the alignment (this involves some rule for how gaps are counted; we won’t worry about this)</li>
<li>The <strong>E-value</strong>
</li>
<li>The <strong>Bit Score</strong> (where?)</li>
</ul>
<p>Note: BLAST reports both a Max Score and a Total Score, which are both <strong>raw scores</strong>. They are often identical, and we won’t worry about exactly what they are.</p>
<p>Tp0751 is a syphilis (Treponema pallidum) outer membrane protein thought to be involved in parthenogenesis. I googled “Tp0751 accession number” and it took me to the UniProt page. I found the FASTA-formatted sequence and pasted it into a blastp search. The default for blastp it so search the “nr” (non-redundant) database. I changed this to RefSeq because this database has higher standard for inclusion.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"&gt;sp|O83732|Y751_TREPA Uncharacterized protein TP_0751 OS=Treponema pallidum (strain Nichols) OX=243276 GN=TP_0751 PE=1 SV=1
MNRPLLSVAGSLFVAAWALYIFSCFQHGHVPPRRIPPHDTFGALPTAALPSNARDTAAHP
SDTADNTSGSSTTTDPRSHGNAPPAPVGGAAQTHTQPPVQTAMRIALWNRATHGEQGALQ
HLLAGLWIQTEISPNSGDIHPLLFFDREHAEITFSRASVQEIFLVDSAHTHRKTVSFLTR
NTAISSIRRRLEVTFESHEVIHVRAVEDVARLKIGSTSMWDGQYTRYHAGPASAPSP"</span></code></pre></div>
<p>BLAST returns 27 sequences when I query RefSeq. All occur in <em>Treponema</em> species. I also tried the default <strong>non-redundant (nr)</strong> database and got 38 hits, also all in <em>Treponema</em> species. The <strong>UniProt</strong> database returns just 1, my original sequence, because no other related proteins have been studied well enough to deserve entry to UniProt.</p>
<p>I also tried PSI-BLAST, which is a modified (and slower) BLAST which is better at finding more distantly related proteins. PSI-BLAST returned 81 sequences. Some of these are non-Treponema species, but they have E values &gt; 0.05.</p>
<p>The highest scoring <strong>hit</strong> from the RefSeq search is to the sequence I submitted: it as 100% coverage and 100% Identity. This means the alignments between what I submitted and this database sequence are identical.</p>
<p>The second hit is to another species, <em>T. paraluisicuniculi</em>. This has 100% query coverage, which means no gaps were introduced. I can confirm this by clicking on the “Alignments” tab and looking at the reported pairwise alignment. Gaps are indicated by dashes, and the top of the alignment has a gap percentage stat.</p>
<p>The percent identity (PID) for this hit is 98.73%. Looking at the actual alignment, I can see only a few “+” symbols which indicate conservative differences between the sequence, and one space, which indicates a non-conservative difference.</p>
<p>The <strong>E-value</strong> is tiny. Its reported at 6e-170, which is 6*10^-170. Below 0.05 E values and p-values are almost identical (Pevsner Table 4.3, page 144).</p>
<p>The lowest-scoring hit was from T. maltophilum. Only 55% of my query sequence matched with the T. maltophilum. sequence and the percent identity was 27.27%. Despite this low level of identity, the E value for this hit is still 5e-07, or 5*10^-7.</p>
<p>An E value of 5e-07 is going to be very similar to the related p-value, but let’s check. Pevsner provides a conversion equation (page 143, equation 4.8): p = 1-e^(-E)</p>
<p>You should memorize this equation (or include it on a note sheet if allowed) and be able to implement it in R as shown below.</p>
<p>In R I can code this as below. Note that instead of e^-E I have to use exp(-E)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">5e-07</span> 
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">E</span><span class="op">)</span>

<span class="va">p</span>
<span class="co">#&gt; [1] 4.999999e-07</span></code></pre></div>
<p>You can it this way too</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5e-07</span> <span class="op">)</span>
<span class="va">p</span></code></pre></div>
<p>Or skip the assignment step</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5e-07</span> <span class="op">)</span></code></pre></div>
<p>Or write it out long-form</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">7</span> <span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

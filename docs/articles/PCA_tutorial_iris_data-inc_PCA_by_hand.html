<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Another PCA tutorial with Fisher's Iris Data • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Another PCA tutorial with Fisher's Iris Data">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Another PCA tutorial with Fisher’s Iris Data</h1>
            
      
      
      <div class="hidden name"><code>PCA_tutorial_iris_data-inc_PCA_by_hand.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<div id="important-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#important-functions" class="anchor"></a>Important functions</h2>
<ul>
<li>2 functions in R for doing PCA
<ul>
<li>princomp()</li>
<li>prcomp()</li>
<li>difference = ?</li>
<li>princomp seems more flexible</li>
</ul>
</li>
</ul>
</div>
<div id="useful-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#useful-packages" class="anchor"></a>Useful packages</h2>
<ul>
<li>FactoMineR: has PCA plotting tools</li>
<li>ade4: has PCA plotting tools</li>
</ul>
</div>
<div id="data-fishers-irises" class="section level1">
<h1 class="hasAnchor">
<a href="#data-fishers-irises" class="anchor"></a>Data: Fisher’s Irises</h1>
<p>From R’s help file: &gt;“This famous (Fisher’s or Anderson’s) iris data set gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris. The species are Iris setosa, versicolor, and virginica.”</p>
<ul>
<li>3 species</li>
<li>150 observations</li>
<li>4 characteristics
<ul>
<li>“Sepal.Length”</li>
<li>“Sepal.Width”<br>
</li>
<li>“Petal.Length”</li>
<li>“Petal.Width”<br>
</li>
</ul>
</li>
<li>Characteristics highly correlated
<ul>
<li>plants/species with long sepals also have long petals</li>
<li>cf (allometric scaling)[<a href="https://en.wikipedia.org/wiki/Allometry" class="uri">https://en.wikipedia.org/wiki/Allometry</a>]</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="co">#&gt; [1] 150   5</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="co">#&gt; [1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"</span></code></pre></div>
</div>
<div id="data-visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#data-visualization" class="anchor"></a>Data visualization</h1>
<div id="d-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#d-visualization" class="anchor"></a>2D visualization</h2>
<ul>
<li>plot each of the 4 traits against each other</li>
<li>“-5” drops the last columns, which is species names</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>,lower.panel <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<ul>
<li>Most traits highly correlated
<ul>
<li>ie, Tell me the width of a petal, and I can guess the length pretty well</li>
</ul>
</li>
<li>Some traits not as well correlated
<ul>
<li>tell me sepal width, and I won’t be able to guess sepal lenght very well</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="d-visualziation" class="section level1">
<h1 class="hasAnchor">
<a href="#d-visualziation" class="anchor"></a>3D visualziation</h1>
<ul>
<li>We can visualization up to 3 dimensions at one time</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scatterplot3d</span><span class="op">)</span>

<span class="fu">scatterplot3d</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html">scatterplot3d</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>,   <span class="co"># x axis</span>
                 <span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span>,     <span class="co"># y axis</span>
                 <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>,    <span class="co"># z axis</span>
               <span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="beyond-3d-dimensions-with-ordination" class="section level1">
<h1 class="hasAnchor">
<a href="#beyond-3d-dimensions-with-ordination" class="anchor"></a>Beyond 3D dimensions with ordination</h1>
<ul>
<li>ordination is often called a “dimensions reduction” technique</li>
<li>Take “high dimensional data” and plot in 2D or 3D while preserving key features of the original data</li>
<li>This is done by representing multidimenaionsl distances as fewer dimensions</li>
</ul>
<p>Two steps</p>
<ul>
<li>First, run PCA</li>
<li>2nd, visualize w/“biplot”</li>
</ul>
<div id="run-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#run-pca" class="anchor"></a>Run PCA</h2>
<div id="pca-with-prcomp" class="section level3">
<h3 class="hasAnchor">
<a href="#pca-with-prcomp" class="anchor"></a>PCA with prcomp</h3>
<ul>
<li>note 1-sided formula
<ul>
<li>“~ Sepal.Length + …”</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prcomp.iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> 
         <span class="va">Sepal.Width</span> <span class="op">+</span> 
         <span class="va">Petal.Length</span> <span class="op">+</span> 
         <span class="va">Petal.Width</span>, 
         data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></code></pre></div>
</div>
<div id="pca-with-princomp" class="section level3">
<h3 class="hasAnchor">
<a href="#pca-with-princomp" class="anchor"></a>PCA with princomp</h3>
<ul>
<li>cor = TRUE: use correlation matrix instead of covariance matrix; relates to underlying math</li>
<li>scores = TRUE: keep underlying output</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">princomp.iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html">princomp</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> 
                        <span class="va">Sepal.Width</span> <span class="op">+</span> 
                        <span class="va">Petal.Length</span> <span class="op">+</span> 
                        <span class="va">Petal.Width</span>, 
                      data <span class="op">=</span> <span class="va">iris</span>,
                      cor <span class="op">=</span> <span class="cn">TRUE</span>,    
                      scores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="visualize-with-biplot" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-with-biplot" class="anchor"></a>Visualize with biplot</h2>
<ul>
<li>A biplot is a visualization of the PCA output</li>
<li>Data points plotted as numbers (row number)</li>
<li>X axis = “principal component 1” (PC1)</li>
<li>Y axis = “principal component 2” (PC2)</li>
<li>These can be thought of as “latent” variables that are implied by the data (?)</li>
<li>Red arrows:
<ul>
<li>Relationship between original traits and the new PC</li>
<li>Arrows that overlap are highly correlated</li>
</ul>
</li>
</ul>
<div id="prcomp-output" class="section level3">
<h3 class="hasAnchor">
<a href="#prcomp-output" class="anchor"></a>prcomp output</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">prcomp.iris</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="princomp-output" class="section level3">
<h3 class="hasAnchor">
<a href="#princomp-output" class="anchor"></a>princomp output</h3>
<p>Difference is minor; appears to mostly be due to scaling, not a different answer.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">princomp.iris</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div id="plotting-by-hand" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-by-hand" class="anchor"></a>Plotting by hand</h2>
<div id="extract-underlying-data-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-underlying-data-scores" class="anchor"></a>Extract underlying data (“scores”)</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scores.PC1</span> <span class="op">&lt;-</span> <span class="va">princomp.iris</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>,<span class="st">"Comp.1"</span><span class="op">]</span>
<span class="va">scores.PC2</span> <span class="op">&lt;-</span> <span class="va">princomp.iris</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>,<span class="st">"Comp.2"</span><span class="op">]</span></code></pre></div>
<p>Plotting by hand; note that axes aren’t standardized/scaled the same way as biplot(). To fix this just need to appropriate transformation</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">scores.PC1</span>,
     <span class="va">scores.PC2</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Add scores to raw data</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris2</span> <span class="op">&lt;-</span> <span class="va">iris</span>
<span class="va">iris2</span><span class="op">$</span><span class="va">scores.PC1</span> <span class="op">&lt;-</span> <span class="va">scores.PC1</span>
<span class="va">iris2</span><span class="op">$</span><span class="va">scores.PC2</span> <span class="op">&lt;-</span> <span class="va">scores.PC2</span></code></pre></div>
<p>Plot in ggplot with species color coded</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores.PC1</span>,
      y <span class="op">=</span> <span class="va">scores.PC2</span>,
      color <span class="op">=</span> <span class="va">Species</span>,
      data <span class="op">=</span> <span class="va">iris2</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>THe biplot indicates that Sepal.Width falls mostly along the y axis</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">princomp.iris</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>This implies that it is being represent by PC2 and highly correlated with it. We can plot the raw data for sepal with against PC2</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">scores.PC2</span>, 
      x <span class="op">=</span> <span class="va">Sepal.Width</span>, 
      data <span class="op">=</span> <span class="va">iris2</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The labels might be hard to read, but petal width and petal length are pointing to the right along the x axis. They are therefore correlated with PC1</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">scores.PC1</span><span class="op">~</span><span class="va">Petal.Length</span>, data <span class="op">=</span> <span class="va">iris2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">scores.PC1</span><span class="op">~</span><span class="va">Petal.Width</span>, data <span class="op">=</span> <span class="va">iris2</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
</div>
<div id="beyond-pc1-and-pc2" class="section level1">
<h1 class="hasAnchor">
<a href="#beyond-pc1-and-pc2" class="anchor"></a>Beyond PC1 and PC2</h1>
<p>PCA creates as many new/synthetic/latent PCs as there are variables. Typically the first 2 capture most of the interesting features of the data, but sometimes the additional ones are also useful. A screeplot can be used to determine when PCs are becoming less informative. when there is a steep declien between PCs, there is still information to be gained by looking at them. The following plot implies the PC3 might be useful to look at, but not PC4. There’s a stepp drop from 1 to 2, and 2 to 3, but not 3 to 4.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span><span class="op">(</span><span class="va">princomp.iris</span><span class="op">)</span>

<span class="co">#equivalent: </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">princomp.iris</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="summary-command" class="section level1">
<h1 class="hasAnchor">
<a href="#summary-command" class="anchor"></a>Summary command</h1>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#summary on prcomp</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">prcomp.iris</span><span class="op">)</span>
<span class="co">#&gt; Importance of components:</span>
<span class="co">#&gt;                           PC1     PC2    PC3     PC4</span>
<span class="co">#&gt; Standard deviation     2.0563 0.49262 0.2797 0.15439</span>
<span class="co">#&gt; Proportion of Variance 0.9246 0.05307 0.0171 0.00521</span>
<span class="co">#&gt; Cumulative Proportion  0.9246 0.97769 0.9948 1.00000</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">prcomp.iris</span>, loadings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#doesn't do anything</span>
<span class="co">#&gt; Warning: In summary.prcomp(prcomp.iris, loadings = TRUE) :</span>
<span class="co">#&gt;  extra argument 'loadings' will be disregarded</span>
<span class="co">#&gt; Importance of components:</span>
<span class="co">#&gt;                           PC1     PC2    PC3     PC4</span>
<span class="co">#&gt; Standard deviation     2.0563 0.49262 0.2797 0.15439</span>
<span class="co">#&gt; Proportion of Variance 0.9246 0.05307 0.0171 0.00521</span>
<span class="co">#&gt; Cumulative Proportion  0.9246 0.97769 0.9948 1.00000</span>

<span class="co">#summary on princomp, the more versitile command</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">princomp.iris</span><span class="op">)</span>
<span class="co">#&gt; Importance of components:</span>
<span class="co">#&gt;                           Comp.1    Comp.2     Comp.3      Comp.4</span>
<span class="co">#&gt; Standard deviation     1.7083611 0.9560494 0.38308860 0.143926497</span>
<span class="co">#&gt; Proportion of Variance 0.7296245 0.2285076 0.03668922 0.005178709</span>
<span class="co">#&gt; Cumulative Proportion  0.7296245 0.9581321 0.99482129 1.000000000</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">princomp.iris</span>,    <span class="co">#see ?summary.princomp for details</span>
        loadings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Importance of components:</span>
<span class="co">#&gt;                           Comp.1    Comp.2     Comp.3      Comp.4</span>
<span class="co">#&gt; Standard deviation     1.7083611 0.9560494 0.38308860 0.143926497</span>
<span class="co">#&gt; Proportion of Variance 0.7296245 0.2285076 0.03668922 0.005178709</span>
<span class="co">#&gt; Cumulative Proportion  0.7296245 0.9581321 0.99482129 1.000000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Loadings:</span>
<span class="co">#&gt;              Comp.1 Comp.2 Comp.3 Comp.4</span>
<span class="co">#&gt; Sepal.Length  0.521  0.377  0.720  0.261</span>
<span class="co">#&gt; Sepal.Width  -0.269  0.923 -0.244 -0.124</span>
<span class="co">#&gt; Petal.Length  0.580        -0.142 -0.801</span>
<span class="co">#&gt; Petal.Width   0.565        -0.634  0.524</span>


<span class="co">#summary with additional commands</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">princomp.iris</span>,         <span class="co">#see summary.princomp() for details</span>
        loadings <span class="op">=</span> <span class="cn">TRUE</span>, 
        cutoff <span class="op">=</span> <span class="fl">0.1</span>,
        digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Importance of components:</span>
<span class="co">#&gt;                           Comp.1    Comp.2     Comp.3      Comp.4</span>
<span class="co">#&gt; Standard deviation     1.7083611 0.9560494 0.38308860 0.143926497</span>
<span class="co">#&gt; Proportion of Variance 0.7296245 0.2285076 0.03668922 0.005178709</span>
<span class="co">#&gt; Cumulative Proportion  0.7296245 0.9581321 0.99482129 1.000000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Loadings:</span>
<span class="co">#&gt;              Comp.1 Comp.2 Comp.3 Comp.4</span>
<span class="co">#&gt; Sepal.Length  0.521  0.377  0.720  0.261</span>
<span class="co">#&gt; Sepal.Width  -0.269  0.923 -0.244 -0.124</span>
<span class="co">#&gt; Petal.Length  0.580        -0.142 -0.801</span>
<span class="co">#&gt; Petal.Width   0.565        -0.634  0.524</span></code></pre></div>
<p>structure of PCA output</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#structure of PCA output</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">prcomp.iris</span><span class="op">)</span>
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ sdev    : num [1:4] 2.056 0.493 0.28 0.154</span>
<span class="co">#&gt;  $ rotation: num [1:4, 1:4] 0.3614 -0.0845 0.8567 0.3583 -0.6566 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="co">#&gt;   .. ..$ : chr [1:4] "PC1" "PC2" "PC3" "PC4"</span>
<span class="co">#&gt;  $ center  : Named num [1:4] 5.84 3.06 3.76 1.2</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="co">#&gt;  $ scale   : logi FALSE</span>
<span class="co">#&gt;  $ x       : num [1:150, 1:4] -2.68 -2.71 -2.89 -2.75 -2.73 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:4] "PC1" "PC2" "PC3" "PC4"</span>
<span class="co">#&gt;  $ call    : language prcomp(formula = ~Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,      data = iris)</span>
<span class="co">#&gt;  - attr(*, "class")= chr "prcomp"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">princomp.iris</span><span class="op">)</span>
<span class="co">#&gt; List of 7</span>
<span class="co">#&gt;  $ sdev    : Named num [1:4] 1.708 0.956 0.383 0.144</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:4] "Comp.1" "Comp.2" "Comp.3" "Comp.4"</span>
<span class="co">#&gt;  $ loadings: 'loadings' num [1:4, 1:4] 0.521 -0.269 0.58 0.565 0.377 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="co">#&gt;   .. ..$ : chr [1:4] "Comp.1" "Comp.2" "Comp.3" "Comp.4"</span>
<span class="co">#&gt;  $ center  : Named num [1:4] 5.84 3.06 3.76 1.2</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="co">#&gt;  $ scale   : Named num [1:4] 0.825 0.434 1.759 0.76</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="co">#&gt;  $ n.obs   : int 150</span>
<span class="co">#&gt;  $ scores  : num [1:150, 1:4] -2.26 -2.08 -2.36 -2.3 -2.39 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:4] "Comp.1" "Comp.2" "Comp.3" "Comp.4"</span>
<span class="co">#&gt;  $ call    : language princomp(formula = ~Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,      data = iris, cor = TRUE, scores = TRUE)</span>
<span class="co">#&gt;  - attr(*, "class")= chr "princomp"</span></code></pre></div>
</div>
<div id="pca-by-hand" class="section level1">
<h1 class="hasAnchor">
<a href="#pca-by-hand" class="anchor"></a>PCA by hand</h1>
<ul>
<li>from pdf “Principal Component Analysis using R” by anon</li>
<li>dated November 25, 2009</li>
</ul>
<div id="set-up-data" class="section level2">
<h2 class="hasAnchor">
<a href="#set-up-data" class="anchor"></a>Set up data</h2>
<p>Create dataframe with just the numeric data (drop the )</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris.num.data</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
</div>
<div id="covariance-vs--correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#covariance-vs--correlation" class="anchor"></a>covariance vs. correlation</h2>
<div id="covariance-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#covariance-matrix" class="anchor"></a>covariance matrix</h3>
<p>covariances can take on any numeric value</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span>
<span class="co">#&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="co">#&gt; Sepal.Length    0.6856935  -0.0424340    1.2743154   0.5162707</span>
<span class="co">#&gt; Sepal.Width    -0.0424340   0.1899794   -0.3296564  -0.1216394</span>
<span class="co">#&gt; Petal.Length    1.2743154  -0.3296564    3.1162779   1.2956094</span>
<span class="co">#&gt; Petal.Width     0.5162707  -0.1216394    1.2956094   0.5810063</span></code></pre></div>
</div>
<div id="correlation-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#correlation-matrix" class="anchor"></a>correlation matrix</h3>
<p>correlations are all -1 to 1</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span>
<span class="co">#&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="co">#&gt; Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411</span>
<span class="co">#&gt; Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259</span>
<span class="co">#&gt; Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654</span>
<span class="co">#&gt; Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</span></code></pre></div>
<p>Correlation = covariance of re-scaled data, where “scaling” is mean-centered and standardized by SD</p>
<p>covariance matrix on scaled data == cor matrix called on raw data</p>
<p>confirm this; rounding needed to get correct answer, probably due to printing errors</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">==</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="co">#&gt; Sepal.Length         TRUE        TRUE         TRUE        TRUE</span>
<span class="co">#&gt; Sepal.Width          TRUE        TRUE         TRUE        TRUE</span>
<span class="co">#&gt; Petal.Length         TRUE        TRUE         TRUE        TRUE</span>
<span class="co">#&gt; Petal.Width          TRUE        TRUE         TRUE        TRUE</span></code></pre></div>
</div>
</div>
</div>
<div id="eigen-values" class="section level1">
<h1 class="hasAnchor">
<a href="#eigen-values" class="anchor"></a>eigen values</h1>
<ul>
<li>PCA is a type of “eigen decomposition”</li>
<li>eigen() command generates eigenvalues and eigenvectors</li>
<li>use $ operator on eigen results to get what you want</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># all eigen... results</span>
<span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; eigen() decomposition</span>
<span class="co">#&gt; $values</span>
<span class="co">#&gt; [1] 4.22824171 0.24267075 0.07820950 0.02383509</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vectors</span>
<span class="co">#&gt;             [,1]        [,2]        [,3]       [,4]</span>
<span class="co">#&gt; [1,]  0.36138659 -0.65658877 -0.58202985  0.3154872</span>
<span class="co">#&gt; [2,] -0.08452251 -0.73016143  0.59791083 -0.3197231</span>
<span class="co">#&gt; [3,]  0.85667061  0.17337266  0.07623608 -0.4798390</span>
<span class="co">#&gt; [4,]  0.35828920  0.07548102  0.54583143  0.7536574</span>

<span class="co">#eigen valeus only</span>
<span class="va">e.val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>

<span class="co">#eigen vectors only</span>
<span class="va">e.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span></code></pre></div>
<p>we could use covariances instead off correlations and get different results</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#</span>
<span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>
<span class="co">#&gt; [1] 2.91849782 0.91403047 0.14675688 0.02071484</span></code></pre></div>
<p>calling scale() within cov() should give us the same result</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>
<span class="co">#&gt; [1] 2.91849782 0.91403047 0.14675688 0.02071484</span></code></pre></div>
<p>Chekc this</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">==</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>,<span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE TRUE TRUE TRUE</span></code></pre></div>
</div>
<div id="calculation-of-the-the-principal-components" class="section level1">
<h1 class="hasAnchor">
<a href="#calculation-of-the-the-principal-components" class="anchor"></a>Calculation of the the Principal Components</h1>
<ul>
<li>this requires doing matrix multiplication
<ul>
<li>%*%</li>
</ul>
</li>
<li>of the data times the eigen vectors</li>
<li>NB: data must be in matrix form, not dataframe</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#doesn't work</span>
<span class="va">iris.num.data</span> <span class="op">%*%</span> <span class="va">e.vec</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># works</span>
<span class="va">PC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span>

<span class="co"># this spits out a value for every element in your</span>
<span class="co"># data matrix</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE TRUE</span>


<span class="co">#what this is doing is multipling the data by each</span>
<span class="co">#eigen vector successively</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span><span class="op">[</span> ,<span class="fl">1</span><span class="op">]</span>
,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span><span class="op">[</span> ,<span class="fl">2</span><span class="op">]</span>
,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span><span class="op">[</span> ,<span class="fl">3</span><span class="op">]</span>
,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span><span class="op">[</span> ,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>

<span class="va">x</span> <span class="op">==</span> <span class="va">PC</span>
<span class="co">#&gt;        [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt;   [1,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [2,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [3,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [4,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [5,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [6,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [7,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [8,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;   [9,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [10,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [11,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [12,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [13,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [14,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [15,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [16,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [17,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [18,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [19,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [20,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [21,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [22,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [23,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [24,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [25,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [26,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [27,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [28,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [29,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [30,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [31,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [32,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [33,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [34,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [35,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [36,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [37,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [38,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [39,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [40,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [41,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [42,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [43,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [44,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [45,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [46,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [47,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [48,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [49,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [50,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [51,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [52,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [53,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [54,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [55,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [56,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [57,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [58,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [59,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [60,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [61,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [62,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [63,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [64,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [65,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [66,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [67,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [68,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [69,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [70,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [71,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [72,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [73,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [74,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [75,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [76,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [77,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [78,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [79,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [80,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [81,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [82,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [83,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [84,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [85,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [86,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [87,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [88,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [89,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [90,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [91,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [92,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [93,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [94,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [95,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [96,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [97,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [98,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt;  [99,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [100,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [101,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [102,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [103,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [104,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [105,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [106,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [107,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [108,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [109,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [110,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [111,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [112,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [113,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [114,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [115,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [116,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [117,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [118,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [119,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [120,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [121,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [122,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [123,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [124,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [125,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [126,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [127,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [128,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [129,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [130,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [131,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [132,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [133,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [134,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [135,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [136,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [137,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [138,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [139,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [140,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [141,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [142,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [143,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [144,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [145,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [146,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [147,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [148,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [149,] TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; [150,] TRUE TRUE TRUE TRUE</span>



<span class="co">#</span>

<span class="co">#scaled data %*% eigen-things = "PC" object</span>
<span class="co">#the eigen-vectorss are the "loadings" that </span>
<span class="co">#transform the raw data into principal component scores</span>





<span class="co"># for matrix multiplication to work the number</span>
<span class="co"># of columns of m1 must be equal to the number</span>
<span class="co"># of rows of m2 in</span>
<span class="co"># m1 %*% m2</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">e.vec</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>


<span class="co">#The number of ROWS of m1 determines the number of rows</span>
<span class="co"># in the resulting product of the matrix mult</span>
<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span>
<span class="co">#&gt;      [,1]     [,2]       [,3]        [,4]</span>
<span class="co">#&gt; 1 2.81824 -5.64635 -0.6597675 -0.03108928</span>

<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span>
<span class="co">#&gt;       [,1]      [,2]       [,3]        [,4]</span>
<span class="co">#&gt; 1 2.818240 -5.646350 -0.6597675 -0.03108928</span>
<span class="co">#&gt; 2 2.788223 -5.149951 -0.8423170  0.06567484</span>


<span class="co"># the number of rows of m1 we use doesn't affect the calculation</span>
<span class="va">row.1st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span>
<span class="va">row.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">[</span> ,<span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span>
<span class="va">row.1st</span> <span class="op">==</span> <span class="va">row.all</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>
<span class="co">#&gt;   [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; 1 TRUE TRUE TRUE TRUE</span>

<span class="co">#This is because matrix mult involves carrying</span>
<span class="co">#out multiplication and addition functions</span>
<span class="co">#on a row by row basis in m1</span>
<span class="co">#(and a columns by column basis in m3)</span>

<span class="co">#1st row of m1 by entire 1st column of m2</span>
<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span>
<span class="co">#&gt;      [,1]     [,2]       [,3]        [,4]</span>
<span class="co">#&gt; 1 2.81824 -5.64635 -0.6597675 -0.03108928</span>

<span class="co">#if we multiple the first row of our m1</span>
<span class="co">#by just the 1st column of the our m2</span>
<span class="co">#we get the FIRST element of our entire </span>
<span class="co">#"PC" object</span>
<span class="va">ele.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">e.vec</span><span class="op">[</span> ,<span class="fl">1</span><span class="op">]</span>

<span class="va">ele.1</span> <span class="op">==</span> <span class="va">PC</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt;   [,1]</span>
<span class="co">#&gt; 1 TRUE</span>



<span class="co"># we could write a little program to do the addition and</span>
<span class="co"># multiplication that the magic %*% operator does if</span>
<span class="co"># we wanted</span>

<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="co">#turn data into a matrix</span>
<span class="va">n.rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="va">n.cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="va">e.vec</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="co"># make a blank matrix to hold results</span>
<span class="va">m.out</span> <span class="op">&lt;-</span> <span class="va">m1</span>
<span class="va">m.out</span><span class="op">[</span> , <span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="va">i</span> <span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">j</span> <span class="op">&lt;-</span><span class="fl">1</span>
<span class="co">#loop over rows i and columns j</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n.rows</span><span class="op">)</span>
<span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n.cols</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">m.out</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">m1</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">*</span><span class="va">m2</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>


<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span>
<span class="co">#&gt; [1] 150   4</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span>
<span class="co">#&gt; [1] 150   4</span>

<span class="co"># all.equal doesn't seem to be happy for some reason...</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">m.out</span>, <span class="va">PC</span><span class="op">)</span>
<span class="co">#&gt; [1] "Attributes: &lt; Length mismatch: comparison on first 1 components &gt;"</span>

<span class="co"># look for any mismatches by hand</span>
<span class="va">comp.ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">m.out</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PC</span>,<span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">comp.ms</span> <span class="op">==</span> <span class="st">"FALSE"</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">######################################</span>
<span class="co">###</span>
<span class="co">### results of matrix mult for PCA ###</span>
<span class="co">###</span>
<span class="co">######################################</span>

<span class="co"># a property of this new data matrix is</span>
<span class="co"># that the VARIANCES of PC equal the eigen values</span>
<span class="co"># (not the eigen vectors)</span>
<span class="co"># and the covarainces should be (approximately) zero</span>

<span class="co">#recall that in a var-covar matrix that</span>
<span class="co">#the variances are on the diagonal</span>
<span class="co"># the the covars are everything else</span>

<span class="co"># the eigen values</span>
<span class="va">e.val</span>
<span class="co">#&gt; [1] 4.22824171 0.24267075 0.07820950 0.02383509</span>

<span class="co">#covariance matrix of object PC from our matrix multiplicatio</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span>
<span class="co">#&gt;               [,1]         [,2]          [,3]          [,4]</span>
<span class="co">#&gt; [1,]  4.228242e+00 7.676599e-16 -2.363754e-16 -9.339419e-19</span>
<span class="co">#&gt; [2,]  7.676599e-16 2.426707e-01  8.393740e-17  2.254831e-16</span>
<span class="co">#&gt; [3,] -2.363754e-16 8.393740e-17  7.820950e-02  2.418740e-17</span>
<span class="co">#&gt; [4,] -9.339419e-19 2.254831e-16  2.418740e-17  2.383509e-02</span>

<span class="co">#to view just the variances we can use diag()</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 4.22824171 0.24267075 0.07820950 0.02383509</span>

<span class="co">#check this</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">e.val</span>,<span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE TRUE TRUE TRUE</span>

<span class="co">#its a pain to write out round()</span>
<span class="co">#the function all.equal() checks for </span>
<span class="co">#near equalness of all of the elements</span>

<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span><span class="op">)</span>, <span class="va">e.val</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="co"># what happens if we call cor() on PC?</span>
<span class="co"># variances (on the diagonal) are all 1</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span>
<span class="co">#&gt;               [,1]         [,2]          [,3]          [,4]</span>
<span class="co">#&gt; [1,]  1.000000e+00 7.578447e-16 -4.110480e-16 -2.941925e-18</span>
<span class="co">#&gt; [2,]  7.578447e-16 1.000000e+00  6.092801e-16  2.964809e-15</span>
<span class="co">#&gt; [3,] -4.110480e-16 6.092801e-16  1.000000e+00  5.602101e-16</span>
<span class="co">#&gt; [4,] -2.941925e-18 2.964809e-15  5.602101e-16  1.000000e+00</span>



<span class="co">### what do these data look like? </span>

<span class="co"># the original pairwise plots</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#suppress upper panle</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris.num.data</span>, upper.panel <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-2.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co">## FANCY: put histograms on the diagonal</span>
<span class="va">panel.hist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">usr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">usr</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>usr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">usr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">)</span>
  <span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="va">breaks</span> <span class="op">&lt;-</span> <span class="va">h</span><span class="op">$</span><span class="va">breaks</span>; <span class="va">nB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">h</span><span class="op">$</span><span class="va">counts</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">[</span><span class="op">-</span><span class="va">nB</span><span class="op">]</span>, <span class="fl">0</span>, <span class="va">breaks</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="st">"cyan"</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris.num.data</span>, 
      panel <span class="op">=</span> <span class="va">panel.smooth</span>,
      cex <span class="op">=</span> <span class="fl">1.5</span>, pch <span class="op">=</span> <span class="fl">24</span>, bg <span class="op">=</span> <span class="st">"light blue"</span>,
      diag.panel <span class="op">=</span> <span class="va">panel.hist</span>, 
      cex.labels <span class="op">=</span> <span class="fl">2</span>, font.labels <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-3.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co">## put (absolute) correlations on the upper panels,</span>
<span class="co">## with size proportional to the correlations.</span>
<span class="va">panel.cor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">prefix</span> <span class="op">=</span> <span class="st">""</span>, <span class="va">cex.cor</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">usr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">usr</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>usr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>
  <span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">r</span>, <span class="fl">0.123456789</span><span class="op">)</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">prefix</span>, <span class="va">txt</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">cex.cor</span><span class="op">)</span><span class="op">)</span> <span class="va">cex.cor</span> <span class="op">&lt;-</span> <span class="fl">0.8</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/graphics/strwidth.html">strwidth</a></span><span class="op">(</span><span class="va">txt</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="va">txt</span>, cex <span class="op">=</span> <span class="va">cex.cor</span> <span class="op">*</span> <span class="va">r</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris.num.data</span>, lower.panel <span class="op">=</span> <span class="va">panel.smooth</span>, upper.panel <span class="op">=</span> <span class="va">panel.cor</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-4.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="co">#pairwise comparisons of the PC object</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-5.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">PC</span>, upper.panel <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-6.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">PC</span>, lower.panel <span class="op">=</span> <span class="va">panel.smooth</span>, upper.panel <span class="op">=</span> <span class="va">panel.cor</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-7.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R">



<span class="co">### for more summary and distributional information than you could </span>
<span class="co">#   ever ask for:</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span>
<span class="co">#&gt;   method from   </span>
<span class="co">#&gt;   +.gg   ggplot2</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">iris</span>, colour<span class="op">=</span><span class="st">'Species'</span>, alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>
<span class="co">#&gt; Warning in warn_if_args_exist(list(...)): Extra arguments: 'colour', 'alpha'</span>
<span class="co">#&gt; are being ignored. If these are meant to be aesthetics, submit them using the</span>
<span class="co">#&gt; 'mapping' variable within ggpairs with ggplot2::aes or ggplot2::aes_string.</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-8.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R">




<span class="co">### ###</span>

<span class="va">dat.scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">PC</span>
<span class="co">#&gt;                  [,1]       [,2]      [,3]       [,4]</span>
<span class="co">#&gt; Sepal.Length 5050.499 -4692.8148 -560.6014 -28.112346</span>
<span class="co">#&gt; Sepal.Width  2470.135 -2469.3416 -282.8001 -16.430569</span>
<span class="co">#&gt; Petal.Length 3641.393 -2996.5344 -355.2870 -20.504475</span>
<span class="co">#&gt; Petal.Width  1215.601  -955.5895 -107.3096  -3.323412</span>

<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">dat.scale</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">PC</span>
<span class="co">#&gt;                   [,1]       [,2]       [,3]       [,4]</span>
<span class="co">#&gt; Sepal.Length  274.9496 -28.670293 -8.1907943  1.3530687</span>
<span class="co">#&gt; Sepal.Width  -122.1702 -60.571637 15.9855992 -2.6050968</span>
<span class="co">#&gt; Petal.Length  305.7327   3.551127  0.5032551 -0.9653406</span>
<span class="co">#&gt; Petal.Width   296.1348   3.580561  8.3447612  3.5114517</span>

<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">PC</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">dat.scale</span>
<span class="co">#&gt;      Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="co">#&gt; [1,]   274.949598 -122.170177  305.7326729  296.134755</span>
<span class="co">#&gt; [2,]   -28.670293  -60.571637    3.5511272    3.580561</span>
<span class="co">#&gt; [3,]    -8.190794   15.985599    0.5032551    8.344761</span>
<span class="co">#&gt; [4,]     1.353069   -2.605097   -0.9653406    3.511452</span>

<span class="va">e.vec</span>
<span class="co">#&gt;             [,1]        [,2]        [,3]       [,4]</span>
<span class="co">#&gt; [1,]  0.36138659 -0.65658877 -0.58202985  0.3154872</span>
<span class="co">#&gt; [2,] -0.08452251 -0.73016143  0.59791083 -0.3197231</span>
<span class="co">#&gt; [3,]  0.85667061  0.17337266  0.07623608 -0.4798390</span>
<span class="co">#&gt; [4,]  0.35828920  0.07548102  0.54583143  0.7536574</span>



<span class="co">### Proportion of Variance explained </span>
<span class="co">### by the different components ###</span>

<span class="co">#proportion explained as a percent</span>
<span class="va">e.val</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>
<span class="co">#&gt; [1] 92.4618723  5.3066483  1.7102610  0.5212184</span>

<span class="co">#should add to 100%</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>
<span class="co">#&gt; [1] 100</span>

<span class="co">#can see how quickly variance is eaten up by each</span>
<span class="co">#successive component by calculating cumulative sum</span>

<span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>
<span class="co">#&gt; [1]  92.46187  97.76852  99.47878 100.00000</span>

<span class="co"># plot cumulative variance explained against</span>
<span class="co"># number of components</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">~</span>
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">e.val</span><span class="op">)</span><span class="op">)</span>,
     ylab <span class="op">=</span> <span class="st">"cumulative variance explained against"</span><span class="op">)</span></code></pre></div>
<p><img src="PCA_tutorial_iris_data-inc_PCA_by_hand_files/figure-html/unnamed-chunk-29-9.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="co"># So how does all this eigen-craziness compare to what</span>
<span class="co"># prcomp acutally does</span>

<span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span>
<span class="co">#&gt; Standard deviations (1, .., p=4):</span>
<span class="co">#&gt; [1] 2.0562689 0.4926162 0.2796596 0.1543862</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rotation (n x k) = (4 x 4):</span>
<span class="co">#&gt;                      PC1         PC2         PC3        PC4</span>
<span class="co">#&gt; Sepal.Length  0.36138659 -0.65658877  0.58202985  0.3154872</span>
<span class="co">#&gt; Sepal.Width  -0.08452251 -0.73016143 -0.59791083 -0.3197231</span>
<span class="co">#&gt; Petal.Length  0.85667061  0.17337266 -0.07623608 -0.4798390</span>
<span class="co">#&gt; Petal.Width   0.35828920  0.07548102 -0.54583143  0.7536574</span>


<span class="co">#the standard deviations can be converted to the variances</span>
<span class="co">#we computed above</span>
<span class="co">#The "rotations" are the same as the eigenvectors</span>
<span class="co">#we computed above</span>

<span class="co">#the standard deviations that prcomp() gives</span>
<span class="co">#can be converted to variances</span>
<span class="co">#which are equal to the EIGENVALUES</span>

<span class="co">#extract sdeviations</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">$</span><span class="va">sdev</span>
<span class="co">#&gt; [1] 2.0562689 0.4926162 0.2796596 0.1543862</span>

<span class="co">#convert them to variances</span>
<span class="va">prc.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">iris.num.data</span><span class="op">)</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span>

<span class="co">#compar to the eigenvalues we calculated with </span>
<span class="co">#eigen() above</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">e.val</span>, <span class="va">prc.vars</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>


<span class="co">#so, the sd^2 from prcomp() can also give</span>
<span class="co">#use the proportion of expalined variance</span>

<span class="va">prc.vars</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prc.vars</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.924618723 0.053066483 0.017102610 0.005212184</span>
<span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">prc.vars</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prc.vars</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9246187 0.9776852 0.9947878 1.0000000</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worked example: Data visualization in R • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Worked example: Data visualization in R">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Worked example: Data visualization in R</h1>
            
      
      
      <div class="hidden name"><code>aminio-acids-worked_example_data_visualization-DeprecatedQ.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<p>In this chapter we’ll test out some of R’s <strong>data visualization</strong> capabilities by exploring the chemical properties of amino acids. The chemical properties of amino acids are very important for understanding sequence evolution because mutations are more likely to replace an amino acid with a chemically similar one than with one that is very different. For example, a mutation is more likely to change one hydrophillic amino acid for another than to change a hydrophillic amino acid to a hydrophobic one. This is because the precise secondary and tertiary structure - and thus the function – of a protein depends on the chemical properties of all of its amino acids.</p>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="packages" class="section level3">
<h3 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h3>
<p>First, load general packages for plotting. There are many ways to plot data in R, but the most popular and powerful these days is ggplot2. We’ll be using an extension of ggplot2 called ggpubr.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p>Load data with the data() command</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">aa_chars_subset</span><span class="op">)</span></code></pre></div>
<p>This name is long, so let’s use the <strong>assignment operator &lt;-</strong> to give it a shorter name, just “aa”. Run the code to do this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa</span>  <span class="op">&lt;-</span>  <span class="va">aa_chars_subset</span></code></pre></div>
</div>
</div>
<div id="data-exploration-getting-to-know-data" class="section level2">
<h2 class="hasAnchor">
<a href="#data-exploration-getting-to-know-data" class="anchor"></a>Data exploration: Getting to know data</h2>
<p>Our data in this particular case is a <strong>data.frame</strong>, which is kind of like a <strong>spreadsheet</strong> in R-land. We can confirm this using the is() command. In the code chunk below type is(aa) and run the chunk. Four or so things will show up in the console. When you do this usually the first one is the most relevant one.</p>
<p>Spreadsheets are grids of data, but we can’t see yet what we’re looking at. This is a major obstacle in moving from working with a visual tool like Excel to R. We can use R commands to start to get an idea of what we are working with.</p>
<p>First question: How big is this grid? The dim() command tells us how large things like dataframes and matrices are in R. Type dim(aa) in the code chunk below. The first number will be the number of rows, the second will be the number of columns.</p>
<p>Ok, so we are getting a sense for this dataframe thingy, but its still a bit abstract. If we want to see the whole thing like it was a spreadsheet we can use View(). Type View(aa) in the chunk below. Note that its “V” uppercase, not lower case. This is kind of annoying, but R is case sensitive.</p>
<p>What happens when you run View() on aa?</p>
<p>Often we’d like to see the dataframe, or at least part of it, in the R console or in our R <strong>notebook</strong>. We can see part of the dataframe with head(aa). Type this in the chunk below and run it. R might print things out in a weird way depending on how wide your screen is. You can adjust the width of the <strong>RStudio pane</strong> you working in or zoom out and re-run the command to see if it helps.</p>
<p>We can also use tail() to see the bottom of the dataframe. Type tail(aa) in the chunk below.</p>
<p>If we want to see the whole dataframe we can just type aa in a chunk and run it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa</span>
<span class="co">#&gt;    letter MW.da volume bulkiness polarity isoelectric.pt hydrophobe.34</span>
<span class="co">#&gt; 1       A    89     67     11.50     0.00           6.00           1.8</span>
<span class="co">#&gt; 2       C   121     86     13.46     1.48           5.07           2.5</span>
<span class="co">#&gt; 3       D   133     91     11.68    49.70           2.77          -3.5</span>
<span class="co">#&gt; 4       E   146    109     13.57    49.90           3.22          -3.5</span>
<span class="co">#&gt; 5       F   165    135     19.80     0.35           5.48           2.8</span>
<span class="co">#&gt; 6       G    75     48      3.40     0.00           5.97          -0.4</span>
<span class="co">#&gt; 7       H   155    118     13.69    51.60           7.59          -3.2</span>
<span class="co">#&gt; 8       I   131    124     21.40     0.13           6.02           4.5</span>
<span class="co">#&gt; 9       K   146    135     15.71    49.50           9.74          -3.9</span>
<span class="co">#&gt; 10      L   131    124     21.40     0.13           5.98           3.8</span>
<span class="co">#&gt; 11      M   149    124     16.25     1.43           5.74           1.9</span>
<span class="co">#&gt; 12      N   132     96     12.28     3.38           5.41          -3.5</span>
<span class="co">#&gt; 13      P   115     90     17.43     1.58           6.30          -1.6</span>
<span class="co">#&gt; 14      Q   147    114     14.45     3.53           5.65          -3.5</span>
<span class="co">#&gt; 15      R   174    148     14.28    52.00          10.76          -4.5</span>
<span class="co">#&gt; 16      S   105     73      9.47     1.67           5.68          -0.8</span>
<span class="co">#&gt; 17      T   119     93     15.77     1.66           6.16          -0.7</span>
<span class="co">#&gt; 18      V   117    105     21.57     0.13           5.96           4.2</span>
<span class="co">#&gt; 19      W   204    163     21.67     2.10           5.89          -0.9</span>
<span class="co">#&gt; 20      Y   181    141     18.03     1.61           5.66          -1.3</span>
<span class="co">#&gt;    hydrophobe.35 saaH2O faal.fold polar.req  freq charge  hydropathy volume.cat</span>
<span class="co">#&gt; 1            1.6    113      0.74       7.0  7.80     un hydrophobic  verysmall</span>
<span class="co">#&gt; 2            2.0    140      0.91       4.8  1.10     un hydrophobic      small</span>
<span class="co">#&gt; 3           -9.2    151      0.62      13.0  5.19    neg hydrophilic      small</span>
<span class="co">#&gt; 4           -8.2    183      0.62      12.5  6.72    neg hydrophilic     medium</span>
<span class="co">#&gt; 5            3.7    218      0.88       5.0  4.39     un hydrophobic  verylarge</span>
<span class="co">#&gt; 6            1.0     85      0.72       7.9  6.77     un     neutral  verysmall</span>
<span class="co">#&gt; 7           -3.0    194      0.78       8.4  2.03    pos     neutral     medium</span>
<span class="co">#&gt; 8            3.1    182      0.88       4.9  6.95     un hydrophobic      large</span>
<span class="co">#&gt; 9           -8.8    211      0.52      10.1  6.32    pos hydrophilic      large</span>
<span class="co">#&gt; 10           2.8    180      0.85       4.9 10.15     un hydrophobic      large</span>
<span class="co">#&gt; 11           3.4    204      0.85       5.3  2.28     un hydrophobic      large</span>
<span class="co">#&gt; 12          -4.8    158      0.63      10.0  4.37     un hydrophilic      small</span>
<span class="co">#&gt; 13          -0.2    143      0.64       6.6  4.26     un     neutral      small</span>
<span class="co">#&gt; 14          -4.1    189      0.62       8.6  3.45     un hydrophilic     medium</span>
<span class="co">#&gt; 15         -12.3    241      0.64       9.1  5.23    pos hydrophilic      large</span>
<span class="co">#&gt; 16           0.6    122      0.66       7.5  6.46     un     neutral  verysmall</span>
<span class="co">#&gt; 17           1.2    146      0.70       6.6  5.12     un     neutral      small</span>
<span class="co">#&gt; 18           2.6    160      0.86       5.6  7.01     un hydrophobic     medium</span>
<span class="co">#&gt; 19           1.9    259      0.85       5.2  1.09     un hydrophobic  verylarge</span>
<span class="co">#&gt; 20          -0.7    229      0.76       5.4  3.30     un     neutral  verylarge</span>
<span class="co">#&gt;    polarity.cat</span>
<span class="co">#&gt; 1      nonpolar</span>
<span class="co">#&gt; 2      nonpolar</span>
<span class="co">#&gt; 3         polar</span>
<span class="co">#&gt; 4         polar</span>
<span class="co">#&gt; 5      nonpolar</span>
<span class="co">#&gt; 6      nonpolar</span>
<span class="co">#&gt; 7         polar</span>
<span class="co">#&gt; 8      nonpolar</span>
<span class="co">#&gt; 9         polar</span>
<span class="co">#&gt; 10     nonpolar</span>
<span class="co">#&gt; 11     nonpolar</span>
<span class="co">#&gt; 12        polar</span>
<span class="co">#&gt; 13     nonpolar</span>
<span class="co">#&gt; 14        polar</span>
<span class="co">#&gt; 15        polar</span>
<span class="co">#&gt; 16        polar</span>
<span class="co">#&gt; 17        polar</span>
<span class="co">#&gt; 18     nonpolar</span>
<span class="co">#&gt; 19     nonpolar</span>
<span class="co">#&gt; 20        polar</span></code></pre></div>
<p>Sometimes we may want to just see the names of all the columns. This is done with names(aa). Type this code and run it below</p>
</div>
<div id="numeric-summaries-data" class="section level2">
<h2 class="hasAnchor">
<a href="#numeric-summaries-data" class="anchor"></a>Numeric summaries data</h2>
<p>We can get numeric summaries of data using the summary() command. Type summary(aa) in the chunk below and run it.</p>
<p>Data can take many forms. If data are <strong>numeric</strong> then you can calculate means, medians, minimums, and maximums (we’ll ignore “1st Qu” and “3rd Qu” for now). If data are <strong>categorical</strong> you can count up how many rows of data are in each category.</p>
<p>It can be useful to get a summary of just one column. You can do this by selecting the column with a dollar sign like this: summary(aa$volume) . Type this in the chunk below and run it (don’t type the period)</p>
<p>There are times when we might just want one type of numeric summary, like the mean, for a column. In that case we can do this: mean(aa$volume). Type that below.</p>
<p>In the assignment associated with this exercise you will be asked to provide the mean for a column. Run the appropriate code in the chunk below and enter the answer on TopHat. (Note that the exercise might not be activated until after class).</p>
<p>In the assignment associated with this exercise you will be asked to provide the max for a column. This is done with the max() command. Run the appropriate code in the chunk below and enter the answer on TopHat.</p>
<p>For <strong>categorical variables</strong> data are described by discrete words and fall into groups. For example, the “hydropathy” column describes each amino acid as hydrophobic, phydrophilic, or neutral. We can see how many amino acids are in each group using summary(aa$hydropathy). Run this code in the chunk below.</p>
<p>It doesn’t make sense to take the mean, max, etc of categorical data. If you try, R will <strong>throw and error</strong>, though often what it says is pretty cryptic.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">aa</span><span class="op">$</span><span class="va">letter</span><span class="op">)</span>
<span class="co">#&gt; Warning in mean.default(aa$letter): argument is not numeric or logical:</span>
<span class="co">#&gt; returning NA</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>When we have two categorical variables, like charge and hydropathy, we may want to know how the data fall out into both categories at the same time. For example, we have a hydropathy column and a polarity.cat column. How many amino acids are hydrophilic AND polar?</p>
<p>We can do this by typing table(aa<span class="math inline">\(hydropathy,aa\)</span>polarity.cat). Remember, though, that we can let RStudio look up the variables names. Practice this by typing table(aa$ and then waiting a second. You can then select from the list of variable names. Add the comma, then type aa$ again and select from the list again. Finish with the right parentheses.</p>
</div>
<div id="plotting-data" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-data" class="anchor"></a>Plotting data</h2>
<p>Numeric summaries from summary(), mean(), and table() are useful, but pictures are usually most helpful. We’re going to use a plotting package called <strong>ggpubr</strong>, which extends the famous <strong>ggplot2</strong> package by Hadley Wickham. Make sure that you have run the code library(ggpubr) to get ggpubr R into memory..</p>
<p>These data have a column called MW.da, which is the molecular weight in daltons, and also a column called volume. What is the relationship between the two variables? Make a guess.</p>
<p>We can visualize the relationship with a <strong>scatterplot</strong>. A scatterplot has a <strong>numeric variable</strong> on the x-axis and a different numeric variable on the y-axis. The code below makes a simple scatter plot. Note the following things</p>
<ol style="list-style-type: decimal">
<li>there are 3 arguments, data, x and y</li>
<li>an equals sign (=) assigns a value to an argument</li>
<li>aa is NOT in quotes, while MW.da and volume are. This is a bit annoying.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, x <span class="op">=</span> <span class="st">"MW.da"</span>, y <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>One thing about R code is that it can span multiple lines. In the code below click after the first command and press enter, then click after the second comma and press enter. Then run the chunk. What happens?</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, x <span class="op">=</span> <span class="st">"MW.da"</span>, y <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Writing code on multiple lines can make it easier to read. It also allows you to add comments to each part of a piece of code. To make a comment, we need the <strong>comment character</strong>, which in R is the hashtag #.</p>
<p>In the code below put a # after each line, and add a note about what the line does, then run the code.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, 
          x <span class="op">=</span> <span class="st">"MW.da"</span>, 
          y <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div id="adding-color-to-a-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-color-to-a-plot" class="anchor"></a>Adding color to a plot</h2>
<p>We can color code things easily in R using categorical variables. Let’s assign a different color to the different polarities. We do this by add in “color =” to the code. Note that we have to put the categorical variable name in quotes " "</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, 
          x <span class="op">=</span> <span class="st">"MW.da"</span>, 
          y <span class="op">=</span> <span class="st">"volume"</span>,
          color <span class="op">=</span> <span class="st">"polarity.cat"</span><span class="op">)</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>We could also color code by a different variable, such as charge, hydropathy, or volumne.ca. Selection one of these and replace “polarity.cat” with it.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, 
          x <span class="op">=</span> <span class="st">"MW.da"</span>, 
          y <span class="op">=</span> <span class="st">"volume"</span>,
          color <span class="op">=</span> <span class="st">"polarity.cat"</span><span class="op">)</span> <span class="co"># replace this; leave the quotes</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div id="changing-symbols" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-symbols" class="anchor"></a>Changing symbols</h2>
<p>We can also make a plot more interesting by changing the plotting symbols. In the code below change the word color to shape. (Both of these are called arguments)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, 
          x <span class="op">=</span> <span class="st">"MW.da"</span>, 
          y <span class="op">=</span> <span class="st">"volume"</span>,
          color <span class="op">=</span> <span class="st">"polarity.cat"</span><span class="op">)</span> <span class="co"># replace this; leave the quotes</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div id="adding-more-stuff-to-a-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-more-stuff-to-a-plot" class="anchor"></a>Adding more stuff to a plot</h2>
<p>The relationship between the two variables is pretty obvious, but we can emphasize it by adding a line of best fit, aka a regression line. In the code below remove the word “color” and change the word for a categorical variable to reg.line.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>, 
          x <span class="op">=</span> <span class="st">"MW.da"</span>, 
          y <span class="op">=</span> <span class="st">"volume"</span>,
          color <span class="op">=</span> <span class="st">"polarity.cat"</span><span class="op">)</span> </code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div id="boxplots" class="section level2">
<h2 class="hasAnchor">
<a href="#boxplots" class="anchor"></a>Boxplots</h2>
<p>Another way to look at data is to plot categorical variables along the x-axis and a numeric variable on the y. We can do this with boxplots and the function ggboxplot(). Polarity can be measured quantitatively, so we can compare the categories in polarity.cat to the numeric values in polarity.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html">ggboxplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aa</span>,
          x <span class="op">=</span> <span class="st">"polarity.cat"</span>, 
          y <span class="op">=</span> <span class="st">"polarity"</span><span class="op">)</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>In a boxplot the thick line shows you the median. Most of the data points fall within the boxes, and the lines that extend up and down (“whiskers”) usually extend to the max and minimum. What is the approximate median (to the nearest 5 units) of polar amino acids? How much variation is there? (Answer on TopHat)</p>
<p>Hydrophobicity is a major characteristic of amino acids. This data set has two variables, hydrophobe.34 and hydrophobe.34 (the numbers just refer to different references where the values were derived). Make a boxplot using ggboxplot with polarity.cat on the x axis (as above) hydrophobe.34 on the y axis. Remember to put things in quotes as needed.</p>
</div>
<div id="multivariate-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#multivariate-groups" class="anchor"></a>Multivariate groups</h2>
<p>There are many important characteristics of amino acids. When data have multiple variables like this it is often called <strong>multivariate data</strong>. (There is an important different between multivariate data and multivarible analyses, but I’ll let your stats profs teach about that). Multivariate data can be hard to make sense of. A classic way to think about amino acids is to make a <strong>Venn Diagram</strong> showing similarities between amino acids. You can see this Venn Diagram here: <a href="http://www.russelllab.org/aas/" class="uri">http://www.russelllab.org/aas/</a> . Amino acids that are close together are generally similar, especially if they are within the same circle. So I and L are similar to each other, and Y and W are similar, but I and Y are not so similar.</p>
<p>These Venn Diagrams are based on deep knowledge of the chemistry of the amino acids. Let’s see if we can use a computer algorithm called <strong>cluster analysis</strong> to arrive at similar conclusions.</p>
<p>First, for cluster analysis we are only going to use the <strong>numeric variables</strong>. Let’s get rid of those variables. The first column has our amino acid letter, and columns 2 through 11 have numeric variables. (column 12 is a numeric variable, relative frequency, but we’re going to drop it).</p>
<p>To make our subset we’re going to use R’s <strong>square bracket notation</strong>.</p>
<p>First, run the code below and think about what happened</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa</span><span class="op">[</span> , <span class="op">]</span>
<span class="co">#&gt;    letter MW.da volume bulkiness polarity isoelectric.pt hydrophobe.34</span>
<span class="co">#&gt; 1       A    89     67     11.50     0.00           6.00           1.8</span>
<span class="co">#&gt; 2       C   121     86     13.46     1.48           5.07           2.5</span>
<span class="co">#&gt; 3       D   133     91     11.68    49.70           2.77          -3.5</span>
<span class="co">#&gt; 4       E   146    109     13.57    49.90           3.22          -3.5</span>
<span class="co">#&gt; 5       F   165    135     19.80     0.35           5.48           2.8</span>
<span class="co">#&gt; 6       G    75     48      3.40     0.00           5.97          -0.4</span>
<span class="co">#&gt; 7       H   155    118     13.69    51.60           7.59          -3.2</span>
<span class="co">#&gt; 8       I   131    124     21.40     0.13           6.02           4.5</span>
<span class="co">#&gt; 9       K   146    135     15.71    49.50           9.74          -3.9</span>
<span class="co">#&gt; 10      L   131    124     21.40     0.13           5.98           3.8</span>
<span class="co">#&gt; 11      M   149    124     16.25     1.43           5.74           1.9</span>
<span class="co">#&gt; 12      N   132     96     12.28     3.38           5.41          -3.5</span>
<span class="co">#&gt; 13      P   115     90     17.43     1.58           6.30          -1.6</span>
<span class="co">#&gt; 14      Q   147    114     14.45     3.53           5.65          -3.5</span>
<span class="co">#&gt; 15      R   174    148     14.28    52.00          10.76          -4.5</span>
<span class="co">#&gt; 16      S   105     73      9.47     1.67           5.68          -0.8</span>
<span class="co">#&gt; 17      T   119     93     15.77     1.66           6.16          -0.7</span>
<span class="co">#&gt; 18      V   117    105     21.57     0.13           5.96           4.2</span>
<span class="co">#&gt; 19      W   204    163     21.67     2.10           5.89          -0.9</span>
<span class="co">#&gt; 20      Y   181    141     18.03     1.61           5.66          -1.3</span>
<span class="co">#&gt;    hydrophobe.35 saaH2O faal.fold polar.req  freq charge  hydropathy volume.cat</span>
<span class="co">#&gt; 1            1.6    113      0.74       7.0  7.80     un hydrophobic  verysmall</span>
<span class="co">#&gt; 2            2.0    140      0.91       4.8  1.10     un hydrophobic      small</span>
<span class="co">#&gt; 3           -9.2    151      0.62      13.0  5.19    neg hydrophilic      small</span>
<span class="co">#&gt; 4           -8.2    183      0.62      12.5  6.72    neg hydrophilic     medium</span>
<span class="co">#&gt; 5            3.7    218      0.88       5.0  4.39     un hydrophobic  verylarge</span>
<span class="co">#&gt; 6            1.0     85      0.72       7.9  6.77     un     neutral  verysmall</span>
<span class="co">#&gt; 7           -3.0    194      0.78       8.4  2.03    pos     neutral     medium</span>
<span class="co">#&gt; 8            3.1    182      0.88       4.9  6.95     un hydrophobic      large</span>
<span class="co">#&gt; 9           -8.8    211      0.52      10.1  6.32    pos hydrophilic      large</span>
<span class="co">#&gt; 10           2.8    180      0.85       4.9 10.15     un hydrophobic      large</span>
<span class="co">#&gt; 11           3.4    204      0.85       5.3  2.28     un hydrophobic      large</span>
<span class="co">#&gt; 12          -4.8    158      0.63      10.0  4.37     un hydrophilic      small</span>
<span class="co">#&gt; 13          -0.2    143      0.64       6.6  4.26     un     neutral      small</span>
<span class="co">#&gt; 14          -4.1    189      0.62       8.6  3.45     un hydrophilic     medium</span>
<span class="co">#&gt; 15         -12.3    241      0.64       9.1  5.23    pos hydrophilic      large</span>
<span class="co">#&gt; 16           0.6    122      0.66       7.5  6.46     un     neutral  verysmall</span>
<span class="co">#&gt; 17           1.2    146      0.70       6.6  5.12     un     neutral      small</span>
<span class="co">#&gt; 18           2.6    160      0.86       5.6  7.01     un hydrophobic     medium</span>
<span class="co">#&gt; 19           1.9    259      0.85       5.2  1.09     un hydrophobic  verylarge</span>
<span class="co">#&gt; 20          -0.7    229      0.76       5.4  3.30     un     neutral  verylarge</span>
<span class="co">#&gt;    polarity.cat</span>
<span class="co">#&gt; 1      nonpolar</span>
<span class="co">#&gt; 2      nonpolar</span>
<span class="co">#&gt; 3         polar</span>
<span class="co">#&gt; 4         polar</span>
<span class="co">#&gt; 5      nonpolar</span>
<span class="co">#&gt; 6      nonpolar</span>
<span class="co">#&gt; 7         polar</span>
<span class="co">#&gt; 8      nonpolar</span>
<span class="co">#&gt; 9         polar</span>
<span class="co">#&gt; 10     nonpolar</span>
<span class="co">#&gt; 11     nonpolar</span>
<span class="co">#&gt; 12        polar</span>
<span class="co">#&gt; 13     nonpolar</span>
<span class="co">#&gt; 14        polar</span>
<span class="co">#&gt; 15        polar</span>
<span class="co">#&gt; 16        polar</span>
<span class="co">#&gt; 17        polar</span>
<span class="co">#&gt; 18     nonpolar</span>
<span class="co">#&gt; 19     nonpolar</span>
<span class="co">#&gt; 20        polar</span></code></pre></div>
<p>Now run this code and think about it:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt;  [1] A C D E F G H I K L M N P Q R S T V W Y</span>
<span class="co">#&gt; Levels: A C D E F G H I K L M N O P Q R S T U V W Y</span></code></pre></div>
<p>Now run this code and think about it.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>
<span class="co">#&gt;   letter MW.da volume bulkiness polarity isoelectric.pt hydrophobe.34</span>
<span class="co">#&gt; 1      A    89     67      11.5        0              6           1.8</span>
<span class="co">#&gt;   hydrophobe.35 saaH2O faal.fold polar.req freq charge  hydropathy volume.cat</span>
<span class="co">#&gt; 1           1.6    113      0.74         7  7.8     un hydrophobic  verysmall</span>
<span class="co">#&gt;   polarity.cat</span>
<span class="co">#&gt; 1     nonpolar</span></code></pre></div>
<p>Now instead of 1 type 1:2. Try both scenarios.</p>
<p>Ok, now let’s make our subset. We want the second through 11th column, and all of the rows</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa_subset</span> <span class="op">&lt;-</span> <span class="va">aa</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span></code></pre></div>
<p>Check that you got what you want using head(aa_subset)</p>
<p>Now we’re going to do something a bit goofy with the names of the amino acids. What we need to do is assign them to the row names of our aa_subset dataframe. Just run the code below</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">aa_subset</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">aa</span><span class="op">$</span><span class="va">letter</span></code></pre></div>
<p>Now look at what we have. What’s on the far left hand side of what gets displayed?</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">aa_subset</span><span class="op">)</span>
<span class="co">#&gt;   MW.da volume bulkiness polarity isoelectric.pt hydrophobe.34 hydrophobe.35</span>
<span class="co">#&gt; A    89     67     11.50     0.00           6.00           1.8           1.6</span>
<span class="co">#&gt; C   121     86     13.46     1.48           5.07           2.5           2.0</span>
<span class="co">#&gt; D   133     91     11.68    49.70           2.77          -3.5          -9.2</span>
<span class="co">#&gt; E   146    109     13.57    49.90           3.22          -3.5          -8.2</span>
<span class="co">#&gt; F   165    135     19.80     0.35           5.48           2.8           3.7</span>
<span class="co">#&gt; G    75     48      3.40     0.00           5.97          -0.4           1.0</span>
<span class="co">#&gt;   saaH2O faal.fold polar.req</span>
<span class="co">#&gt; A    113      0.74       7.0</span>
<span class="co">#&gt; C    140      0.91       4.8</span>
<span class="co">#&gt; D    151      0.62      13.0</span>
<span class="co">#&gt; E    183      0.62      12.5</span>
<span class="co">#&gt; F    218      0.88       5.0</span>
<span class="co">#&gt; G     85      0.72       7.9</span></code></pre></div>
<p>Compare that to</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span>
<span class="co">#&gt;   letter MW.da volume bulkiness polarity isoelectric.pt hydrophobe.34</span>
<span class="co">#&gt; 1      A    89     67     11.50     0.00           6.00           1.8</span>
<span class="co">#&gt; 2      C   121     86     13.46     1.48           5.07           2.5</span>
<span class="co">#&gt; 3      D   133     91     11.68    49.70           2.77          -3.5</span>
<span class="co">#&gt; 4      E   146    109     13.57    49.90           3.22          -3.5</span>
<span class="co">#&gt; 5      F   165    135     19.80     0.35           5.48           2.8</span>
<span class="co">#&gt; 6      G    75     48      3.40     0.00           5.97          -0.4</span>
<span class="co">#&gt;   hydrophobe.35 saaH2O faal.fold polar.req freq charge  hydropathy volume.cat</span>
<span class="co">#&gt; 1           1.6    113      0.74       7.0 7.80     un hydrophobic  verysmall</span>
<span class="co">#&gt; 2           2.0    140      0.91       4.8 1.10     un hydrophobic      small</span>
<span class="co">#&gt; 3          -9.2    151      0.62      13.0 5.19    neg hydrophilic      small</span>
<span class="co">#&gt; 4          -8.2    183      0.62      12.5 6.72    neg hydrophilic     medium</span>
<span class="co">#&gt; 5           3.7    218      0.88       5.0 4.39     un hydrophobic  verylarge</span>
<span class="co">#&gt; 6           1.0     85      0.72       7.9 6.77     un     neutral  verysmall</span>
<span class="co">#&gt;   polarity.cat</span>
<span class="co">#&gt; 1     nonpolar</span>
<span class="co">#&gt; 2     nonpolar</span>
<span class="co">#&gt; 3        polar</span>
<span class="co">#&gt; 4        polar</span>
<span class="co">#&gt; 5     nonpolar</span>
<span class="co">#&gt; 6     nonpolar</span></code></pre></div>
<p>Ok, now let’s do cluster analysis. Cluster analysis is an <strong>exploratory data analysis</strong> tool that let’s you look for natural groupings in data. Its related to <strong>machine learning</strong>. Its common in genetics and community ecology, among other things. We can do a cluster analysis in R like this.</p>
<p>First, we need to assess how similar are amino acids are to each other in a way to take into account all 10 columns of our data. This can be done with a thing called a <strong>multivariate distance matrix</strong>. We won’t worry about the details right now. (If you want, you can try to think about points spread out in 3D space and measuring the distance between each one; now think about them spread out in 10-dimensional space and think about the distance between each one. Don’t hurt yourself doing this).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">aa_subset</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="co"># distance matrix</span></code></pre></div>
<p>The dist() command just made a <strong>distance matrix</strong> for us. We can use is to see what R tells us about it</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">is</span><span class="op">(</span><span class="va">aa_dist</span><span class="op">)</span>
<span class="co">#&gt; [1] "dist"</span></code></pre></div>
<p>This is a big matrix with lots of decimal places, so we can look at it most easily if we type round(aa_dist) . Type that code below</p>
<p>This might not fit well on your screen. If you have trouble try this (sorry, not going to explain it)</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aa_dist</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;     A   C   D   E   F</span>
<span class="co">#&gt; A   0  46  81 112 147</span>
<span class="co">#&gt; C  46   0  53  75 102</span>
<span class="co">#&gt; D  81  53   0  39 101</span>
<span class="co">#&gt; E 112  75  39   0  71</span>
<span class="co">#&gt; F 147 102 101  71   0</span></code></pre></div>
<p>Small numbers mean that, taking all 10 variables into account, two amino acids are similar to each other. For example, if you look at just the upper left hand part of the big grid A and C have a value of 46. Big numbers mean that, taking all 10 variables into account, two amino acids are very different. A and E have a value of 112. So A and C are closer together or more similar than A and E.</p>
<p>This matrix thingy is hard to interpret, so we can turn it into a graph. We’ll use the hclust() function, which is a type of cluster analysis.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">aa_cluster</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">aa_dist</span>, method<span class="op">=</span><span class="st">"ward.D"</span><span class="op">)</span></code></pre></div>
<p>Now let’s plot the results using R’s basic plot() command</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">aa_cluster</span><span class="op">)</span></code></pre></div>
<p><img src="aminio-acids-worked_example_data_visualization-DeprecatedQ_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p>As I noted above, according to expert biochemists, I and L are similar to each other, and Y and W are similar, but I and Y are not so similar. Could R’s cluster algorithm figure this out?</p>
<p>To use phylogeny terms, I and L appear as <strong>Sisters</strong> on the tree. Cool, that worked. However, Y and F are sisters, and W is one step removed. Refer back to the Venn Diagram. Are F and Y considered similar by the experts?</p>
<p>On the original Venn Diagram there are 3 large circles, and several smaller ones. What are the labels of the circles? (Answer in TopHat)</p>
<p>On the Venn Diagram the following amino acids are considered hydrophobic (note that this isn’t exactly the same as our data)</p>
<p>C T V G A I L M F Y W H K</p>
<p>There’s some overlap with the left most group, but its far from perfect. So our branch diagram has 3 major groupings, and the experts have 3 major groups, but they don’t match up perfectly. There could be many reasons for this, but it could be that we’re considering different data than what the experts considered important, or that we we used a computer algorithm that actually knows nothing about biochemistry!</p>
</div>
<div id="notes-for-further-study" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-for-further-study" class="anchor"></a>Notes for Further study</h2>
<p>The following notes may be added to this chapter in the future; ignore them unless you are super curious about clustering algorithms</p>
<div id="upgma" class="section level3">
<h3 class="hasAnchor">
<a href="#upgma" class="anchor"></a>UPGMA</h3>
<p>Wikipedia has a step by step introduction to UPGMA: <a href="https://en.wikipedia.org/wiki/UPGMA" class="uri">https://en.wikipedia.org/wiki/UPGMA</a></p>
<p><a href="http://www.nmsr.org/upgma.htm" class="uri">http://www.nmsr.org/upgma.htm</a></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa_cluster</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">aa_dist</span>, method<span class="op">=</span><span class="st">"ward.D"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b</span> <span class="op">&lt;-</span><span class="fu">sim2dist</span><span class="op">(</span><span class="va">BLOSUM45</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, maxSim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">BLOSUM45</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">b_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">b</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="co"># distance matrix</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">b_dist</span>, method<span class="op">=</span><span class="st">"ward.D"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">aa_dist</span>, method<span class="op">=</span><span class="st">"ward.D"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BLOSUM45</span></code></pre></div>
</div>
<div id="neighbor-joining" class="section level3">
<h3 class="hasAnchor">
<a href="#neighbor-joining" class="anchor"></a>Neighbor joining</h3>
<p><a href="https://en.wikipedia.org/wiki/Neighbor_joining" class="uri">https://en.wikipedia.org/wiki/Neighbor_joining</a></p>
<p>original publication has examples</p>
<p>other examples online</p>
</div>
<div id="wards-method" class="section level3">
<h3 class="hasAnchor">
<a href="#wards-method" class="anchor"></a>Ward’s method</h3>
<p>Based on changes in variance; least squares?</p>
<p><a href="https://en.wikipedia.org/wiki/Ward%27s_method" class="uri">https://en.wikipedia.org/wiki/Ward%27s_method</a></p>
</div>
<div id="hclust-algorithms" class="section level3">
<h3 class="hasAnchor">
<a href="#hclust-algorithms" class="anchor"></a>hclust algorithms</h3>
<p>hclust can use the follwing methods to build the tree</p>
<ul>
<li>“ward.D”, “ward.D2”</li>
<li>“single”: “closely related to the minimal spanning tree”</li>
<li>“complete”</li>
<li>“average” (= UPGMA), which is a method previous used for building phylogenetic trees</li>
<li>“mcquitty” (= WPGMA), “median” (= WPGMC)</li>
<li>“centroid” (= UPGMC).</li>
</ul>
<p>From ?hclust “This function performs a hierarchical cluster analysis using a set of dissimilarities for the n objects being clustered. Initially, each object is assigned to its own cluster and then the algorithm proceeds iteratively, at each stage joining the two most similar clusters, continuing until there is just a single cluster. At each stage distances between clusters are recomputed by the Lance–Williams dissimilarity update formula according to the particular clustering method being used.”</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

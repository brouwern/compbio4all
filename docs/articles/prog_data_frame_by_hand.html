<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building dataframes by hand • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Building dataframes by hand">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="prog_data_frame_by_hand_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Building dataframes by hand</h1>
            
      
      
      <div class="hidden name"><code>prog_data_frame_by_hand.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This exercise is meant to challenge you to build a dataframe by hand in R. It is based off of the Table 1 in Drake (1991) “A constant rate of spontaneous mutation in DNA-base microbes.”</p>
<p>There are two versions of this tutorial. This versions will guide you through the process of building the dataframe and exploring it. A second version is designed to challenge your understanding of the steps we went through.</p>
</div>
<div id="to-do" class="section level2">
<h2 class="hasAnchor">
<a href="#to-do" class="anchor"></a>To do</h2>
<p>a studnet noted on an earlier vs. of the assignment; feel free to take this approach when possible. I may modify the assignmnet in the future to reflect this approach</p>
<p>“I was finding the exponent notation” used in the assignment "tedious, so I tried what I’ve always done in other languages and it works. Other programmers might be more comfortable with this so it might be worth mentioning if we do more exercises with exponents:</p>
<p>Using “E” (or “e”) immediately after a number followed by the power work, and you only need to include sign if the notation is for a decimal (e.g. 1,000,000 can be represented by “1E6” and 0.01 by “1E-2”).</p>
<p>In the data frames exercise, the vector with numbers from the paper could’ve been done in one step like this: vector &lt;- c(6.41E3, 4.85E4, 1.6E5…). I’m not sure if this would make more sense or be more efficient for others a well, but I personally prefer this style of notation."</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="non-r-materials" class="section level3">
<h3 class="hasAnchor">
<a href="#non-r-materials" class="anchor"></a>Non-R materials</h3>
<p>For this you’ll need a copy of Drake (1991), which can be found at <a href="https://www.pnas.org/content/88/16/7160" class="uri">https://www.pnas.org/content/88/16/7160</a></p>
<p>We will focus on rebuiling Table 1 and Figure 1 entirely in R without importing the data from a spreadsheet.</p>
</div>
<div id="packages" class="section level3">
<h3 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h3>
<p>The only package you will need is ggpubr. Load ggpubr using library():</p>
</div>
<div id="ignore-this" class="section level3">
<h3 class="hasAnchor">
<a href="#ignore-this" class="anchor"></a>Ignore this</h3>
<p>deprecated</p>
</div>
</div>
<div id="the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-data" class="anchor"></a>The data</h2>
<p>Table 1 of Drake (1991) has the following columns. Note that the symbol mu (u) is frequently used to represent mutation rates.</p>
<ol style="list-style-type: decimal">
<li>A list of organisms (viruses, bacteria and invertebrate eukaryotes)</li>
<li>genome sizes (G) for each organism, in scientific notation</li>
<li>A target gene, which was assessed for the occurrence of mutations</li>
<li>An estimate of the mutation rate per bases (bp) of the genome. This gets log transformed and used as the y variable in figure 1. I’ll use the symbol u.bp for this variable</li>
<li>An estimate of the mutation rate per genome (u.g). This variable isn’t in scientific notation so we’ll work with it first because its a bit easier to read.</li>
</ol>
<p>The organism column has gaps in it because there are multiple target genes for these species</p>
<ol style="list-style-type: decimal">
<li>3 E. coli genes</li>
<li>3 S. cerevisiae genes</li>
<li>2 N. crassa genes</li>
</ol>
<p><strong>Note that the very last numbers that appear in the mutation columns are means, not data!</strong></p>
</div>
<div id="creating-vectors-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-vectors-in-r" class="anchor"></a>Creating vectors in R</h2>
<p>We can build up a dataframe in R by making a <strong>vector</strong> for each column. This is a bit tedious but will build up our skills, so be patient.</p>
<p>We can make a vector of organism names like this. We need to make sure each word representing an organisms is in quotes, and that there is a comma after each word.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">org</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M13"</span>,<span class="st">"lamb"</span>, <span class="st">"T2"</span>, <span class="st">"T4"</span>, <span class="st">"EC"</span>,<span class="st">"EC"</span>,<span class="st">"EC"</span>,<span class="st">"SC"</span>,<span class="st">"SC"</span>,<span class="st">"SC"</span>,<span class="st">"NC"</span>,<span class="st">"NC"</span><span class="op">)</span></code></pre></div>
<p>We can use line breaks while defining an R object, which can make it easier to keep track of what were typing. The following code is equivalent to what we just ran. Because there are multiple E. coli (EC) , SC and NC, I’m putting them on their own lines.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">org</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M13"</span>, <span class="st">"lamb"</span>, <span class="st">"T2"</span>, <span class="st">"T4"</span>, 
         <span class="st">"EC"</span>, <span class="st">"EC"</span>, <span class="st">"EC"</span>,
         <span class="st">"SC"</span>, <span class="st">"SC"</span>, <span class="st">"SC"</span>,
         <span class="st">"NC"</span>,<span class="st">"NC"</span><span class="op">)</span></code></pre></div>
<p>If you want to be fancy, use rep() for the repeated (I will rarely do this in class though).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">org</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M13"</span>,<span class="st">"lamb"</span>, <span class="st">"T2"</span>, <span class="st">"T4"</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"EC"</span>,<span class="fl">3</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"SC"</span>,<span class="fl">3</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"NC"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As always we need to check to make sure that the object we’re making is what we think it is and represents what we want. Use the following commands to check on the object:</p>
<ul>
<li>is</li>
<li>is.vector</li>
<li>is.matrix</li>
<li>class</li>
<li>length</li>
<li>nchar</li>
</ul>
<p>Next let’s make the next vector. Below is the code you’ll need, but I’ve left off the last 3 numbers. Paste the code into the code chunk and add the necessary numbers from the original table. Don’t forget the commas. Also note that numbers <strong>don’t</strong> get quotes around them.</p>
<p>G.p &lt;- c(6.41, 4.85, 1.60, 1.66, 4.70, 4.70, 4.70, 1.38, 1.38 )</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run the code tomake the G.p vector here</span>
<span class="co"># be sure to add the necessary numbers</span></code></pre></div>
<p>Again, we explore this. Run these functions and note the output</p>
<ul>
<li>is</li>
<li>class</li>
<li>length</li>
<li>nchar</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Type code to explore the G.p vector here</span></code></pre></div>
</div>
<div id="checking-the-length-of-vectors" class="section level2">
<h2 class="hasAnchor">
<a href="#checking-the-length-of-vectors" class="anchor"></a>Checking the length of vectors</h2>
<p>Vectors in R have length, not dimension, so to see how big they are we use the length() command; dim() won’t work. Neither will ncol() or nrow().</p>
<p>All of our columns have the same number of elements in them. We can make sure we don’t have any errors in our data entry by using a logical operation, ==, to confirm that the length of each vector is the same. This is very useful when vectors are big and/or when we’re writing code to automate a process</p>
<p>First, check the length of one of the vectors</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Confirm the length of of one of the vectors</span></code></pre></div>
<p>Next, run this code to check that the two lengths are the same: length(G.p) == length(org)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check that the lengths are the same</span></code></pre></div>
</div>
<div id="exponents-and-scientific-notation" class="section level2">
<h2 class="hasAnchor">
<a href="#exponents-and-scientific-notation" class="anchor"></a>Exponents and scientific notation</h2>
<p>To take the exponent of something in R use the up caret ^</p>
<p>So, if I want to type 1 million I can do this</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fl">1000000</span>
<span class="co">#&gt; [1] 1e+06</span></code></pre></div>
<p>or I can do this</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fl">1</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span>
<span class="co">#&gt; [1] 1e+06</span></code></pre></div>
<p>Note that the output is in “e” notation. I could type this if I wanted</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fl">1e+06</span>
<span class="co">#&gt; [1] 1e+06</span></code></pre></div>
<p>In the chunk below, write a logical expression using == to confirm that 1000000 is equal to 1*10^6</p>
<p>To represent the genome size column I could do this (just showing first 3 numbers)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">G.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.41</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">4.85</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span>, <span class="fl">1.60</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>However. when typing up this data I found it easier to break up the columns containing exponents into multiple columns, otherwise I was getting cross eyed.</p>
<p>One way to do this would be to split each number into what I’m calling a “prefix” and a “suffix”. Above we made a vector called G.p, which is the prefix of these numbers - the part before the multiplication symbol.</p>
<p>We can make another vector that contains the suffix - the 10^x part.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">G.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,    <span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">7</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">7</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">7</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">7</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">7</span><span class="op">)</span></code></pre></div>
<p>We can then multiple these together and get the value we want</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">G.p</span><span class="op">*</span><span class="va">G.s</span>
<span class="co">#&gt;  [1] 6.41e+08 4.85e+08 1.60e+10 6.41e+10 4.85e+10 1.60e+11 6.41e+11 4.85e+11</span>
<span class="co">#&gt;  [9] 1.60e+12 6.41e+12 4.85e+11 1.60e+12</span></code></pre></div>
<p>Note that this is doing is multiplying each element of G.p by the corresponding element of G.s. We could break this up like this</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">G.p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">G.s</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 6.41e+08</span>

<span class="va">G.p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">G.s</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; [1] 4.85e+08</span></code></pre></div>
<p>This works pretty well, but I found typing all those exponents to still be a little annoying, especially since many get repeated. I think its easier to just type the exponent. We’ll call this object “G.exp” for exponent</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">G.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>,    <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span></code></pre></div>
<p>Again, if you want to be fancy you can play around with the rep() function, though this is optional</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">G.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>,    
         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now, to get the numbers we want, we can do this: G.p*10^G.exp Can you figure out what’s going on? If not, check the next chunk</p>
<p>Here I’ve added some parentheses to clarify the order of operations</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">G.p</span><span class="op">*</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="va">G.exp</span><span class="op">)</span>
<span class="co">#&gt;  [1] 6.41e+08 4.85e+08 1.60e+10 6.41e+10 4.85e+10 1.60e+11 6.41e+11 4.85e+11</span>
<span class="co">#&gt;  [9] 1.60e+12 6.41e+12 4.85e+11 1.60e+12</span></code></pre></div>
<p>If its still not clear, then maybe this will help:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">G.s</span> <span class="op">==</span> <span class="fl">10</span><span class="op">^</span><span class="va">G.exp</span>
<span class="co">#&gt;  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span></code></pre></div>
<p>Let’s make a final G vector with genome sizes. This is the “prefix” I made (G.p) multipled by 10 raised to the exponent I defined in the vector G.exp.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">G</span> <span class="op">&lt;-</span>  <span class="va">G.p</span><span class="op">*</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="va">G.exp</span><span class="op">)</span></code></pre></div>
<p>We can make a basic plot showing the distribution of genome sizes using the histogram function in R, hist().</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>The far left value is 0e+00, which just means 0.0. The first tick mark is 1e+07. Write this out using an exponent symbol ^ below:</p>
<p>How do you interpret this graph? Ask you neighbor if they know. If you aren’t comfortable interpretting histograms see datavizcatalogue.com/methods/histogram.html and <a href="https://en.wikipedia.org/wiki/Histogram" class="uri">https://en.wikipedia.org/wiki/Histogram</a></p>
<p>Another way to look at this data would be with a boxplot</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>This is actually a realy ugly plot, but whatever.</p>
<p>hist() and boxplot() are great for quick and dirty plots. Normally though I’ll use ggpubr to make plots using gghistogram and ggboxplot</p>
</div>
<div id="some-more-vectors" class="section level2">
<h2 class="hasAnchor">
<a href="#some-more-vectors" class="anchor"></a>Some more vectors</h2>
<p>Next we have the per genome mutation rate. The “u” is a stand in for “mu” which is commonly used for mutation rates. So “u.bp” reads “mutation rate in bp.” First let’s do the “prefix” and assign it to a vector u.bp.p (mutation rate in bp prefix).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">u.bp.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.2</span>, <span class="fl">7.7</span>, <span class="fl">2.7</span>, <span class="fl">2</span>, <span class="fl">4.1</span>, <span class="fl">6.9</span>, <span class="fl">5.1</span>, <span class="fl">2.8</span>, <span class="fl">7.9</span>, <span class="fl">1.7</span>, <span class="fl">4.5</span>, <span class="fl">4.6</span><span class="op">)</span></code></pre></div>
<p>Confirm that this vector is the exact same size as our previous ones (Hint: requires “=”)</p>
<p>Confirm that what you just made was a vector. (Hint: what “is” it?)</p>
<p>Now let’s do the exponent and save it to a vector u.bp.exp.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">u.bp.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, 
            <span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">8</span>,<span class="op">-</span><span class="fl">8</span>,
            <span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">10</span>,
            <span class="op">-</span><span class="fl">9</span>,
            <span class="op">-</span><span class="fl">10</span>,
            <span class="op">-</span><span class="fl">11</span>,
            <span class="op">-</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>For those who want to be fancy, can you do this using the rep() command? (Totally optionall).</p>
<p>As before, make sure this new vector u.bp.exp is the right length</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">u.bp.exp</span><span class="op">)</span>
<span class="co">#&gt; [1] 12</span></code></pre></div>
<p>Now, ake the final column by carrying out the math. To do this put the following components together corrctly</p>
<ul>
<li>The “prefix” u.bp.p</li>
<li>The caret ^</li>
<li>The exponent u.bp.exp</li>
</ul>
<p>Assign the result to an object u.bp. Try to type this out yourself.</p>
<p>As always, check that the size of u.bp is correct</p>
<p>The last column is the per genome mutation rate, u.g.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">u.g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0046</span>, <span class="fl">0.0038</span>, <span class="fl">0.0043</span>, 
         <span class="fl">0.0033</span>, <span class="fl">0.0019</span>, <span class="fl">0.0033</span>, 
         <span class="fl">0.0024</span>, <span class="fl">0.0038</span>, <span class="fl">0.11</span>,
         <span class="fl">0.0024</span>, <span class="fl">0.0019</span>, <span class="fl">0.019</span><span class="op">)</span></code></pre></div>
<p>We can confirm that the vector is that same size as the prevous ones</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">G.s</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">u.g</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>I’m not 110% sure about the methods for this paper. I’m wondering if the per genome mutation rate u.g can be calculated from the per base pair mutation rate (u.bp) and the genome size (G). How do you think you could do this calculation in terms of the biology, the math, and in R? Save the output as an object u.g.2 (2nd version of u.g).</p>
<p>Hint: Don’t over think it; there’s just one mathematical operation, either multiplication or division (The answer is a bit further down).</p>
<p>Some more hints: G is the size of each genome. So the first genome in our vector has the size in base pairs (bp)</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">G</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 6.41e+08</span></code></pre></div>
<p>u.bp is the rate of mutations per base pairs. The mutation rate per base pairs for the first genome in the vector is</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">u.bp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 7.2e-07</span></code></pre></div>
<p>So, if we ant to determine the number of mutations per genome, we multiply the size of the genome in bp by the per bp rate of mutation</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">G</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">u.bp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 461.52</span></code></pre></div>
<p>We can compare this to what is in the table as the per genome rate of mutation (u.g)</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">u.g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.0046</span></code></pre></div>
<p>We can do all the multiplication of the whole vector in one shot like this: . Run this code in the chunk below</p>
<p>So we have the value of u.g from the column in Table 1 that we typed up above, and now we have our attempt to re-calculate it. One way to check them against each other is to make a simple dataframe and compare by eye</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">u.g</span>, <span class="va">u.g.2</span><span class="op">)</span>
<span class="co">#&gt;       u.g     u.g.2</span>
<span class="co">#&gt; 1  0.0046   461.520</span>
<span class="co">#&gt; 2  0.0038    37.345</span>
<span class="co">#&gt; 3  0.0043   432.000</span>
<span class="co">#&gt; 4  0.0033  1282.000</span>
<span class="co">#&gt; 5  0.0019    19.885</span>
<span class="co">#&gt; 6  0.0033   110.400</span>
<span class="co">#&gt; 7  0.0024   326.910</span>
<span class="co">#&gt; 8  0.0038   135.800</span>
<span class="co">#&gt; 9  0.1100 12640.000</span>
<span class="co">#&gt; 10 0.0024  1089.700</span>
<span class="co">#&gt; 11 0.0019    21.825</span>
<span class="co">#&gt; 12 0.0190   736.000</span></code></pre></div>
<p>This looks pretty close. Let’s round things off so its easier to read. Rounding is done with the round() command.</p>
<p>To round something in R, we need to give it a number (or numbers in a vector) and an indication of how many digits to round off to. In the original table the ubmres are rounded off to 4 digits</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">0.0037</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0037</span></code></pre></div>
<p>Instead of u.g.2, run the previous data.frame code with round(u.g.2, 4). That is, instead of u.g.2, put in round(u.g.2, 4)</p>
<p>THings don’t round off perfectly, perhaps because of other rounding they did during their workflow. But there’s something weird with the first number. Either I made a type or somethign else is up. Let me know what you think!</p>
<p>Another useful comparison here is ==. See if you can predict what will happen when you run: u.g == round(u.g.2, 4)</p>
<p>When doing comparisons like this, why might it be really important to consider rounding?</p>
</div>
<div id="make-a-dataframe" class="section level2">
<h2 class="hasAnchor">
<a href="#make-a-dataframe" class="anchor"></a>Make a dataframe</h2>
<p>We can put all our pieces together into a dataframe like this with data.frame()</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">table1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>organism <span class="op">=</span> <span class="va">org</span>,
           G <span class="op">=</span> <span class="va">G</span>,
           target <span class="op">=</span> <span class="cn">NA</span>,
           u.bp <span class="op">=</span> <span class="va">u.bp</span>,
           u.g <span class="op">=</span> <span class="va">u.g</span><span class="op">)</span></code></pre></div>
<p>For each column I am specifying a name and telling it the vector to turn into a column. For target I’m telling it just to fill it in wiht NA, which means there is no data</p>
<p>As always, we want to check what we just made. Run at least 2 commands exploring the size, share or content of the datarame</p>
</div>
<div id="make-figure-1-with-base-r" class="section level2">
<h2 class="hasAnchor">
<a href="#make-figure-1-with-base-r" class="anchor"></a>Make Figure 1 with base R</h2>
<p>We can make figure 1 with the basic R plot() command. FIrst let’s plot the raw data.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">u.bp</span> <span class="op">~</span> <span class="va">G</span>, data <span class="op">=</span> <span class="va">table1</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
<p>If you look at the figure its actually on the log scale. We can nest the log function within the plot function like this</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">u.bp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">table1</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
<p>Check out the y axis and the x axis of the plot and compare it to the figure (ge the figure at <a href="https://www.pnas.org/content/88/16/7160" class="uri">https://www.pnas.org/content/88/16/7160</a> ). What’s wrong?</p>
<p>R’s default log() functions uses the natural log ln. To do the base 10 log change the code to use log10</p>
</div>
<div id="make-figure-1-with-ggpubr" class="section level2">
<h2 class="hasAnchor">
<a href="#make-figure-1-with-ggpubr" class="anchor"></a>Make Figure 1 with ggpubr</h2>
<p>ggpubr makes nicer plots than base R, but you can’t nest functions in it. So what we need to do is make a column of the logged variables. For Genome size it requires this:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">table1</span><span class="op">$</span><span class="va">log10.G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">table1</span><span class="op">$</span><span class="va">G</span><span class="op">)</span></code></pre></div>
<p>Now make a new column for logged u.bp, using log10. Call it log10.u.bp. Try to type it out yourself.</p>
<p>While we’re at it lets make a log10 mutation rate per genome column called log10.u.g</p>
<p>Check our columns</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">table1</span><span class="op">$</span><span class="va">log10.u.bp</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt; -10.347  -9.429  -9.227  -8.623  -7.666  -6.143</span></code></pre></div>
<p>We can make scatter plot using ggscatter</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-57-1.png" width="700"></p>
<p>We can make lots of nice tweaks with ggpubr. Let’s vary the size of our data points based on the log of the mutation rate per genome, log10.u.g. This lets assess another pattern on top of the main correlation between G and u.bp</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span><span class="op">)</span> <span class="co">#size</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-58-1.png" width="700"></p>
<p>Now let’s add color based on log10.u.g also</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span>,   <span class="co">#size</span>
          color <span class="op">=</span> <span class="st">"log10.u.g"</span><span class="op">)</span>  <span class="co">#color</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
<p>The x axis isn’t very clear using the normal column name. Can you spot what is different about the code below?</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span>,   
          color <span class="op">=</span> <span class="st">"log10.u.g"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"log(Genome size)"</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-60-1.png" width="700"></p>
<p>Now let’s re-label the y axis. Note the plus signs afer the lines with xlab() and ylab(). What do you think they are doing?</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span>,   
          color <span class="op">=</span> <span class="st">"log10.u.g"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"log(Genome size)"</span><span class="op">)</span>     <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"log(mutations per bp)"</span><span class="op">)</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
<p>There is a strong correlation between genome size and mutation rate (on the log scale). We can further emahsize this patern with a regression line. Note that within the call to ggscatter() I’ve added add = “reg.line”</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span>,   
          color <span class="op">=</span> <span class="st">"log10.u.g"</span>,
          add <span class="op">=</span> <span class="st">"reg.line"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"log(Genome size)"</span><span class="op">)</span>     <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"log(mutations per bp)"</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-62-1.png" width="700"></p>
<p>We can also fit curved lines easily if we want. See if you can figure out what’s different about this plot. (The line I’ve added is called a <strong>smoother</strong> made using a specific statistical method called <strong>loess</strong>.)</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span>,   
          color <span class="op">=</span> <span class="st">"log10.u.g"</span>,
          add <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"log(Genome size)"</span><span class="op">)</span>     <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"log(mutations per bp)"</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-63-1.png" width="700"></p>
</div>
<div id="add-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#add-statistics" class="anchor"></a>Add statistics</h2>
<p>We can do some quick statistics on the fly here by adding cor.coef =TRUE. What this does is calcualtes the strength of the relationsip between the x and the y variable (on the log) scale, quantifies it with a statistics R, and calculates stastitically a p-value to give us a sense of whether R is not 0. This is a very strong relationship, so R is almost -1 (R varies between -1 and 1) and the p-value is very small. Note that the technical definition of a p-value has a very precise meaning; generally consider p &lt; 0.05 to be “significant”. This means that the pattern we’re seeing in the data is unlikely to have occurred due to chance; however, is does not mean that if we repeated the study with a new data set that we woudln’t get a different result. That is, it doesn’t mean that our conclusions are true!</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">table1</span>,
          y <span class="op">=</span> <span class="st">"log10.u.bp"</span>,
          x <span class="op">=</span> <span class="st">"log10.G"</span>,
          size <span class="op">=</span> <span class="st">"log10.u.g"</span>,   
          color <span class="op">=</span> <span class="st">"log10.u.g"</span>,
          add <span class="op">=</span> <span class="st">"reg.line"</span>,
          cor.coef <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"log(Genome size)"</span><span class="op">)</span>     <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"log(mutations per bp)"</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="prog_data_frame_by_hand_files/figure-html/unnamed-chunk-64-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

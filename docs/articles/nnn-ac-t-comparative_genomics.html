<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>t) Comparative Genomics • compbio4all</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="t) Comparative Genomics">
<meta property="og:description" content="compbio4all">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio4all</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates-studnet-vs.html">Higgs and Atwood student version with updates</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG-with-misc-updates.html">Higgs and Atwood student version with updates - copy or alt?</a>
    </li>
    <li>
      <a href="../articles/Higgs_Atwood_AA_analysis-from-unit4-test-ORIG.html">Higgs and Atwood student version with updates - orig?</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_ggpubr.html">Software Checkpoint: ggpubr using Higgs and Atwood amino acids</a>
    </li>
    <li>
      <a href="../articles/Higgs_aa_data_1_load_and_replicate_plot.html">Higgs and Atwood part 1</a>
    </li>
    <li>
      <a href="../articles/PCA_tutorial_iris_data-inc_PCA_by_hand.html">Another PCA tutorial with Fisher's Iris Data</a>
    </li>
    <li>
      <a href="../articles/PCA_with_vegans_DCA.html">vegan PCA: Principal Components Analysis with vegans rda function</a>
    </li>
    <li>
      <a href="../articles/aaa-project_notes.html">a) Project notes</a>
    </li>
    <li>
      <a href="../articles/ac-a-introduction.html">a) Introduction</a>
    </li>
    <li>
      <a href="../articles/ac-k-GC_content_local_variation.html">k) Local variation in GC content</a>
    </li>
    <li>
      <a href="../articles/ac-u-HMM_sequence_evolution.html">u) Hidden Markov Models</a>
    </li>
    <li>
      <a href="../articles/aminio-acids-worked_example_data_visualization-DeprecatedQ.html">Worked example: Data visualization in R</a>
    </li>
    <li>
      <a href="../articles/basic_ac-h-vectors-AC04-01.html">Mini tutorial: Vectors in R</a>
    </li>
    <li>
      <a href="../articles/bbb-motivating_example.html">b) Motivating examples: Species distribution models</a>
    </li>
    <li>
      <a href="../articles/bbb-quickstart_RStudio_cloud.html">Quick start - RStudio Cloud</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_a_summary_stats-FROGARMS.html">Frog-armed: A first encounter with data</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_b_graphs-FROGARMS.html">A first encounter with data: graphs</a>
    </li>
    <li>
      <a href="../articles/casestudy-1st_encounter_w_data_c_t_test-FROGARMS.html">First encounter with data - t-test deprecated?</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-b-downloading_R_AC01-1.html">b) Downloading R</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-c-installing_RStudio_AC01-2.html">c) Downloading the RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-d-installing_packages_in_RStudio_AC01-3.html">d) Installing R packages</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-e-installing_bioconductor_AC01-4.html">e) Installing Bioconductor</a>
    </li>
    <li>
      <a href="../articles/ccc-ac-f-brief_intro_to_R_AC01-5.html">f) A Brief introduction to R</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-dplyr_filter.html">Data Cleaning: Filtering focal rows with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning-merge_BBS_with_landcover.html">Data cleaning: Merging 2 large data sets with dplyr</a>
    </li>
    <li>
      <a href="../articles/data_cleaning_selecting_different_spp_and_landcovers.html">Selecting different species and landovers from the wildlifeR package</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-g-NCBI_by_GUI1_AC03-1.html">g) Downloading NCBI sequence data by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-DNA_sequence_descriptive_stats-AC03-02-.html">DNA descriptive statics - Part 1</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-NCBI_by_GUI2_AC03-1Q.html">h) Introduction to biological sequences databases</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-h-downloading_DNA_seq_in_R-AC03-01.html">Downloading DNA sequences with R</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-i-uniprot_by_GUI-AC07-01.html">i) Downloading sequences from UniProt by hand</a>
    </li>
    <li>
      <a href="../articles/ddd-ac-j-advanced_NCBI_AC05-01.html">j) Sequence Databases</a>
    </li>
    <li>
      <a href="../articles/eee-PAM_matrices.html">The Dayhoff PAM matrices</a>
    </li>
    <li>
      <a href="../articles/eee-ac-l-alignment_in_R-AC07-02.html">l) Aligments in R</a>
    </li>
    <li>
      <a href="../articles/eee-ac-o-test_alignment_sig_pvalue-AC07-03-NOT_UPATED.html">o) Testing the significance of an alignment</a>
    </li>
    <li>
      <a href="../articles/eee-alignment.html">Aligments and matrices</a>
    </li>
    <li>
      <a href="../articles/eee-nlb-alignment-walkthrough.html">NB-a) Hello R!  Bioinformatics awesomness in a flash</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_12.html">Pevsner Chapter 3: BLAST Algorithm in R (kinda)</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14.html">Pevsner Figure 4.14</a>
    </li>
    <li>
      <a href="../articles/fff-blast-Pevsner_Ch4_figure4_14_extension.html">Simulating sequences to get an EVD</a>
    </li>
    <li>
      <a href="../articles/fff-blast_via_R.html">BLAST via R</a>
    </li>
    <li>
      <a href="../articles/fff-nlb-BLAST_summary.html">BLAST Summary</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m1-retrieving_mult_seqs-AC08-01-NOTUPATED.html">p) Retrieving multiple sequences in R</a>
    </li>
    <li>
      <a href="../articles/ggg-ac-m2-mult_align_CLUSTAL-AC08-02-NEEDS_MAJOR_REWRITE.html">m) Multiple alignment with Clustal</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-q-comp_gene_find-AC10-01-NOTUPATED.html">q) Computational gene finding</a>
    </li>
    <li>
      <a href="../articles/jjj-ac-r-sig_of_ORFs-AC10-02-NOTUPATED.html">r) Significance of ORFs</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA-WPGMA_wikipedia.html">WPGMA or UPGMA?</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_algo_fnxns-not_finished.html">UPGMA functions</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_by_hand-updated.html">UPGMA the hard way</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_cluster_maximization_used_in_effron.html">UPGMA - Cluster max</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_in_R.html">UPGMA in R</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework-ALT-Q.html">UPGMA Wikipedia example - copy or alt Q</a>
    </li>
    <li>
      <a href="../articles/lll-UPGMA_wikipedia_homework.html">UPGMA in R - the hard way - deprecated?</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m3-rooted_tree_NJ-AC08-04-NOTUPATED.html">s) Rooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-ac-m4-unrooted_tree_NJ_tree-AC08-03-NEEDS_MAJOR_REWRITE.html">n) Unrooted Neighbor-joining Phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-jc_distance_fnxn.html">Jukes-Cantor Distance Function</a>
    </li>
    <li>
      <a href="../articles/lll-jc_sim_for_render.html">Simulating molecular evolution</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-newick_format.html">Newick format in R</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees.html">Tutorial: Writing functions to calculate the number of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/lll-phylo-number_of_phylogenetic_trees_KEY.html">Tutorial: Writing functions to calculate the number of phylogenetic trees - KEY</a>
    </li>
    <li>
      <a href="../articles/llll-phylo_from_sequence_to_phylo_tree.html">Worked example: from sequence to phylogenetic tree</a>
    </li>
    <li>
      <a href="../articles/multivar_INTRO-high_dimensional_data_in_biology-iris_BCI_etc.html">Multivariate Data Analysis: Making Sense of High-Dimensional Data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_0_allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr-KEY.html">Software checkpoint: ggplot2 and ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_1_scp_ggpubr.html">ggplot2 and ggpubr software checkpoint</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp-KEY.html">Coding checkpoint: Plotting allometric data with ggpubr-KEY</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_2_allometric_data_ccp.html">Coding checkpoint: Plotting allometric data with ggpubr</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_4_vegan_and_pca.html">Overview: The vegan package for PCA</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allometry_5_cluster.html">Checkpoint: Cluster analysis with allometric data</a>
    </li>
    <li>
      <a href="../articles/multivar_data-allomtery_3_scp_scatterplot3d.html">Software checkpoint: scatterplot 3D</a>
    </li>
    <li>
      <a href="../articles/multivar_distances-GC_conent.html">Hiearchical clustering with Euclidean distances</a>
    </li>
    <li>
      <a href="../articles/nnn-ac-t-comparative_genomics.html">t) Comparative Genomics</a>
    </li>
    <li>
      <a href="../articles/plot-displaying_data_box_hist_base_R-NEEDS-IMAGES.html">Displaying Data - boxplot() &amp; hist()</a>
    </li>
    <li>
      <a href="../articles/plot-par_tutorial.html">Graphical parameters in R with par(): With great power comes great responsibility</a>
    </li>
    <li>
      <a href="../articles/plot_nlb-scp-ggplot2-ggpubr-allometric_scaling.html">Software checkpoint: ggplot2 and ggpubr-COPY?</a>
    </li>
    <li>
      <a href="../articles/prog-R_quirks_putting_things_into_vectors.html">R quirks: putting things in vectors</a>
    </li>
    <li>
      <a href="../articles/prog-assignment-for_loops.html">for loops in R</a>
    </li>
    <li>
      <a href="../articles/prog-simulate_random_aa_seqs.html">Simulating random amino acid sequences</a>
    </li>
    <li>
      <a href="../articles/prog_ac-h-programming_in_R-AC04-02.html">Programming in R: for loops and functions</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-function_practice.html">Writing functions - practice problems</a>
    </li>
    <li>
      <a href="../articles/prog_assignment-regex-accessions.html">Computational Biology Portfolio: Practice Working with Strings</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand.html">Building dataframes by hand</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set-KEY.html">Dataframe by hand - problem set - KEY</a>
    </li>
    <li>
      <a href="../articles/prog_data_frame_by_hand_problem_set.html">Dataframe by hand - problem set</a>
    </li>
    <li>
      <a href="../articles/prog_dataframe_by_hand_simple_with_plots.html">Making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/prog_nlb-walkthrough-making_simple_df.html">Walkthrough - making a simple dataframe</a>
    </li>
    <li>
      <a href="../articles/sss-nlb-types_of_data.html">Types of data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-ANOVA_deer_antlers-ADD-DATA.html">Intro to 1-way ANOVA: impacts of diet on deer antlers</a>
    </li>
    <li>
      <a href="../articles/sss-stats-Inf_by_eye.html">Inference-by-eye using RA Fisher's Cat Data</a>
    </li>
    <li>
      <a href="../articles/sss-stats-_means_errorbars_2016_base_R.html">Displaying data - means &amp; error bars</a>
    </li>
    <li>
      <a href="../articles/sss-stats-p_values_defined.html">P-values</a>
    </li>
    <li>
      <a href="../articles/sss-stats-paired_t_test_2_ways_walkthrough.html">paried t tests</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_paired_t_test.html">Running &amp; reporting paired t-tests in R</a>
    </li>
    <li>
      <a href="../articles/sss-stats-tttest-reporting_t_test-ADD-DATA.html">Reporting statistical result from a 2-sample t-test</a>
    </li>
    <li>
      <a href="../articles/zzz0-undergrad_editors.html">z0) Undergraduate editors</a>
    </li>
    <li>
      <a href="../articles/zzz0-vocab.html">z) vocab</a>
    </li>
    <li>
      <a href="../articles/zzz1-temp.html">z) vignette template</a>
    </li>
    <li>
      <a href="../articles/zzz2-TODO.html">TODO</a>
    </li>
    <li>
      <a href="../articles/zzz3-creating_this_package.html">x) Creating this package</a>
    </li>
    <li>
      <a href="../articles/zzz4-document_datasets.html">y) Documenting datasets</a>
    </li>
    <li>
      <a href="../articles/zzz5-build_and_rebuild_package.html">Building &amp; rebuilding this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="nnn-ac-t-comparative_genomics_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>t) Comparative Genomics</h1>
            
      
      
      <div class="hidden name"><code>nnn-ac-t-comparative_genomics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">compbio4all</span><span class="op">)</span></code></pre></div>
<p><strong>By</strong>: Avril Coghlan.</p>
<p><strong>Adapted, edited and expanded</strong>: Nathan Brouwer under the Creative Commons 3.0 Attribution License <a href="https://creativecommons.org/licenses/by/3.0/">(CC BY 3.0)</a>, with assistance from Aman Virmani.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>

<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"biomaRt"</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Comparative genomics is the field of bioinformatics that involves comparing the genomes of two different species, or of two different strains of the same species.</p>
<p>One of the first questions to ask when comparing the genomes of two species is: do the two species have the same number of genes (ie. the same gene content)? Since all life on earth shared a common ancestor at some point, any two species, for example, human and a fruitfly, must have descended from a common ancestor species.</p>
<p>Since the time of the common ancestor of two species (eg. of human and mouse), some of the genes that were present in the common ancestor species may have been lost from either of the two descendant lineages. Furthermore, the two descendant lineages may have gained genes that were not present in the common ancestor species.</p>
</div>
<div id="using-the-biomart-r-library-to-query-the-ensembl-database" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-biomart-r-library-to-query-the-ensembl-database" class="anchor"></a>Using the biomaRt R Library to Query the Ensembl Database</h1>
<p>To carry out comparative genomic analyses of two animal species whose genomes have been fully sequenced (eg. human and mouse), it is useful to analyze the data in the Ensembl database (www.ensembl.org).</p>
<p>The main Ensembl database which you can browse on the main Ensembl webpage contains genes from fully sequenced vertebrates, as well as Saccharomyces cerevisiae (yeast) and a small number of additional model organism animals (eg. the nematode worm Caenorhabditis elegans and the fruit-fly Drosophila melanogaster).</p>
<p>There are also Ensembl databases for other groups of organisms, for example Ensembl Protists for Protists, Ensembl Metazoa for Metazoans, Ensembl Bacteria for Bacteria, Ensembl Plants for Plants, and Ensembl Fungi for Fungi.</p>
<p>It is possible to carry out analyses of the Ensembl database using R, with the “biomaRt” R package. The “biomaRt” package can connect to the Ensembl database, and perform queries on the data.</p>
<p>The “biomaRt” R package is part of the Bioconductor set of R packages, and so can be installed as explained here.</p>
<p>Once you have installed the “biomaRt” package, you can get a list of databases that can be queried using this package by typing:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"biomaRt"</span><span class="op">)</span> <span class="co"># Load the biomaRt package in R</span>
<span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/listEnsembl.html">listEnsemblGenomes</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># List all Ensembl genomes that can be queried</span>
<span class="co">#&gt;               biomart                        version</span>
<span class="co">#&gt; 1       protists_mart      Ensembl Protists Genes 51</span>
<span class="co">#&gt; 2 protists_variations Ensembl Protists Variations 51</span>
<span class="co">#&gt; 3          fungi_mart         Ensembl Fungi Genes 51</span>
<span class="co">#&gt; 4    fungi_variations    Ensembl Fungi Variations 51</span>
<span class="co">#&gt; 5        metazoa_mart       Ensembl Metazoa Genes 51</span>
<span class="co">#&gt; 6  metazoa_variations  Ensembl Metazoa Variations 51</span>
<span class="co">#&gt; 7         plants_mart        Ensembl Plants Genes 51</span>
<span class="co">#&gt; 8   plants_variations   Ensembl Plants Variations 51</span></code></pre></div>
<p>The names of the databases are listed, and the version of the database.</p>
<p>You will see that the “biomaRt” R package can actually be used to query many different databases including WormBase, UniProt, Ensembl, etc.</p>
<p>Here, we will discuss using the “biomaRt” package to query the Ensembl database, but it is worth remembering that it also be used to perform queries on other databases such as UniProt.</p>
<p>If you want to perform a query on the Ensembl database using “biomaRt”, you first need to specify that this is the database that you want to query. You can do this using the useEnsemblGenomes() function from the “biomaRt” package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">ensemblprotists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useEnsembl.html">useEnsemblGenomes</a></span><span class="op">(</span><span class="st">"protists_mart"</span><span class="op">)</span> <span class="co"># Specify that we want to query the Ensembl database</span></code></pre></div>
<p>This tells “biomaRt” that you want to query the Ensembl Protists database. The Ensembl Protists database contains data sets of genomic information for different protist species whose genomes have been fully sequenced.</p>
<p>To see which data sets you can query in the database that you have selected (using useDataset()), you can type:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/listDatasets.html">listDatasets</a></span><span class="op">(</span><span class="va">ensemblprotists</span><span class="op">)</span>
<span class="co">#&gt;                    dataset</span>
<span class="co">#&gt; 1       alaibachii_eg_gene</span>
<span class="co">#&gt; 2          bnatans_eg_gene</span>
<span class="co">#&gt; 3      ddiscoideum_eg_gene</span>
<span class="co">#&gt; 4     ehistolytica_eg_gene</span>
<span class="co">#&gt; 5         ehuxleyi_eg_gene</span>
<span class="co">#&gt; 6         glamblia_eg_gene</span>
<span class="co">#&gt; 7           gtheta_eg_gene</span>
<span class="co">#&gt; 8   harabidopsidis_eg_gene</span>
<span class="co">#&gt; 9           lmajor_eg_gene</span>
<span class="co">#&gt; 10 paphanidermatum_eg_gene</span>
<span class="co">#&gt; 11   parrhenomanes_eg_gene</span>
<span class="co">#&gt; 12        pberghei_eg_gene</span>
<span class="co">#&gt; 13       pchabaudi_eg_gene</span>
<span class="co">#&gt; 14     pfalciparum_eg_gene</span>
<span class="co">#&gt; 15      pinfestans_eg_gene</span>
<span class="co">#&gt; 16     pirregulare_eg_gene</span>
<span class="co">#&gt; 17       piwayamai_eg_gene</span>
<span class="co">#&gt; 18      pkernoviae_eg_gene</span>
<span class="co">#&gt; 19       pknowlesi_eg_gene</span>
<span class="co">#&gt; 20      plateralis_eg_gene</span>
<span class="co">#&gt; 21   pmultistriata_eg_gene</span>
<span class="co">#&gt; 22     pparasitica_eg_gene</span>
<span class="co">#&gt; 23        pramorum_eg_gene</span>
<span class="co">#&gt; 24          psojae_eg_gene</span>
<span class="co">#&gt; 25    ptetraurelia_eg_gene</span>
<span class="co">#&gt; 26    ptricornutum_eg_gene</span>
<span class="co">#&gt; 27        pultimum_eg_gene</span>
<span class="co">#&gt; 28         pvexans_eg_gene</span>
<span class="co">#&gt; 29          pvivax_eg_gene</span>
<span class="co">#&gt; 30         tbrucei_eg_gene</span>
<span class="co">#&gt; 31         tgondii_eg_gene</span>
<span class="co">#&gt; 32     tpseudonana_eg_gene</span>
<span class="co">#&gt; 33    tthermophila_eg_gene</span>
<span class="co">#&gt;                                                                      description</span>
<span class="co">#&gt; 1                                                 Albugo laibachii genes (ENA 1)</span>
<span class="co">#&gt; 2                                             Bigelowiella natans genes (Bigna1)</span>
<span class="co">#&gt; 3                                     Dictyostelium discoideum genes (dicty_2.7)</span>
<span class="co">#&gt; 4                                    Entamoeba histolytica genes (JCVI-ESG2-1.0)</span>
<span class="co">#&gt; 5  Emiliania huxleyi genes (Emiliana huxleyi CCMP1516 main genome assembly v1.0)</span>
<span class="co">#&gt; 6                                                    Giardia lamblia genes (GL2)</span>
<span class="co">#&gt; 7                                       Guillardia theta CCMP2712 genes (Guith1)</span>
<span class="co">#&gt; 8                         Hyaloperonospora arabidopsidis genes (HyaAraEmoy2_2.0)</span>
<span class="co">#&gt; 9                                              Leishmania major genes (ASM272v2)</span>
<span class="co">#&gt; 10                              Pythium aphanidermatum genes (pag1_scaffolds_v1)</span>
<span class="co">#&gt; 11                                 Pythium arrhenomanes genes (par_scaffolds_v1)</span>
<span class="co">#&gt; 12                                           Plasmodium berghei genes (PBANKA01)</span>
<span class="co">#&gt; 13                                           Plasmodium chabaudi genes (PCHAS01)</span>
<span class="co">#&gt; 14                                    Plasmodium falciparum 3D7 genes (ASM276v2)</span>
<span class="co">#&gt; 15                                     Phytophthora infestans genes (ASM14294v1)</span>
<span class="co">#&gt; 16                                   Pythium irregulare genes (pir_scaffolds_v1)</span>
<span class="co">#&gt; 17                                     Pythium iwayamai genes (piw_scaffolds_v1)</span>
<span class="co">#&gt; 18                                Phytophthora kernoviae genes (PhyKer238/432v1)</span>
<span class="co">#&gt; 19                                          Plasmodium knowlesi genes (ASM635v1)</span>
<span class="co">#&gt; 20                                      Phytophthora lateralis genes (MPF4_v1.0)</span>
<span class="co">#&gt; 21                           Pseudo-nitzschia multistriata genes (ASM90066040v1)</span>
<span class="co">#&gt; 22                            Phytophthora parasitica genes (Phyt_para_P1569_V1)</span>
<span class="co">#&gt; 23                                       Phytophthora ramorum genes (ASM14973v1)</span>
<span class="co">#&gt; 24                                       Phytophthora sojae genes (P.sojae V3.0)</span>
<span class="co">#&gt; 25                                     Paramecium tetraurelia genes (ASM16542v1)</span>
<span class="co">#&gt; 26                                  Phaeodactylum tricornutum genes (ASM15095v2)</span>
<span class="co">#&gt; 27                                                   Pythium ultimum genes (pug)</span>
<span class="co">#&gt; 28                                       Pythium vexans genes (pve_scaffolds_v1)</span>
<span class="co">#&gt; 29                                             Plasmodium vivax genes (ASM241v2)</span>
<span class="co">#&gt; 30                               Trypanosoma brucei genes (TryBru_Apr2005_chr11)</span>
<span class="co">#&gt; 31                                           Toxoplasma gondii ME49 genes (TGA4)</span>
<span class="co">#&gt; 32                                   Thalassiosira pseudonana genes (ASM14940v2)</span>
<span class="co">#&gt; 33                                 Tetrahymena thermophila genes (JCVI-TTA1-2.2)</span>
<span class="co">#&gt;                                                version</span>
<span class="co">#&gt; 1                                                ENA 1</span>
<span class="co">#&gt; 2                                               Bigna1</span>
<span class="co">#&gt; 3                                            dicty_2.7</span>
<span class="co">#&gt; 4                                        JCVI-ESG2-1.0</span>
<span class="co">#&gt; 5  Emiliana huxleyi CCMP1516 main genome assembly v1.0</span>
<span class="co">#&gt; 6                                                  GL2</span>
<span class="co">#&gt; 7                                               Guith1</span>
<span class="co">#&gt; 8                                      HyaAraEmoy2_2.0</span>
<span class="co">#&gt; 9                                             ASM272v2</span>
<span class="co">#&gt; 10                                   pag1_scaffolds_v1</span>
<span class="co">#&gt; 11                                    par_scaffolds_v1</span>
<span class="co">#&gt; 12                                            PBANKA01</span>
<span class="co">#&gt; 13                                             PCHAS01</span>
<span class="co">#&gt; 14                                            ASM276v2</span>
<span class="co">#&gt; 15                                          ASM14294v1</span>
<span class="co">#&gt; 16                                    pir_scaffolds_v1</span>
<span class="co">#&gt; 17                                    piw_scaffolds_v1</span>
<span class="co">#&gt; 18                                     PhyKer238/432v1</span>
<span class="co">#&gt; 19                                            ASM635v1</span>
<span class="co">#&gt; 20                                           MPF4_v1.0</span>
<span class="co">#&gt; 21                                       ASM90066040v1</span>
<span class="co">#&gt; 22                                  Phyt_para_P1569_V1</span>
<span class="co">#&gt; 23                                          ASM14973v1</span>
<span class="co">#&gt; 24                                        P.sojae V3.0</span>
<span class="co">#&gt; 25                                          ASM16542v1</span>
<span class="co">#&gt; 26                                          ASM15095v2</span>
<span class="co">#&gt; 27                                                 pug</span>
<span class="co">#&gt; 28                                    pve_scaffolds_v1</span>
<span class="co">#&gt; 29                                            ASM241v2</span>
<span class="co">#&gt; 30                                TryBru_Apr2005_chr11</span>
<span class="co">#&gt; 31                                                TGA4</span>
<span class="co">#&gt; 32                                          ASM14940v2</span>
<span class="co">#&gt; 33                                       JCVI-TTA1-2.2</span></code></pre></div>
<p>You will see a long list of the organisms for which the Ensembl Protists database has genome data, including Plasmodium falciparium (which causes malaria), and Leishmania major, which causes leishmaniasis, which is classified by the WHO as a neglected tropical disease.</p>
<p>To perform a query on the Ensembl database using the “biomaRt” R package, you first need to specify which Ensembl data set your query relates to. You can do this using the useDataset() function from the “biomaRt” package. For example, to specify that you want to perform a query on the Ensembl Leishmania major data set, you would type:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ensemblleishmania</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useDataset.html">useDataset</a></span><span class="op">(</span><span class="st">"lmajor_eg_gene"</span>,mart<span class="op">=</span><span class="va">ensemblprotists</span><span class="op">)</span></code></pre></div>
<p>Note that the name of the Leishmania major Ensembl data set is “lmajor_eg_gene”; this is the data set listed for Leishmania major genomic information when we typed listDatasets(ensemblprotists) above.</p>
<p>Once you have specified the particular Ensembl data set that you want to perform a query on, you can perform the query using the getBM() function from the “biomaRt” package.</p>
<p>Usually, you will want to perform a query to a particular set of features from the Leishmania major Ensembl data set. What types of features can you search for? You can find this out by using the listAttributes() function from the “biomaRt” package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniaattributes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/listAttributes.html">listAttributes</a></span><span class="op">(</span><span class="va">ensemblleishmania</span><span class="op">)</span></code></pre></div>
<p>The listAttributes() function returns a list object, the first element of which is a vector of all possible features that you can select, and the second element of which is a vector containing explanations of all those features:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">attributenames</span> <span class="op">&lt;-</span> <span class="va">leishmaniaattributes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">attributedescriptions</span> <span class="op">&lt;-</span> <span class="va">leishmaniaattributes</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">attributenames</span><span class="op">)</span>        <span class="co"># Find the length of vector "attributenames"</span>
<span class="co">#&gt; [1] 630</span>
<span class="va">attributenames</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>          <span class="co"># Print out the first 10 entries in vector "attributenames"</span>
<span class="co">#&gt;  [1] "ensembl_gene_id"       "ensembl_transcript_id" "ensembl_peptide_id"   </span>
<span class="co">#&gt;  [4] "ensembl_exon_id"       "description"           "chromosome_name"      </span>
<span class="co">#&gt;  [7] "start_position"        "end_position"          "strand"               </span>
<span class="co">#&gt; [10] "band"</span>
<span class="va">attributedescriptions</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>   <span class="co"># Print out the first 10 entries in vector "attributedescriptions"</span>
<span class="co">#&gt;  [1] "Gene stable ID"           "Transcript stable ID"    </span>
<span class="co">#&gt;  [3] "Protein stable ID"        "Exon stable ID"          </span>
<span class="co">#&gt;  [5] "Gene description"         "Chromosome/scaffold name"</span>
<span class="co">#&gt;  [7] "Gene start (bp)"          "Gene end (bp)"           </span>
<span class="co">#&gt;  [9] "Strand"                   "Karyotype band"</span></code></pre></div>
<p>This gives us a very long list of 630 features in the Leishmania major Ensembl data set that we can search for by querying the database, such as genes, transcripts (mRNAs), peptides (proteins), chromosomes, GO (Gene Ontology) terms, and so on.</p>
<p>When you are performing a query on the Ensembl Leishmania major data set using getBM(), you have to specify which of these features you want to retrieve. For example, you can see from the output of listAttributes() (see above) that one possible type of feature we can search for are Leishmania major genes. To retrieve a list of all Leishmania major genes from the Leishmania major Ensembl data set, we just need to type:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span><span class="op">)</span>, mart<span class="op">=</span><span class="va">ensemblleishmania</span><span class="op">)</span></code></pre></div>
<p>This returns a list variable leishmaniagenes, the first element of which is a vector containing the names of all Leishmania major genes. Thus, to find the number of genes, and print out the names of the first ten genes stored in the vector, we can type:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenenames</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get the vector of the names of all L. major genes</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">leishmaniagenenames</span><span class="op">)</span>
<span class="co">#&gt; [1] 10030</span>
<span class="va">leishmaniagenenames</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] "ENSRNAG00049765313" "ENSRNAG00049765315" "ENSRNAG00049765317"</span>
<span class="co">#&gt;  [4] "ENSRNAG00049765319" "ENSRNAG00049765321" "ENSRNAG00049765323"</span>
<span class="co">#&gt;  [7] "ENSRNAG00049765325" "ENSRNAG00049765327" "ENSRNAG00049765329"</span>
<span class="co">#&gt; [10] "ENSRNAG00049765333"</span></code></pre></div>
<p>This tells us that there are 10300 different Leishmania major genes in the L. major Ensembl data set. Note that this includes various types of genes including protein-coding genes (both “known” and “novel” genes, where the “novel” genes are gene predictions that don’t have sequence similarity to any sequences in sequence databases), RNA genes, and pseudogenes.</p>
<p>What if we are only interested in protein-coding genes? If you look at the output of listAttributes(ensemblleishmania), you will see that one of the features is “gene_biotype”, which is tells us what sort of gene each gene is (eg. protein-coding, pseudogene, etc.):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenes2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"gene_biotype"</span><span class="op">)</span>, mart<span class="op">=</span><span class="va">ensemblleishmania</span><span class="op">)</span></code></pre></div>
<p>In this case, the getBM() function will return a list variable leishmaniagenes2, the first element of which is a vector containing the names of all Leishmania major genes, and the second of which is a vector containing the types of those genes:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenenames2</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get the vector of the names of all L. major genes</span>
<span class="va">leishmaniagenebiotypes2</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get the vector of the biotypes of all genes</span></code></pre></div>
<p>We can make a table of all the different types of genes using the table() function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">leishmaniagenebiotypes2</span><span class="op">)</span>
<span class="co">#&gt; leishmaniagenebiotypes2</span>
<span class="co">#&gt;          ncRNA protein_coding     pseudogene           rRNA          snRNA </span>
<span class="co">#&gt;           1130           8315             94             92            233 </span>
<span class="co">#&gt;           tRNA </span>
<span class="co">#&gt;            166</span></code></pre></div>
<p>This tells us that there are 8315 protein-coding genes, 94 pseudogenes, and various types of RNA genes (tRNA genes, rRNA genes, snRNA genes, etc.). Thus, there are 8315 human protein-coding genes.</p>
</div>
<div id="comparing-the-number-of-genes-in-two-species" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-the-number-of-genes-in-two-species" class="anchor"></a>Comparing the number of genes in two species</h1>
<p>Ensembl is a very useful resource for comparing the gene content of different species. For example, one simple question that we can ask by analyzing the Ensembl data is: how many protein-coding genes are there in Leishmania major, and how many in Plasmodium falciparum?</p>
<p>We know how many protein-coding genes are in Leishmania major (8315; see above), but what about Plasmodium falciparum? To answer this question, we first need to tell the “biomaRt” package that we want to make a query on the Ensembl Plasmodium falciparum data set.</p>
<p>We can do this using the useDataset() function to select the Plasmodium falciparum Ensembl data set.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ensemblpfalciparum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useDataset.html">useDataset</a></span><span class="op">(</span><span class="st">"pfalciparum_eg_gene"</span>,mart<span class="op">=</span><span class="va">ensemblprotists</span><span class="op">)</span></code></pre></div>
<p>Note that the name of the Plasmodium falciparum Ensembl data set is “pfalciparum_eg_gene”; this is the data set listed for Plasmodium falciparum genomic information when we typed listDatasets(ensemblprotists) above.</p>
<p>We can then use getBM() as above to retrieve the names of all Plasmodium falciparum protein-coding genes. This time we have to set the “mart” option in the getBM() function to “ensemblpfalciparum”, to specify that we want to query the Plasmodium falciparum Ensembl data set rather than the Leishmania major Ensembl data set:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfalciparumgenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"gene_biotype"</span><span class="op">)</span>, mart<span class="op">=</span><span class="va">ensemblpfalciparum</span><span class="op">)</span>
<span class="va">pfalciparumgenenames</span> <span class="op">&lt;-</span> <span class="va">pfalciparumgenes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get the names of the P. falciparum genes</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pfalciparumgenenames</span><span class="op">)</span>                  <span class="co"># Get the number of P. falciparum genes</span>
<span class="co">#&gt; [1] 5767</span>

<span class="va">pfalciparumgenebiotypes</span> <span class="op">&lt;-</span> <span class="va">pfalciparumgenes</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get the types of the P. falciparum genes</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pfalciparumgenebiotypes</span><span class="op">)</span>
<span class="co">#&gt; pfalciparumgenebiotypes</span>
<span class="co">#&gt;              ncRNA nontranslating_CDS     protein_coding         pseudogene </span>
<span class="co">#&gt;                102                  4               5358                153 </span>
<span class="co">#&gt;               rRNA              snRNA               sRNA               tRNA </span>
<span class="co">#&gt;                 44                 10                 17                 79</span></code></pre></div>
<p>This tells us that there are 5767 Plasmodium falciparum protein-coding genes in Ensembl. That is, Plasmodium falciparum seems to have less protein-coding genes than Leishmania major (8315 protein-coding genes; see above).</p>
<p>It is interesting to ask: why does Plasmodium falciparum have less protein-coding genes than Leishmania major? There are several possible explanations: (i) that there have been gene duplications in the Leishmania major lineage since Leishmania and Plasmodium shared a common ancestor, which gave rise to new Leishmania major genes; (ii) that completely new genes (that are not related to any other Leishmania major gene) have arisen in the Leishmania major lineage since Leishmania and Plasmodium shared a common ancestor; or (iii) that there have been genes lost from the Plasmodium falciparum genome since Leishmania and Plasmodium shared a common ancestor.</p>
<p>To investigate which of these explanations is most likely to be correct, we need to figure out how the Leishmania major protein-coding genes are related to Plasmodium falciparum protein-coding genes.</p>
</div>
<div id="identifying-homologous-genes-between-two-species" class="section level1">
<h1 class="hasAnchor">
<a href="#identifying-homologous-genes-between-two-species" class="anchor"></a>Identifying homologous genes between two species</h1>
<p>The Ensembl database groups homologous (related) genes together into gene families. If a gene from Leishmania major and a gene from Plasmodium falciparum are related, they should be placed together into the same Ensembl gene family in the Ensembl Protists database. In fact, if a Leishmania major gene has any homologues (related genes) in other protists, it should be placed into some Ensembl gene family in the Ensembl Protists database.</p>
<p>For all Leishmania major and Plasmodium falciparum genes that are placed together in a gene family, Ensembl classifies the relationship between each pair of Leishmania major and Plasmodium falciparum genes as orthologues (related genes that shared a common ancestor in the ancestor of Leishmania and Plasmodium, and arose due to the Leishmania - Plasmodium speciation event) or paralogues (related genes that arose due to a duplication event within a species, for example, due to a duplication event in Leishmania major, or a duplication event in the Leishmania - Plasmodium ancestor).</p>
<p>If you type listAttributes(ensemblleishmania) again, you will see that one possible feature that you can search for is “pfalciparum_eg_homolog_ensembl_gene”, which is the Plasmodium falciparum orthologue of a Leishmania major gene.</p>
<p>Another possible feature that you can search for is “pfalciparum_eg_homology_orthology_type”, which describes the type of orthology relationship between a particular Leishmania major gene and its Plasmodium falciparum orthologue. For example, if a particular Leishmania major gene has two Plasmodium falciparum orthologues, the relationship between the Leishmania major gene and each of the Plasmodium falciparum orthologues will be “ortholog_one2many” (one-to-many orthology).</p>
<p>This can arise in the case where there was a duplication in the Plasmodium falciparum lineage after Plasmodium and Leishmania diverged, which means that two different Plasmodium falciparum genes (which are paralogues of each other) are both orthologues of the same Leishmania major gene.</p>
<p>Therefore, we can retrive the Ensembl identifiers of the Plasmodium falciparum orthologues of all Leishmania major genes by typing:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"pfalciparum_eg_homolog_ensembl_gene"</span>,
   <span class="st">"pfalciparum_eg_homolog_orthology_type"</span><span class="op">)</span>, mart<span class="op">=</span><span class="va">ensemblleishmania</span><span class="op">)</span></code></pre></div>
<p>This will return an R list variable leishmaniagenes, the first element of which is a vector of Ensembl identifiers for all Leishmania major coding genes, and the second element of which is a vector of Ensembl identifiers for their Plasmodium falciparum orthologues, and the third element of which is a vector with information on the orthology types.</p>
<p>We can print out the names of the first 10 Leishmania major genes and their Plasmodium falciparum orthologues, and their orthology types, by typing:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenenames</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>      <span class="co"># Get the names of all Leishmania major genes</span>
<span class="va">leishmaniaPforthologues</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>  <span class="co"># Get the P. falciparum orthologues of all L. major genes</span>
<span class="va">leishmaniaPforthologuetypes</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get the orthology relationship type</span>
<span class="va">leishmaniagenenames</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] "LMJF_01_0780" "LMJF_01_0350" "LMJF_01_0280" "LMJF_01_0290" "LMJF_01_0335"</span>
<span class="co">#&gt;  [6] "LMJF_01_0600" "LMJF_01_0220" "LMJF_01_0220" "LMJF_01_0220" "LMJF_01_0220"</span>

<span class="va">leishmaniaPforthologues</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] ""              ""              ""              ""             </span>
<span class="co">#&gt;  [5] ""              ""              "PF3D7_0528700" "PF3D7_1116300"</span>
<span class="co">#&gt;  [9] "PF3D7_0804800" "PF3D7_1423200"</span>

<span class="va">leishmaniaPforthologuetypes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] ""                   ""                   ""                  </span>
<span class="co">#&gt;  [4] ""                   ""                   ""                  </span>
<span class="co">#&gt;  [7] "ortholog_many2many" "ortholog_many2many" "ortholog_many2many"</span>
<span class="co">#&gt; [10] "ortholog_many2many"</span></code></pre></div>
<p>Not all Leishmania major genes have Plasmodium falciparum orthologues; this is why when we print out the first 10 elements of the vector leishmaniaPforthologues, some of the elements are empty.</p>
<p>To find out how many Leishmania major genes have orthologues in Plasmodium falciparum, we can first find the indices of the elements of the vector leishmaniaPforthologues that are empty:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myindex</span> <span class="op">&lt;-</span> <span class="va">leishmaniaPforthologues</span><span class="op">==</span><span class="st">""</span></code></pre></div>
<p>We can then find out the names of the Leishmania gene genes corresponding to those indices:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenenames2</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenenames</span><span class="op">[</span><span class="va">myindex</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">leishmaniagenenames2</span><span class="op">)</span>
<span class="co">#&gt; [1] 8191</span></code></pre></div>
<p>This tells us that 8191 Leishmania major genes do not have Plasmodium falciparum orthologues.</p>
<p>How many of the 8191 Leishmania major genes that do not have Plasmodium falaciparum orthologues are protein-coding genes? To answer this question, we can merge together the information in the R list variable leishmaniagenes2 (which contains information on the name of each Leishmania major gene and its type; see above), and the R list variable leishmaniagenes (which contains information on the name of each L. major gene and its Plasmodium falciparum orthologues).</p>
<p>Remember that leishmaniagenes2 was created by typing:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenes2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"gene_biotype"</span><span class="op">)</span>, mart<span class="op">=</span><span class="va">ensemblleishmania</span><span class="op">)</span></code></pre></div>
<p>To combine leishmaniagenes and leishmaniagenes2, we can use the merge() function in R, which can merge together two list variables that contain some named elements in common (in this case, both list variables contain a vector that has the names of Leishmania major genes):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenes3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">leishmaniagenes2</span>, <span class="va">leishmaniagenes</span><span class="op">)</span></code></pre></div>
<p>The first element of the merged list variable leishmaniagenes3 contains a vector of the Leishmania major gene names, the second has a vector of the types of those genes (eg. protein-coding, pseudogene etc.), and the third element has a vector of the Plasmodium falciparum orthologues’ names. We can therefore find out how many protein-coding Leishmania major genes lack Plasmodium falciparum orthologues by typing:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">leishmaniagenenames</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes3</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">leishmaniagenebiotypes</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="va">leishmaniaPforthologues</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenes3</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="va">myindex</span> <span class="op">&lt;-</span> <span class="va">leishmaniaPforthologues</span><span class="op">==</span><span class="st">""</span> <span class="op">&amp;</span> <span class="va">leishmaniagenebiotypes</span><span class="op">==</span><span class="st">"protein_coding"</span>
<span class="va">leishmaniagenenames2</span> <span class="op">&lt;-</span> <span class="va">leishmaniagenenames</span><span class="op">[</span><span class="va">myindex</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">leishmaniagenenames2</span><span class="op">)</span>
<span class="co">#&gt; [1] 6476</span></code></pre></div>
<p>This tells us that there are 6476 Leishmania major protein-coding genes that lack Plasmodium falciparum orthologues.</p>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>In this practical, you will have learnt to use the following R functions:</p>
<p>useDataset() to select a data set in a database to query (in the biomaRt package) listDatasets() to get a list of all data sets in a database (in the biomaRt package) listAttributes() to get a list of all features of a data set (in the biomaRt package) getBM() to make a query on a database (in the biomaRt package) merge() to merge R list objects that contain some named elements in common</p>
</div>
<div id="links-and-further-reading" class="section level1">
<h1 class="hasAnchor">
<a href="#links-and-further-reading" class="anchor"></a>Links and Further Reading</h1>
<p>Some links are included here for further reading.</p>
<p>For background reading on comparative genomics, it is recommended to read Chapter 8 of Introduction to Computational Genomics: a case studies approach by Cristianini and Hahn (Cambridge University Press; www.computational-genomics.net/book/).</p>
<p>For more information and examples on using the biomaRt R package, see the biomaRt package website.</p>
<p>For a more in-depth introduction to R, a good online tutorial is available on the “Kickstarting R” website, cran.r-project.org/doc/contrib/Lemon-kickstart.</p>
<p>There is another nice (slightly more in-depth) tutorial to R available on the “Introduction to R” website, cran.r-project.org/doc/manuals/R-intro.html.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>Many of the ideas for the examples and exercises for this practical were inspired by the Matlab case study on Chlamydia (<a href="http://www.computational-genomics.net/case_studies/chlamydia_demo.html" class="uri">http://www.computational-genomics.net/case_studies/chlamydia_demo.html</a>) from the website that accompanies the book Introduction to Computational Genomics: a case studies approach by Cristianini and Hahn (Cambridge University Press; www.computational-genomics.net/book/).</p>
</div>
<div id="contact" class="section level1">
<h1 class="hasAnchor">
<a href="#contact" class="anchor"></a>Contact</h1>
<p>I will be grateful if you will send me (Avril Coghlan) corrections or suggestions for improvements to my email address <a href="mailto:alc@sanger.ac.uk" class="email">alc@sanger.ac.uk</a></p>
</div>
<div id="license" class="section level1">
<h1 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h1>
<p>The content in this book is licensed under a Creative Commons Attribution 3.0 License.</p>
</div>
<div id="exercises" class="section level1">
<h1 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h1>
<p>Answer the following questions, using the R package. For each question, please record your answer, and what you typed into R to get this answer.</p>
<p>Model answers to the exercises are given in Answers to the exercises on Comparative Genomics.</p>
<p>Q1. How many Mycobacterium ulcerans genes are there in the current version of the Ensembl Bacteria database? Note: the bacterium Mycobacterium ulcerans causes Buruli ulcer, which is classified by the WHO as a neglected tropical disease. Q2. How many of the Mycobacterium ulcerans Ensembl genes are protein-coding genes?</p>
<p>Q3. How many Mycobacterium ulcerans protein-coding genes have Mycobacterium leprae orthologues? Note: Mycobacterium leprae is the bacterium that causes leprosy, which is classified by the WHO as a neglected tropical disease. Q4. How many of the<em>Mycobacterium ulcerans</em> protein-coding genes have one-to-one orthologues in Mycobacterium leprae?</p>
<p>Q5. How many Mycobacterium ulcerans genes have Pfam domains?</p>
<p>Q6. What are the top 5 most common Pfam domains in Mycobacterium ulcerans genes?</p>
<p>Q7. How many copies of each of the top 5 domains found in Q6 are there in the Mycobacterium ulcerans protein set?</p>
<p>Q8. How many of copies are there in the Mycobacterium lepraae protein set, of each of the top 5 Mycobacterium ulcerans Pfam protein domains?</p>
<p>Q9. Are the numbers of copies of some domains different in the two species?</p>
<p>Q10. Of the differences found in Q9, are any of the differencess statistically significant?</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
